<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://windily-cloud.github.io/obsidian-publish/Publish/Clean%20Archtechture/ch5.html"><meta property="og:site_name" content="Windily Cloud"><meta property="og:title" content="Chap5. OBJECT-ORIENTED PROGRAMMING é¢å‘å¯¹è±¡ç¼–ç¨‹"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-09-20T11:11:04.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-09-20T11:11:04.000Z"><title>Chap5. OBJECT-ORIENTED PROGRAMMING é¢å‘å¯¹è±¡ç¼–ç¨‹ | Windily Cloud</title><meta name="description" content="Windily Cloud's Blog">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/obsidian-publish/assets/style.12da8f21.css">
    <link rel="modulepreload" href="/obsidian-publish/assets/app.887b133c.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch5.html.0f2533d2.js"><link rel="modulepreload" href="/obsidian-publish/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch5.html.326ac1a0.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c7e76e53.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.f01af163.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.d24325cb.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.fc3247cd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.279a3dae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.ad67b7a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.74f49c94.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.7b8b868f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.0897d88d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.871f1a29.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.9cf7c1a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.1ee0e012.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.b2dc5528.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.d50b6029.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.f9083031.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.a8daed86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.f712f0c4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.008de7bb.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.bc3946ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.dcd080ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.4bd6fad0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.5af7f550.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.cdcf732e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.d56c6b1b.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.1d0c5f03.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.a9585c5e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.7898d2ef.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.4e106aa0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.efd82950.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.054b22ad.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.25d75f30.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.058b06f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.61d3f411.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.a6691c1e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.b00c3f6a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.4e35799e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.f553bf58.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.1abe47e0.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.61a30e56.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.c688cf00.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.19a54833.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e97d623d.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.59f213ed.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.565d8d69.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.8c97282e.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.7a0981ad.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.609d0549.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.0ce08377.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.cc115e5e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.60ae3ce2.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c09081fd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.70634028.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.3b70efd7.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.f5a6049f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.d91b9c1f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.32852561.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0a68a710.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.93b7cca5.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.a1c9d7de.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0da27cdd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.b850d04a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.5aa5f6f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.413c371f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.3cd7a242.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.175ce04d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.fc4a1701.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.199a9f38.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.5b8799e9.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.20b93b21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.165fc3da.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.4cd429e5.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.3e2d64e7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.384a9648.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.b1ad3804.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.58811bd6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.44e934ae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.d77e680e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.79a8927d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.a6d9e7e0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.c53b41bf.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.fdbedd86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.8d17578d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.69ad75a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.ef8bfaee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.d5d16d0e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.33b5c44c.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.6c12ea21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.7adbcd24.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.c7a5cd99.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.f4b07606.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.c64dc16e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.d8f304e4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.ac3dd3f7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.e8bdc588.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.f20e95e2.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.46fb949d.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.37fde797.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e291bbe5.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.7deee47f.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.6126ed62.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.f99ad030.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.f2f4101a.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.9eadd293.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.71c36bf1.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.24a96f75.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b76fc3f0.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.ba71ba2a.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.103ba7cd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.7d4c0d5f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b1a4c497.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0c6eca16.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.394348dd.js"><link rel="prefetch" href="/obsidian-publish/assets/auto.56c9cb2e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.1f644ee1.js"><link rel="prefetch" href="/obsidian-publish/assets/flowchart.parse.1479ec3f.js"><link rel="prefetch" href="/obsidian-publish/assets/mermaid.esm.min.0e041931.js"><link rel="prefetch" href="/obsidian-publish/assets/highlight.esm.9b852bc5.js"><link rel="prefetch" href="/obsidian-publish/assets/markdown.esm.77e8db25.js"><link rel="prefetch" href="/obsidian-publish/assets/math.esm.cb9d4be3.js"><link rel="prefetch" href="/obsidian-publish/assets/notes.esm.62c5f19d.js"><link rel="prefetch" href="/obsidian-publish/assets/reveal.esm.41ec5d7f.js"><link rel="prefetch" href="/obsidian-publish/assets/search.esm.04894411.js"><link rel="prefetch" href="/obsidian-publish/assets/zoom.esm.78977eba.js"><link rel="prefetch" href="/obsidian-publish/assets/VuePlayground.3cfc7758.js"><link rel="prefetch" href="/obsidian-publish/assets/photoswipe.esm.f594e77b.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/obsidian-publish/" class="brand"><img class="logo" src="/obsidian-publish/logo.svg" alt="Windily Cloud"><!----><span class="site-name hide-in-pad">Windily Cloud</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><span class="icon iconfont icon-home"></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/home.html" class="nav-link" aria-label="å›¾è°±"><span class="icon iconfont icon-home"></span>å›¾è°±<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="ä¸»é¢˜æ–‡æ¡£" class="nav-link"><span class="icon iconfont icon-note"></span>ä¸»é¢˜æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/windily-cloud/obsidian-publish" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><a href="/obsidian-publish/" class="title">Vault</a><!----></p><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">è§é—»</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">Obsidian</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><span class="title">Clean Archtechture</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/" class="nav-link sidebar-link sidebar-page" aria-label="README.md"><span class="icon iconfont icon-file"></span>README.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/afterword.html" class="nav-link sidebar-link sidebar-page" aria-label="afterword.md"><span class="icon iconfont icon-file"></span>afterword.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch1.html" class="nav-link sidebar-link sidebar-page" aria-label="ch1.md"><span class="icon iconfont icon-file"></span>ch1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch10.html" class="nav-link sidebar-link sidebar-page" aria-label="ch10.md"><span class="icon iconfont icon-file"></span>ch10.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch11.html" class="nav-link sidebar-link sidebar-page" aria-label="ch11.md"><span class="icon iconfont icon-file"></span>ch11.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch12.html" class="nav-link sidebar-link sidebar-page" aria-label="ch12.md"><span class="icon iconfont icon-file"></span>ch12.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch13.html" class="nav-link sidebar-link sidebar-page" aria-label="ch13.md"><span class="icon iconfont icon-file"></span>ch13.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html" class="nav-link sidebar-link sidebar-page" aria-label="ch14.md"><span class="icon iconfont icon-file"></span>ch14.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch15.html" class="nav-link sidebar-link sidebar-page" aria-label="ch15.md"><span class="icon iconfont icon-file"></span>ch15.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch16.html" class="nav-link sidebar-link sidebar-page" aria-label="ch16.md"><span class="icon iconfont icon-file"></span>ch16.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch17.html" class="nav-link sidebar-link sidebar-page" aria-label="ch17.md"><span class="icon iconfont icon-file"></span>ch17.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch18.html" class="nav-link sidebar-link sidebar-page" aria-label="ch18.md"><span class="icon iconfont icon-file"></span>ch18.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch19.html" class="nav-link sidebar-link sidebar-page" aria-label="ch19.md"><span class="icon iconfont icon-file"></span>ch19.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch2.html" class="nav-link sidebar-link sidebar-page" aria-label="ch2.md"><span class="icon iconfont icon-file"></span>ch2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch20.html" class="nav-link sidebar-link sidebar-page" aria-label="ch20.md"><span class="icon iconfont icon-file"></span>ch20.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch21.html" class="nav-link sidebar-link sidebar-page" aria-label="ch21.md"><span class="icon iconfont icon-file"></span>ch21.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch22.html" class="nav-link sidebar-link sidebar-page" aria-label="ch22.md"><span class="icon iconfont icon-file"></span>ch22.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch23.html" class="nav-link sidebar-link sidebar-page" aria-label="ch23.md"><span class="icon iconfont icon-file"></span>ch23.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch24.html" class="nav-link sidebar-link sidebar-page" aria-label="ch24.md"><span class="icon iconfont icon-file"></span>ch24.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html" class="nav-link sidebar-link sidebar-page" aria-label="ch25.md"><span class="icon iconfont icon-file"></span>ch25.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch26.html" class="nav-link sidebar-link sidebar-page" aria-label="ch26.md"><span class="icon iconfont icon-file"></span>ch26.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch27.html" class="nav-link sidebar-link sidebar-page" aria-label="ch27.md"><span class="icon iconfont icon-file"></span>ch27.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch28.html" class="nav-link sidebar-link sidebar-page" aria-label="ch28.md"><span class="icon iconfont icon-file"></span>ch28.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch29.html" class="nav-link sidebar-link sidebar-page" aria-label="ch29.md"><span class="icon iconfont icon-file"></span>ch29.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch3.html" class="nav-link sidebar-link sidebar-page" aria-label="ch3.md"><span class="icon iconfont icon-file"></span>ch3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch30.html" class="nav-link sidebar-link sidebar-page" aria-label="ch30.md"><span class="icon iconfont icon-file"></span>ch30.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch31.html" class="nav-link sidebar-link sidebar-page" aria-label="ch31.md"><span class="icon iconfont icon-file"></span>ch31.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch32.html" class="nav-link sidebar-link sidebar-page" aria-label="ch32.md"><span class="icon iconfont icon-file"></span>ch32.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch33.html" class="nav-link sidebar-link sidebar-page" aria-label="ch33.md"><span class="icon iconfont icon-file"></span>ch33.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html" class="nav-link sidebar-link sidebar-page" aria-label="ch34.md"><span class="icon iconfont icon-file"></span>ch34.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link sidebar-link sidebar-page" aria-label="ch4.md"><span class="icon iconfont icon-file"></span>ch4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ch5.md"><span class="icon iconfont icon-file"></span>ch5.md<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#encapsulation-å°è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ENCAPSULATION? å°è£…"><!---->ENCAPSULATION? å°è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#inheritance-ç»§æ‰¿" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="INHERITANCE? ç»§æ‰¿"><!---->INHERITANCE? ç»§æ‰¿<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#polymorphism-å¤šæ€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="POLYMORPHISM? å¤šæ€"><!---->POLYMORPHISM? å¤šæ€<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#the-power-of-polymorphism-å¤šæ€çš„å¼ºå¤§æ€§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE POWER OF POLYMORPHISM å¤šæ€çš„å¼ºå¤§æ€§"><!---->THE POWER OF POLYMORPHISM å¤šæ€çš„å¼ºå¤§æ€§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#dependency-inversion-ä¾èµ–åè½¬" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="DEPENDENCY INVERSION ä¾èµ–åè½¬"><!---->DEPENDENCY INVERSION ä¾èµ–åè½¬<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#conclusion-æœ¬ç« å°ç»“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CONCLUSION æœ¬ç« å°ç»“"><!---->CONCLUSION æœ¬ç« å°ç»“<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch6.html" class="nav-link sidebar-link sidebar-page" aria-label="ch6.md"><span class="icon iconfont icon-file"></span>ch6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch7.html" class="nav-link sidebar-link sidebar-page" aria-label="ch7.md"><span class="icon iconfont icon-file"></span>ch7.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch8.html" class="nav-link sidebar-link sidebar-page" aria-label="ch8.md"><span class="icon iconfont icon-file"></span>ch8.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch9.html" class="nav-link sidebar-link sidebar-page" aria-label="ch9.md"><span class="icon iconfont icon-file"></span>ch9.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part1.html" class="nav-link sidebar-link sidebar-page" aria-label="part1.md"><span class="icon iconfont icon-file"></span>part1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part2.html" class="nav-link sidebar-link sidebar-page" aria-label="part2.md"><span class="icon iconfont icon-file"></span>part2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part3.html" class="nav-link sidebar-link sidebar-page" aria-label="part3.md"><span class="icon iconfont icon-file"></span>part3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part4.html" class="nav-link sidebar-link sidebar-page" aria-label="part4.md"><span class="icon iconfont icon-file"></span>part4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part5.html" class="nav-link sidebar-link sidebar-page" aria-label="part5.md"><span class="icon iconfont icon-file"></span>part5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part6.html" class="nav-link sidebar-link sidebar-page" aria-label="part6.md"><span class="icon iconfont icon-file"></span>part6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/%E5%AF%BC%E8%88%AA.html" class="nav-link sidebar-link sidebar-page" aria-label="å¯¼èˆª.md"><span class="icon iconfont icon-file"></span>å¯¼èˆª.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Chap5. OBJECT-ORIENTED PROGRAMMING é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://windily-cloud.github.io" target="_blank" rel="noopener noreferrer">Windily-Cloud</a></span><span property="author" content="Windily-Cloud"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´9æœˆ20æ—¥</span><meta property="datePublished" content="2022-09-20T11:03:58.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 24 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT24M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#chap5-object-oriented-programming-é¢å‘å¯¹è±¡ç¼–ç¨‹" class="router-link-active router-link-exact-active toc-link level1">Chap5. OBJECT-ORIENTED PROGRAMMING é¢å‘å¯¹è±¡ç¼–ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#encapsulation-å°è£…" class="router-link-active router-link-exact-active toc-link level2">ENCAPSULATION? å°è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#inheritance-ç»§æ‰¿" class="router-link-active router-link-exact-active toc-link level2">INHERITANCE? ç»§æ‰¿</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#polymorphism-å¤šæ€" class="router-link-active router-link-exact-active toc-link level2">POLYMORPHISM? å¤šæ€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html#conclusion-æœ¬ç« å°ç»“" class="router-link-active router-link-exact-active toc-link level2">CONCLUSION æœ¬ç« å°ç»“</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="chap5-object-oriented-programming-é¢å‘å¯¹è±¡ç¼–ç¨‹" tabindex="-1"><a class="header-anchor" href="#chap5-object-oriented-programming-é¢å‘å¯¹è±¡ç¼–ç¨‹" aria-hidden="true">#</a> Chap5. OBJECT-ORIENTED PROGRAMMING é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><p>As we will see, the basis of a good architecture is the understanding and application of the principles of object-oriented design (OO). But just what is OO?</p><blockquote><p>ç¨åæˆ‘ä»¬ä¼šè®²åˆ°ï¼Œè®¾è®¡ä¸€ä¸ªä¼˜ç§€çš„è½¯ä»¶æ¶æ„è¦åŸºäºå¯¹é¢å‘å¯¹è±¡è®¾è®¡ï¼ˆObject-Oriented Designï¼‰çš„æ·±å…¥ç†è§£åŠåº”ç”¨ã€‚ä½†æˆ‘ä»¬é¦–å…ˆå¾—å¼„æ˜ç™½ä¸€ä¸ªé—®é¢˜ï¼šç©¶ç«Ÿä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ</p></blockquote><p>One answer to this question is â€œThe combination of data and function.â€ Although often cited, this is a very unsatisfying answer because it implies that o.f() is somehow different from f(o). This is absurd. Programmers were passing data structures into functions long before 1966, when Dahl and Nygaard moved the function call stack frame to the heap and invented OO.</p><blockquote><p>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œä¸€ç§å¸¸è§çš„å›ç­”æ˜¯â€œæ•°æ®ä¸å‡½æ•°çš„ç»„åˆâ€ã€‚è¿™ç§è¯´æ³•è™½ç„¶è¢«å¹¿ä¸ºå¼•ç”¨ï¼Œä½†æ€»æ˜¾å¾—å¹¶ä¸æ˜¯é‚£ä¹ˆè´´åˆ‡ï¼Œå› ä¸ºå®ƒä¼¼ä¹æš—ç¤ºäº† <code>o.f()</code> ä¸ <code>f(o)</code> ä¹‹é—´æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯äº‹å®ã€‚é¢å‘å¯¹è±¡ç†è®ºæ˜¯åœ¨ 1966 å¹´æå‡ºçš„ï¼Œå½“æ—¶ Dahl å’Œ Nygaard ä¸»è¦æ˜¯å°†å‡½æ•°è°ƒç”¨æ ˆè¿ç§»åˆ°äº†å †åŒºåŸŸä¸­ã€‚æ•°æ®ç»“æ„è¢«ç”¨ä½œå‡½æ•°çš„è°ƒç”¨å‚æ•°è¿™ä»¶äº‹æƒ…è¿œæ¯”è¿™å‘ç”Ÿçš„æ—¶é—´æ›´æ—©ã€‚</p></blockquote><p>Another common answer to this question is â€œA way to model the real world.â€ This is an evasive answer at best. What does â€œmodeling the real worldâ€ actually mean, and why is it something we would want to do? Perhaps this statement is intended to imply that OO makes software easier to understand because it has a closer relationship to the real worldâ€”but even that statement is evasive and too loosely defined. It does not tell us what OO is.</p><blockquote><p>å¦ä¸€ç§å¸¸è§çš„å›ç­”æ˜¯â€œé¢å‘å¯¹è±¡ç¼–ç¨‹æ˜¯ä¸€ç§å¯¹çœŸå®ä¸–ç•Œè¿›è¡Œå»ºæ¨¡çš„æ–¹å¼â€ï¼Œè¿™ç§å›ç­”åªèƒ½ç®—ä½œé¿é‡å°±è½»ã€‚â€œå¯¹çœŸå®ä¸–ç•Œçš„å»ºæ¨¡â€åˆ°åº•è¦å¦‚ä½•è¿›è¡Œï¼Ÿæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿä¹Ÿè®¸è¿™å¥è¯æ„å‘³ç€æ˜¯â€œç”±äºé‡‡ç”¨é¢å‘å¯¹è±¡æ–¹å¼æ„å»ºçš„è½¯ä»¶ä¸çœŸå®ä¸–ç•Œçš„å…³ç³»æ›´ç´§å¯†ï¼Œæ‰€ä»¥é¢å‘å¯¹è±¡ç¼–ç¨‹å¯ä»¥ä½¿å¾—è½¯ä»¶å¼€å‘æ›´å®¹æ˜“â€â€”â€”å³ä½¿è¿™æ ·è¯´ï¼Œä¹Ÿä»ç„¶é€ƒé¿äº†å…³é”®é—®é¢˜â€”â€”é¢å‘å¯¹è±¡ç¼–ç¨‹ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ?</p></blockquote><p>Some folks fall back on three magic words to explain the nature of OO: encapsulation, inheritance, and polymorphism. The implication is that OO is the proper admixture of these three things, or at least that an OO language must support these three things.</p><blockquote><p>è¿˜æœ‰äº›äººåœ¨å›ç­”è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šæ¬å‡ºä¸€äº›ç¥ç§˜çš„è¯è¯­ï¼Œè­¬å¦‚å°è£…ï¼ˆencapsulationï¼‰ã€ç»§æ‰¿ï¼ˆinheritanceï¼‰ã€å¤šæ€ï¼ˆpolymorphismï¼‰ã€‚å…¶éšå«æ„æ€å°±æ˜¯è¯´é¢å‘å¯¹è±¡ç¼–ç¨‹æ˜¯è¿™ä¸‰é¡¹çš„æœ‰æœºç»„åˆï¼Œæˆ–è€…ä»»ä½•ä¸€ç§æ”¯æŒé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€å¿…é¡»æ”¯æŒè¿™ä¸‰ä¸ªç‰¹æ€§ã€‚</p></blockquote><p>Letâ€™s examine each of these concepts in turn.</p><blockquote><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥é€ä¸ªæ¥åˆ†æä¸€ä¸‹è¿™ä¸‰ä¸ªæ¦‚å¿µã€‚</p></blockquote><h2 id="encapsulation-å°è£…" tabindex="-1"><a class="header-anchor" href="#encapsulation-å°è£…" aria-hidden="true">#</a> ENCAPSULATION? å°è£…</h2><p>The reason encapsulation is cited as part of the definition of OO is that OO languages provide easy and effective encapsulation of data and function. As a result, a line can be drawn around a cohesive set of data and functions. Outside of that line, the data is hidden and only some of the functions are known. We see this concept in action as the private data members and the public member functions of a class.</p><blockquote><p>å¯¼è‡´å°è£…è¿™ä¸ªæ¦‚å¿µç»å¸¸è¢«å¼•ç”¨ä¸ºé¢å‘å¯¹è±¡ç¼–ç¨‹å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡é‡†ç”¨å°è£…ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ç»„ç›¸å…³è”çš„æ•°æ®å’Œå‡½æ•°åœˆèµ·æ¥ï¼Œä¾¿åœˆå¤–è¡€çš„ä»£ç åªèƒ½çœ‹è§éƒ¨åˆ†å‡½æ•°ï¼Œæ•°æ®åˆ™å®Œå…¨ä¸å¯è§ã€‚è­¬å¦‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç±»ï¼ˆclassï¼‰ä¸­çš„å…¬å…±å‡½æ•°å’Œç§æœ‰æˆå‘˜å˜é‡å°±æ˜¯è¿™æ ·ã€‚</p></blockquote><p>This idea is certainly not unique to OO. Indeed, we had perfect encapsulation in C. Consider this simple C program:</p><blockquote><p>ç„¶è€Œï¼Œè¿™ä¸ªç‰¹æ€§å…¶å®å¹¶ä¸æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰€ç‹¬æœ‰çš„ã€‚å…¶å®ï¼Œc è¯­è¨€ä¹Ÿæ”¯æŒå®Œæ•´çš„å°è£…ï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸ªç®€å•çš„ c ç¨‹åºï¼š</p></blockquote><p>point.h</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span> <span class="token function">makePoint</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">distance</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Point</span> <span class="token operator">*</span>p1<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">Point</span> <span class="token operator">*</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>point.c</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;point.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span> <span class="token function">makepoint</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
  p<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
  <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">double</span> <span class="token function">distance</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span> p1<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span> p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> dx <span class="token operator">=</span> p1<span class="token operator">-&gt;</span>x <span class="token operator">-</span> p2<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span>
  <span class="token keyword">double</span> dy <span class="token operator">=</span> p1<span class="token operator">-&gt;</span>y <span class="token operator">-</span> p2<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>dx<span class="token operator">*</span>dx<span class="token operator">+</span>dy<span class="token operator">*</span>dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The users of point.h have no access whatsoever to the members of struct Point. They can call the makePoint() function, and the distance() function, but they have absolutely no knowledge of the implementation of either the Point data structure or the functions.</p><blockquote><p>æ˜¾ç„¶ï¼Œä½¿ç”¨ point.h çš„ç¨‹åºæ˜¯æ²¡æœ‰ Point ç»“æ„ä½“æˆå‘˜çš„è®¿é—®æƒé™çš„ã€‚å®ƒä»¬åªèƒ½è°ƒç”¨ <code>makePoint()</code> å‡½æ•°å’Œ <code>distance()</code> å‡½æ•°ï¼Œä½†å¯¹å®ƒä»¬æ¥è¯´ï¼ŒPoint è¿™ä¸ªæ•°æ®ç»“æ„ä½“çš„å†…éƒ¨ç»†èŠ‚ï¼Œä»¥åŠå‡½æ•°çš„å…·ä½“å®ç°æ–¹å¼éƒ½æ˜¯ä¸å¯è§çš„ã€‚</p></blockquote><p>This is perfect encapsulationâ€”in a non-OO language. C programmers used to do this kind of thing all the time. We would forward declare data structures and functions in header files, and then implement them in implementation files. Our users never had access to the elements in those implementation files.</p><blockquote><p>è¿™æ­£æ˜¯å®Œç¾å°è£… è™½ç„¶ C è¯­è¨€æ˜¯éé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚ä¸Šè¿° C ç¨‹åºæ˜¯å¾ˆå¸¸è§çš„ã€‚åœ¨å¤´æ–‡ä»¶ä¸­è¿›è¡Œæ•°æ®ç»“æ„ä»¥åŠå‡½æ•°å®šä¹‰çš„å‰ç½®å£°æ˜ï¼ˆforward declareï¼‰ï¼Œç„¶å åœ¨ç¨‹åºæ–‡ä»¶ä¸­å…·ä½“å®ç°ã€‚ç¨‹åºæ–‡ä»¶ä¸­çš„å…·ä½“å®ç°ç»†èŠ‚å¯¹ä½¿ç”¨è€…æ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚</p></blockquote><p>But then came OO in the form of C++â€”and the perfect encapsulation of C was broken.</p><blockquote><p>è€Œ C++ä½œä¸ºä¸€ç§é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œåè€Œç ´åäº† c çš„å®Œç¾å°è£…æ€§ã€‚</p></blockquote><p>The C++ compiler, for technical reasons,1 needed the member variables of a class to be declared in the header file of that class. So our Point program changed to look like this:</p><blockquote><p>ç”±äºä¸€äº›æŠ€æœ¯åŸï¼ŒC++ç¼–è¯‘å™¨è¦æ±‚ç±»çš„æˆå‘˜å˜é‡å¿…é¡»åœ¨è¯¥ç±»çš„å¤´æ–‡ä»¶ä¸­å£°æ˜ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ point.h ç¨‹åºéšä¹‹å°±æ”¹æˆäº†è¿™æ ·ï¼š</p></blockquote><p>point.h</p><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> <span class="token function">distance</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">double</span> x<span class="token punctuation">;</span>
  <span class="token keyword">double</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://point.cc" target="_blank" rel="noopener noreferrer">point.cc<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;point.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span>

<span class="token class-name">Point</span><span class="token double-colon punctuation">::</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span>
<span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">double</span> <span class="token class-name">Point</span><span class="token double-colon punctuation">::</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> dx <span class="token operator">=</span> x<span class="token operator">-</span>p<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
  <span class="token keyword">double</span> dy <span class="token operator">=</span> y<span class="token operator">-</span>p<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>dx<span class="token operator">*</span>dx <span class="token operator">+</span> dy<span class="token operator">*</span>dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Clients of the header file point.h know about the member variables x and y! The compiler will prevent access to them, but the client still knows they exist. For example, if those member names are changed, the <a href="http://point.cc" target="_blank" rel="noopener noreferrer">point.cc<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> file must be recompiled! Encapsulation has been broken.</p><blockquote><p>å¥½äº†ï¼Œpoint.h æ–‡ä»¶çš„ä½¿ç”¨è€…ç°åœ¨çŸ¥é“äº†æˆå‘˜å˜é‡ x å’Œ y çš„å­˜åœ¨ï¼è™½ç„¶ç¼–è¯‘å™¨ä¼šç¦æ­¢å¯¹è¿™ä¸¤ä¸ªå˜é‡çš„ç›´æ¥è®¿é—®ï¼Œä½†æ˜¯ä½¿ç”¨è€…ä»ç„¶çŸ¥é“äº†å®ƒä»¬çš„å­˜åœ¨ã€‚è€Œä¸”ï¼Œå¦‚æœ x å’Œ y å˜é‡åç§°è¢«æ”¹å˜äº†ï¼Œ<a href="http://point.cc" target="_blank" rel="noopener noreferrer">point.cc<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¹Ÿå¿…é¡»é‡æ–°ç¼–è¯‘æ‰è¡Œï¼è¿™æ ·çš„å°è£…æ€§æ˜¾ç„¶æ˜¯ä¸å®Œç¾çš„ã€‚</p></blockquote><p>Indeed, the way encapsulation is partially repaired is by introducing the public, private, and protected keywords into the language. This, however, was a hack necessitated by the technical need for the compiler to see those variables in the header file.</p><blockquote><p>å½“ç„¶ï¼ŒC++é€šè¿‡åœ¨ç¼–ç¨‹è¯­è¨€å±‚é¢å¼•å…¥ publicã€privateã€protected è¿™äº›å…³é”®è¯ï¼Œéƒ¨åˆ†ç»´æŠ¤äº†å°è£…æ€§ã€‚ä½†æ‰€æœ‰è¿™äº›éƒ½æ˜¯ä¸ºäº†è§£å†³ç¼–è¯‘å™¨è‡ªèº«çš„æŠ€æœ¯å®ç°é—®é¢˜è€Œå¼•å…¥çš„ hackâ€”â€”ç¼–è¯‘å™¨ç”±äºæŠ€æœ¯å®ç°åŸå› å¿…é¡»åœ¨å¤´æ–‡ä»¶ä¸­çœ‹åˆ°æˆå‘˜å˜é‡çš„å®šä¹‰ã€‚</p></blockquote><p>Java and C# simply abolished the header/implementation split altogether, thereby weakening encapsulation even more. In these languages, it is impossible to separate the declaration and definition of a class.</p><blockquote><p>è€Œ Java å’Œ C# åˆ™å½»åº•æŠ›å¼ƒäº†å¤´æ–‡ä»¶ä¸å®ç°æ–‡ä»¶åˆ†ç¦»çš„ç¼–ç¨‹æ–¹å¼ï¼Œè¿™å…¶å®è¿›ä¸€æ­¥å‰Šå¼±äº†å°è£…æ€§ã€‚å› ä¸ºåœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•åŒºåˆ†ä¸€ä¸ªç±»çš„å£°æ˜å’Œå®šä¹‰çš„ã€‚</p></blockquote><p>For these reasons, it is difficult to accept that OO depends on strong encapsulation. Indeed, many OO languages2 have little or no enforced encapsulation.</p><blockquote><p>ç”±äºä¸Šè¿°åŸå› ï¼Œæˆ‘ä»¬å¾ˆéš¾è¯´å¼ºå°è£…æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¿…è¦æ¡ä»¶ã€‚è€Œäº‹å®ä¸Šï¼Œæœ‰å¾ˆå¤šé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€|å¯¹å°è£…æ€§å¹¶æ²¡æœ‰å¼ºåˆ¶æ€§çš„è¦æ±‚ã€‚</p></blockquote><p>OO certainly does depend on the idea that programmers are well-behaved enough to not circumvent encapsulated data. Even so, the languages that claim to provide OO have only weakened the once perfect encapsulation we enjoyed with C.</p><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹åœ¨åº”ç”¨ä¸Šç¡®å®ä¼šè¦æ±‚ç¨‹åºå‘˜å°½é‡é¿å…ç ´åæ•°æ®çš„å°è£…æ€§ã€‚ä½†å®é™…æƒ…å†µæ˜¯ï¼Œé‚£äº›å£°ç§°è‡ªå·±æä¾›é¢å‘å¯¹è±¡ç¼–ç¨‹æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œç›¸å¯¹äº C è¿™ç§å®Œç¾å°è£…çš„è¯­è¨€è€Œè¨€ï¼Œå…¶å°è£…æ€§éƒ½è¢«å‰Šå¼±äº†ï¼Œè€Œä¸æ˜¯åŠ å¼ºäº†ã€‚</p></blockquote><h2 id="inheritance-ç»§æ‰¿" tabindex="-1"><a class="header-anchor" href="#inheritance-ç»§æ‰¿" aria-hidden="true">#</a> INHERITANCE? ç»§æ‰¿</h2><p>If OO languages did not give us better encapsulation, then they certainly gave us inheritance.</p><blockquote><p>æ—¢ç„¶é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€å¹¶æ²¡æœ‰æä¾›æ›´å¥½çš„å°è£…æ€§ï¼Œé‚£ä¹ˆåœ¨ç»§æ‰¿æ€§æ–¹é¢åˆå¦‚ä½•å‘¢ï¼Ÿ</p></blockquote><p>Wellâ€”sort of. Inheritance is simply the redeclaration of a group of variables and functions within an enclosing scope. This is something C programmers3 were able to do manually long before there was an OO language.</p><blockquote><p>å—¯ï¼Œå…¶å®ä¹Ÿå°±ä¸€èˆ¬èˆ¬å§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç»§æ‰¿çš„ä¸»è¦ä½œç”¨æ˜¯è®©æˆ‘ä»¬å¯ä»¥åœ¨æŸä¸ªä½œç”¨åŸŸå†…å¯¹å¤–éƒ¨å®šä¹‰çš„æŸä¸€ç»„å˜é‡ä¸å‡½æ•°è¿›è¡Œè¦†ç›–ã€‚è¿™äº‹å®ä¸Šä¹Ÿæ˜¯ c ç¨‹åºå‘˜æ—©åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€å‘æ˜ä¹‹å‰å°±ä¸€ç›´åœ¨åšçš„äº‹äº†ã€‚</p></blockquote><p>Consider this addition to our original point.h C program:</p><blockquote><p>ä¸‹é¢ï¼Œçœ‹ä¸€ä¸‹åˆšæ‰çš„ C ç¨‹åº point.h çš„æ‰©å±•ç‰ˆï¼š</p></blockquote><p>namedPoint.h</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> <span class="token function">makeNamedPoint</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> np<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> np<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>namedPoint.c</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;namedPoint.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
  <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> <span class="token function">makeNamedPoint</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
  p<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
  p<span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> np<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  np<span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> np<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> np<span class="token operator">-&gt;</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.c</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;point.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;namedPoint.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> ac<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> av<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> origin <span class="token operator">=</span> <span class="token function">makeNamedPoint</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token string">&quot;origin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">struct</span> <span class="token class-name">NamedPoint</span><span class="token operator">*</span> upperRight <span class="token operator">=</span> <span class="token function">makeNamedPoint</span>  <span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token string">&quot;upperRight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;distance=%f\n&quot;</span><span class="token punctuation">,</span>
    <span class="token function">distance</span><span class="token punctuation">(</span>
             <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span><span class="token punctuation">)</span> origin<span class="token punctuation">,</span>
             <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Point</span><span class="token operator">*</span><span class="token punctuation">)</span> upperRight<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you look carefully at the main program, youâ€™ll see that the NamedPoint data structure acts as though it is a derivative of the Point data structure. This is because the order of the first two fields in NamedPoint is the same as Point. In short, NamedPoint can masquerade as Point because NamedPoint is a pure superset of Point and maintains the ordering of the members that correspond to Point.</p><blockquote><p>è¯·ä»”ç»†è§‚å¯Ÿ main å‡½æ•°ï¼Œè¿™é‡Œ NamedPoint æ•°æ®ç»“æ„æ˜¯è¢«å½“ä½œ Point æ•°æ®ç»“æ„çš„ä¸€ä¸ªè¡ç”Ÿä½“ä¾†ä½¿ç”¨çš„ã€‚ä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸º NamedPoint ç»“æ„ä½“çš„å‰ä¸¤ä¸ªæˆå‘˜çš„é¡ºç”¨ä¸ Point ç»“æ„ä¼‘çš„å®Œå…¨ä¸€è‡´ã€‚ç®€å•æ¥è¯´ï¼ŒNamedPoint ä¹‹æ‰€ä»¥å¯ä»¥è¢«ä¼ªè£…æˆ Point æ¥ä½¿ç”¨ï¼Œæ˜¯å› ä¸º NamedPoint æ˜¯ Point ç»“æ„ä½“çš„ä¸€ä¸ªè¶…é›†ï¼ŒåŒä¸¤è€…å…±åŒæˆå‘˜çš„é¡ºåºä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p></blockquote><p>This kind of trickery was a common practice4 of programmers prior to the advent of OO. In fact, such trickery is how C++ implements single inheritance.</p><blockquote><p>é¢è¿™ç§ç¼–ç¨‹æ–¹å¼è™½ç„¶çœ‹ä¸Šå»æœ‰äº›æŠ•æœºå–å·§ï¼Œä½†æ˜¯åœ¨é¢å‘å¯¹è±¡ç†è®ºè¢«æå‡ºä¹‹å‰ï¼Œè¿™å·²ç»å¾ˆå¸¸è§äº†ã€‚å…¶å®ï¼ŒC++å†…éƒ¨å°±æ˜¯è¿™æ ·å®ç°å•ç»§æ‰¿çš„ã€‚</p></blockquote><p>Thus we might say that we had a kind of inheritance long before OO languages were invented. That statement wouldnâ€™t quite be true, though. We had a trick, but itâ€™s not nearly as convenient as true inheritance. Moreover, multiple inheritance is a considerably more difficult to achieve by such trickery.</p><blockquote><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œæ—©åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€è¢«å‘æ˜ä¹‹å‰ï¼Œå¯¹ç»§æ‰¿æ€§çš„æ”¯æŒå°±å·²ç»å­˜åœ¨å¾ˆä¹…äº†ã€‚å½“ç„¶äº†ï¼Œè¿™ç§æ”¯æŒç”¨äº†ä¸€äº›æŠ•æœºå–å·§çš„æ‰‹æ®µï¼Œå¹¶ä¸åƒå¦‚ä»Šçš„ç»§æ˜¼ï¼šæ ·ä¾¿åˆ©æ˜“ç”¨ï¼Œè€Œä¸”ï¼Œå¤šé‡ç»§æ‰¿ï¼ˆmultiple inheritanceï¼‰å¦‚æœè¿˜æƒ³ç”¨è¿™ç§æ–¹æ³•æ¥å®ç°ï¼Œå°±æ›´éš¾äº†ã€‚</p></blockquote><p>Note also that in main.c, I was forced to cast the NamedPoint arguments to Point. In a real OO language, such upcasting would be implicit.</p><blockquote><p>åŒæ—¶åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåœ¨ main.c ä¸­ï¼Œç¨‹åºå‘˜å¿…é¡»å¼ºåˆ¶å°† NamedPoint çš„å‚æ•°ç±»å‹è½¬æ¢ä¸º Pointï¼Œè€Œåœ¨çœŸæ­£çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œè¿™ç§ç±»å‹çš„å‘ä¸Šè½¬æ¢é€šå¸¸åº”è¯¥æ˜¯éšæ€§çš„ã€‚</p></blockquote><p>Itâ€™s fair to say that while OO languages did not give us something completely brand new, it did make the masquerading of data structures significantly more convenient.</p><blockquote><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œè™½ç„¶é¢å‘å¯¹è±¡ç¼–ç¨‹åœ¨ç»§æ‰¿æ€§æ–¹é¢å¹¶æ²¡æœ‰å¼€åˆ›å‡ºæ–°ï¼Œä½†æ˜¯çš„ç¡®åœ¨æ•°æ®ç»“æ„çš„ä¼ªè£…æ€§ä¸Šæä¾›äº†ç›¸å½“ç¨‹åº¦çš„ä¾¿åˆ©æ€§ã€‚</p></blockquote><p>To recap: We can award no point to OO for encapsulation, and perhaps a half-point for inheritance. So far, thatâ€™s not such a great score.</p><blockquote><p>å›é¡¾ä¸€ä¸‹åˆ°ç›®å‰ä¸ºæ­¢çš„åˆ†æï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹åœ¨å°è£…æ€§ä¸Šå¾— 0 åˆ†ï¼Œåœ¨ç»§æ‰¿æ€§ä¸Šå‹‰å¼ºå¯ä»¥å¾— 0.5 åˆ†ï¼ˆæ»¡åˆ†ä¸º 1)ã€‚</p></blockquote><p>But thereâ€™s one more attribute to consider.</p><blockquote><p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä¸ªç‰¹æ€§è¦è®¨è®ºã€‚</p></blockquote><h2 id="polymorphism-å¤šæ€" tabindex="-1"><a class="header-anchor" href="#polymorphism-å¤šæ€" aria-hidden="true">#</a> POLYMORPHISM? å¤šæ€</h2><p>Did we have polymorphic behavior before OO languages? Of course we did. Consider this simple C copy program.</p><blockquote><p>åœ¨é¢å‘ç¼–ç¨‹å¯¹è±¡è¯­è¨€è¢«å‘æ˜ä¹‹å‰ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€èƒ½æ”¯æŒå¤šæ€å—? ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè¯·æ³¨æ„çœ‹ä¸‹é¢è¿™æ®µç”¨ C è¯­è¨€ç¼–å†™çš„ copy ç¨‹åºï¼š</p></blockquote><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> c<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The function getchar() reads from STDIN. But which device is STDIN? The putchar() function writes to STDOUT. But which device is that? These functions are polymorphicâ€”their behavior depends on the type of STDIN and STDOUT.</p><blockquote><p>åœ¨ä¸Šè¿°ç¨‹åºä¸­ï¼Œå‡½æ•° <code>getchar()</code> ä¸»è¦è´Ÿè´£ä» STDTN ä¸­è¯»å–æ•°æ®ã€‚ä½†æ˜¯ STDLLN ç©¶ç«ŸæŒ‡ä»£çš„æ˜¯å“ªä¸ªè®¾å¤‡å‘¢ï¼ŸåŒæ ·çš„é“ç†ï¼Œ<code>putchar()</code> ä¸»è¦è´Ÿè´£å°†æ•°æ®å†™å…¥ STDOUTï¼Œè€Œ STDOUT åˆæŒ‡ä»£çš„æ˜¯å“ªä¸ªè®¾å¤‡å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œè¿™ç±»å‡½æ•°å…¶å®å°±å…·æœ‰å¤šæ€æ€§ï¼Œå› ä¸ºå®ƒä»¬çš„è¡Œä¸ºä¾èµ–äº STDIN å’Œ STDOUT çš„å…·ä½“ç±»å‹ã€‚</p></blockquote><p>Itâ€™s as though STDIN and STDOUT are Java-style interfaces that have implementations for each device. Of course, there are no interfaces in the example C programâ€”so how does the call to getchar() actually get delivered to the device driver that reads the character?</p><blockquote><p>è¿™é‡Œçš„ STDIN å’Œ STDOUT ä¸ Java ä¸­çš„æ¥å£ç±»ä¼¼ï¼Œå„ç§è®¾å¤‡éƒ½æœ‰å„è‡ªçš„å®ç°ã€‚å½“ç„¶ï¼Œè¿™ä¸ª C ç¨‹åºä¸­æ˜¯æ²¡æœ‰æ¥å£è¿™ä¸ªæ¦‚å¿µçš„ï¼Œé‚£ä¹ˆ <code>getchar()</code> è¿™ä¸ªè°ƒç”¨çš„åŠ¨ä½œæ˜¯ å¦‚ä½•çœŸæ­£ä¼ é€’åˆ°è®¾å¤‡é©±åŠ¨ç¨‹åºä¸­ï¼Œä»è€Œè¯»å–åˆ°å…·ä½“å†…å®¹çš„å‘¢ï¼Ÿ</p></blockquote><p>The answer to that question is pretty straightforward. The UNIX operating system requires that every IO device driver provide five standard functions:5 open, close, read, write, and seek. The signatures of those functions must be identical for every IO driver.</p><blockquote><p>å…¶å®å¾ˆç®€å•ï¼ŒUNIX æ“ä½œç³»ç»Ÿå¼ºåˆ¶è¦æ±‚æ¯ä¸ª IO è®¾å¤‡éƒ½è¦æä¾› openã€closeã€readã€write å’Œ seek è¿™ 5 ä¸ªæ ‡å‡†å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª IO è®¾å¤‡é©±åŠ¨ç¨‹åºå¯¹è¿™ 5 ç§å‡½æ•°çš„å®ç°åœ¨å‡½æ•°è°ƒç”¨ä¸Šå¿…é¡»ä¿æŒä¸€è‡´ã€‚</p></blockquote><p>The FILE data structure contains five pointers to functions. In our example, it might look like this:</p><blockquote><p>é¦–å…ˆï¼ŒFILE æ•°æ®ç»“æ„ä½“ä¸­åŒ…å«äº†ç›¸å¯¹åº”çš„ 5 ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåˆ†åˆ«ç”¨äºæŒ‡å‘è¿™äº›å‡½æ•°ï¼š</p></blockquote><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">FILE</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>open<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>close<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>read<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>write<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>seek<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">long</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The IO driver for the console will define those functions and load up a FILE data structure with their addressesâ€”something like this:</p><blockquote><p>ç„¶åï¼Œè­¬å¦‚æ§åˆ¶å°è®¾å¤‡çš„ IO é©±åŠ¨ç¨‹åºå°±ä¼šæä¾›è¿™ 5 ä¸ªå‡½æ•°çš„å®é™…å®šä¹‰ï¼Œå°† FILE ç»“æ„ä½“çš„å‡½æ•°æŒ‡é’ˆæŒ‡å‘è¿™äº›å¯¹åº”çš„å®ç°å‡½æ•°ï¼š</p></blockquote><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;file.h&quot;</span></span>

<span class="token keyword">void</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">int</span> c<span class="token punctuation">;</span><span class="token comment">/*...*/</span> <span class="token keyword">return</span> c<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">seek</span><span class="token punctuation">(</span><span class="token keyword">long</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token class-name">FILE</span> console <span class="token operator">=</span> <span class="token punctuation">{</span>open<span class="token punctuation">,</span> close<span class="token punctuation">,</span> read<span class="token punctuation">,</span> write<span class="token punctuation">,</span> seek<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now if STDIN is defined as a <code>FILE*</code>, and if it points to the console data structure, then getchar() might be implemented this way:</p><blockquote><p>ç°åœ¨ï¼Œå¦‚æœ STDIN çš„å®šä¹‰æ˜¯ <code>FILE*</code>ï¼Œå¹¶åŒæ—¶æŒ‡å‘äº† console è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆ <code>getchar()</code> çš„å®ç°æ–¹å¼å°±æ˜¯è¿™æ ·çš„ï¼š</p></blockquote><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">extern</span> <span class="token keyword">struct</span> <span class="token class-name">FILE</span><span class="token operator">*</span> STDIN<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> STDIN<span class="token operator">-&gt;</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In other words, getchar() simply calls the function pointed to by the read pointer of the FILE data structure pointed to by STDIN.</p><blockquote><p>æ¢å¥è¯è¯´ï¼Œ<code>getchar()</code> åªæ˜¯è°ƒç”¨äº† STDIN æ‰€æŒ‡å‘çš„ FIL E æ•°æ®ç»“æ„ä½“ä¸­çš„ read å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°ã€‚</p></blockquote><p>This simple trick is the basis for all polymorphism in OO. In C++, for example, every virtual function within a class has a pointer in a table called a vtable, and all calls to virtual functions go through that table. Constructors of derivatives simply load their versions of those functions into the vtable of the object being created.</p><blockquote><p>è¿™ä¸ªç®€å•çš„ç¼–ç¨‹æŠ€å·§æ­£æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­å¤šæ€çš„åŸºç¡€ã€‚ä¾‹å¦‚åœ¨ C++ä¸­ï¼Œç±»ä¸­çš„æ¯ä¸ªè™šå‡½æ•°ï¼ˆvirtual functionï¼‰çš„åœ°å€éƒ½è¢«è®°å½•åœ¨ä¸€ä¸ªåå« vtable çš„æ•°æ®ç»“æ„é‡Œã€‚æˆ‘ä»¬å¯¹è™šå‡½æ•°çš„æ¯æ¬¡è°ƒç”¨éƒ½è¦å…ˆæŸ¥è¯¢è¿™ä¸ªè¡¨ï¼Œå…¶è¡ç”Ÿç±»çš„æ„é€ å‡½æ•°è´Ÿè´£å°†è¯¥è¡ç”Ÿç±»çš„è™šå‡½æ•°åœ°å€åŠ è½½åˆ°æ•´ä¸ªå¯¹è±¡çš„ vtable ä¸­ã€‚</p></blockquote><p>The bottom line is that polymorphism is an application of pointers to functions. Programmers have been using pointers to functions to achieve polymorphic behavior since Von Neumann architectures were first implemented in the late 1940s. In other words, OO has provided nothing new.</p><blockquote><p>å½’æ ¹ç»“åº•ï¼Œå¤šæ€å…¶å®ä¸è¿‡å°±æ˜¯å‡½æ•°æŒ‡é’ˆçš„ä¸€ç§åº”ç”¨ã€‚è‡ªä» 20 ä¸–çºª 40 å¹´ä»£æœ«æœŸå†¯Â·è¯ºä¾æ›¼æ¶æ„è¯ç”Ÿé‚£å¤©èµ·ï¼Œç¨‹åºå‘˜ä»¬å°±ä¸€ç›´åœ¨ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ¨¡æ‹Ÿå¤šæ€äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹åœ¨å¤šæ€æ–¹é¢æ²¡æœ‰æå‡ºä»»ä½•æ–°æ¦‚å¿µã€‚</p></blockquote><p>Ah, but thatâ€™s not quite correct. OO languages may not have given us polymorphism, but they have made it much safer and much more convenient.</p><blockquote><p>å½“ç„¶äº†ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€è™½ç„¶åœ¨å¤šæ€ä¸Šå¹¶æ²¡æœ‰ç†è®ºåˆ›æ–°ï¼Œä½†å®ƒä»¬ä¹Ÿç¡®å®è®©å¤šæ€å˜å¾—æ›´å®‰å…¨ã€æ›´ä¾¿äºä½¿ç”¨äº†ã€‚</p></blockquote><p>The problem with explicitly using pointers to functions to create polymorphic behavior is that pointers to functions are dangerous. Such use is driven by a set of manual conventions. You have to remember to follow the convention to initialize those pointers. You have to remember to follow the convention to call all your functions through those pointers. If any programmer fails to remember these conventions, the resulting bug can be devilishly hard to track down and eliminate.</p><blockquote><p>ç”¨å‡½æ•°æŒ‡é’ˆæ˜¾å¼å®ç°å¤šæ€çš„é—®é¢˜å°±åœ¨äºå‡½æ•°æŒ‡é’ˆçš„å±é™©æ€§ã€‚æ¯•ç«Ÿï¼Œå‡½æ•°æŒ‡é’ˆçš„è°ƒç”¨ä¾èµ–äºä¸€ç³»åˆ—éœ€è¦äººä¸ºéµå®ˆçš„çº¦å®šã€‚ç¨‹åºå‘˜å¿…é¡»ä¸¥æ ¼æŒ‰ç…§å›ºå®šçº¦å®šæ¥åˆå§‹åŒ–å‡½æ•°æŒ‡é’ˆï¼Œå¹¶åŒæ ·ä¸¥æ ¼åœ°æŒ‰ç…§çº¦å®šæ¥è°ƒç”¨è¿™äº›æŒ‡é’ˆã€‚åªè¦æœ‰ä¸€ä¸ªç¨‹åºå‘˜æ²¡æœ‰éµå®ˆè¿™äº›çº¦å®šï¼Œæ•´ä¸ªç¨‹åºå°±ä¼šäº§ç”Ÿæå…¶éš¾ä»¥è·Ÿè¸ªå’Œæ¶ˆé™¤çš„ Bugã€‚</p></blockquote><p>OO languages eliminate these conventions and, therefore, these dangers. Using an OO language makes polymorphism trivial. That fact provides an enormous power that old C programmers could only dream of. On this basis, we can conclude that OO imposes discipline on indirect transfer of control.</p><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸ºæˆ‘ä»¬æ¶ˆé™¤äººå·¥éµå®ˆè¿™äº›çº¦å®šçš„å¿…è¦ï¼Œä¹Ÿå°±ç­‰äºæ¶ˆé™¤äº†è¿™æ–¹é¢çš„å±é™©æ€§ã€‚é‡‡ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€è®©å¤šæ€å®ç°å˜å¾—éå¸¸ç®€å•ï¼Œè®©ä¸€ä¸ªä¼ ç»Ÿ C ç¨‹åºå‘˜å¯ä»¥å»åšä»¥å‰ä¸æ•¢æƒ³çš„äº‹æƒ…ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¤ä¸ºé¢å‘å¯¹è±¡ç¼–ç¨‹å…¶å®æ˜¯å¯¹ç¨‹åºé—´æ¥æ§åˆ¶æƒçš„è½¬ç§»è¿›è¡Œäº†çº¦æŸã€‚</p></blockquote><h3 id="the-power-of-polymorphism-å¤šæ€çš„å¼ºå¤§æ€§" tabindex="-1"><a class="header-anchor" href="#the-power-of-polymorphism-å¤šæ€çš„å¼ºå¤§æ€§" aria-hidden="true">#</a> THE POWER OF POLYMORPHISM å¤šæ€çš„å¼ºå¤§æ€§</h3><p>Whatâ€™s so great about polymorphism? To better appreciate its charms, letâ€™s reconsider the example copy program. What happens to that program if a new IO device is created? Suppose we want to use the copy program to copy data from a handwriting recognition device to a speech synthesizer device: How do we need to change the copy program to get it to work with those new devices?</p><blockquote><p>é‚£ä¹ˆå¤šæ€çš„ä¼˜åŠ¿åœ¨å“ªé‡Œå‘¢ï¼Ÿä¸ºäº†è®©è¯»è€…æ›´å¥½åœ°ç†è§£å¤šæ€çš„å¥½å¤„ï¼Œæˆ‘ä»¬éœ€è¦å†æ¥çœ‹ä¸€ä¸‹åˆšæ‰çš„ copy ç¨‹åºã€‚å¦‚æœè¦æ”¯æŒæ–°çš„ IO è®¾å¤‡ï¼Œè¯¥ç¨‹åºéœ€è¦åšä»€ä¹ˆæ”¹åŠ¨å‘¢ï¼Ÿè­¬å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦ç”¨è¯¥ copy ç¨‹åºä»ä¸€ä¸ªæ‰‹å†™è¯†åˆ«è®¾å¤‡å°†æ•°æ®å¤åˆ¶åˆ°å¦ä¸€ä¸ªè¯­éŸ³åˆæˆè®¾å¤‡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹ copy ç¨‹åºåšä»€ä¹ˆæ”¹åŠ¨ï¼Œæ‰èƒ½å®ç°è¿™ä¸ªç›®æ ‡å‘¢ï¼Ÿ</p></blockquote><p>We donâ€™t need any changes at all! Indeed, we donâ€™t even need to recompile the copy program. Why? Because the source code of the copy program does not depend on the source code of the IO drivers. As long as those IO drivers implement the five standard functions defined by FILE, the copy program will be happy to use them.</p><blockquote><p>ç­”æ¡ˆæ˜¯å®Œå…¨ä¸éœ€è¦åšä»»ä½•æ”¹åŠ¨ï¼ç¡®å®ï¼Œæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦é‡æ–°ç¼–è¯‘è¯¥ copy ç¨‹åºã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º copy ç¨‹åºçš„æºä»£ç å¹¶ä¸ä¾èµ–äº IO è®¾å¤‡é©±åŠ¨ç¨‹åºçš„ä»£ç ã€‚åªè¦ IO è®¾å¤‡é©±åŠ¨ç¨‹åºå®ç°äº† FILE ç»“æ„ä½“ä¸­å®šä¹‰çš„ 5 ä¸ªæ ‡å‡†å‡½æ•°ï¼Œè¯¥ copy ç¨‹åºå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨å®ƒä»¬ã€‚</p></blockquote><p>In short, the IO devices have become plugins to the copy program.</p><blockquote><p>ç®€å•æ¥è¯´ï¼ŒIO è®¾å¤‡å˜æˆäº† copy ç¨‹åºçš„æ’ä»¶ã€‚</p></blockquote><p>Why did the UNIX operating system make IO devices plugins? Because we learned, in the late 1950s, that our programs should be device independent. Why? Because we wrote lots of programs that were device dependent, only to discover that we really wanted those programs to do the same job but use a different device.</p><blockquote><p>ä¸ºä»€ä¹ˆ UNIX æ“ä½œç³»ç»Ÿä¼šå°† IO è®¾å¤‡è®¾è®¡æˆæ’ä»¶å½¢å¼å‘¢ï¼Ÿå› ä¸ºè‡ª 20 ä¸–çºª 50 å¹´ä»£æœ«æœŸä»¥æ¥ï¼Œæˆ‘ä»¬å­¦åˆ°äº†ä¸€ä¸ªé‡è¦ç»éªŒï¼šç¨‹åºåº”è¯¥ä¸è®¾å¤‡æ— å…³ã€‚è¿™ä¸ªç»éªŒä»ä½•è€Œæ¥å‘¢ï¼Ÿå› ä¸ºä¸€åº¦æ‰€æœ‰ç¨‹åºéƒ½æ˜¯è®¾å¤‡ç›¸å…³çš„ï¼Œä½†æ˜¯åæ¥æˆ‘ä»¬å‘ç°è‡ªå·±å…¶å®çœŸæ­£éœ€è¦çš„æ˜¯åœ¨ä¸åŒçš„è®¾å¤‡ä¸Šå®ç°åŒæ ·çš„åŠŸèƒ½ã€‚</p></blockquote><p>For example, we often wrote programs that read input data from decks of cards,6 and then punched new decks of cards as output. Later, our customers stopped giving us decks of cards and started giving us reels of magnetic tape. This was very inconvenient, because it meant rewriting large portions of the original program. It would be very convenient if the same program worked interchangeably with cards or tape.</p><blockquote><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ›¾ç»å†™è¿‡ä¸€äº›ç¨‹åºï¼Œéœ€è¦ä»å¡ç‰‡ç›’ä¸­çš„æ‰“å­”å¡ç‰‡è¯»å–æ•°æ®ï¼ŒåŒæ—¶è¦é€šè¿‡åœ¨æ–°çš„å¡ç‰‡ä¸Šæ‰“å­”æ¥è¾“å‡ºæ•°æ®ã€‚åæ¥ï¼Œå®¢æˆ·ä¸å†ä½¿ç”¨æ‰“å­”å¡ç‰‡ï¼Œè€Œå¼€å§‹ä½¿ç”¨ç£å¸¦å·äº†ã€‚è¿™å°±ç»™æˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤šéº»çƒ¦ï¼Œå¾ˆå¤šç¨‹åºéƒ½éœ€è¦é‡å†™ã€‚äºæ˜¯æˆ‘ä»¬å°±ä¼šæƒ³ï¼Œå¦‚æœè¿™æ®µç¨‹åºå¯ä»¥åŒæ—¶æ“ä½œæ‰“å­”å¡ç‰‡å’Œç£å¸¦é‚£è¯¥å¤šå¥½ã€‚</p></blockquote><p>The plugin architecture was invented to support this kind of IO device independence, and has been implemented in almost every operating system since its introduction. Even so, most programmers did not extend the idea to their own programs, because using pointers to functions was dangerous.</p><blockquote><p>æ’ä»¶å¼æ¶æ„å°±æ˜¯ä¸ºäº†æ”¯æŒè¿™ç§ IO ä¸ç›¸å…³æ€§è€Œå‘æ˜çš„ï¼Œå®ƒå‡ ä¹åœ¨éšåçš„æ‰€æœ‰ç³»ç»Ÿä¸­éƒ½æœ‰åº”ç”¨ã€‚ä½†å³ä½¿å¤šæ€æœ‰å¦‚æ­¤å¤šä¼˜ç‚¹ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜è¿˜æ˜¯æ²¡æœ‰å°†æ’ä»¶ç‰¹æ€§å¼•å…¥ä»–ä»¬è‡ªå·±çš„ç¨‹åºä¸­ï¼Œå› ä¸ºå‡½æ•°æŒ‡é’ˆå®åœ¨æ˜¯å¤ªå±é™©äº†ã€‚</p></blockquote><p>OO allows the plugin architecture to be used anywhere, for anything.</p><blockquote><p>è€Œé¢å‘å¯¹è±¡ç¼–ç¨‹çš„å‡ºç°ä½¿å¾—è¿™ç§æ’ä»¶å¼æ¶æ„å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«å®‰å…¨åœ°ä½¿ç”¨ã€‚</p></blockquote><h3 id="dependency-inversion-ä¾èµ–åè½¬" tabindex="-1"><a class="header-anchor" href="#dependency-inversion-ä¾èµ–åè½¬" aria-hidden="true">#</a> DEPENDENCY INVERSION ä¾èµ–åè½¬</h3><p>Imagine what software was like before a safe and convenient mechanism for polymorphism was available. In the typical calling tree, main functions called high-level functions, which called mid-level functions, which called low-level functions. In that calling tree, however, source code dependencies inexorably followed the flow of control (Figure 5.1).</p><blockquote><p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸‹åœ¨å®‰å…¨å’Œä¾¿åˆ©çš„å¤šæ€æ”¯æŒå‡ºç°ä¹‹å‰ï¼Œè½¯ä»¶æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ä¸‹é¢æœ‰ä¸€ä¸ªå…¸å‹çš„è°ƒç”¨æ ‘çš„ä¾‹å­ï¼Œmain å‡½æ•°è°ƒç”¨äº†ä¸€äº›é«˜å±‚å‡½æ•°ï¼Œè¿™äº›é«˜å±‚å‡½æ•°åˆè°ƒç”¨äº†ä¸€äº›ä¸­å±‚å‡½æ•°ï¼Œè¿™äº›ä¸­å±‚å‡½æ•°åˆç»§ç»­è°ƒç”¨äº†ä¸€äº›åº•å±‚å‡½æ•°ã€‚åœ¨è¿™é‡Œï¼Œæºä»£ç é¢çš„ä¾èµ–ä¸å¯é¿å…åœ°è¦è·Ÿéšç¨‹åºçš„æ§åˆ¶æµï¼ˆè¯¦è§å›¾ 5.1ï¼‰ã€‚</p></blockquote><!----><p>For mainq1w2e3r4 to call one of the high-level functions, it had to mention the name of the module that contained that function In C, this was a #include. In Java, it was an import statement. In C#, it was a using statement. Indeed, every caller was forced to mention the name of the module that contained the callee.</p><blockquote><p>å¦‚ä½ æ‰€è§ï¼Œmain å‡½æ•°ä¸ºäº†è°ƒç”¨é«˜å±‚å‡½æ•°ï¼Œå®ƒå°±å¿…é¡»èƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªå‡½æ•°æ‰€åœ¨æ¨¡å—ã€‚åœ¨ C ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ #include æ¥å®ç°ï¼Œåœ¨ Java ä¸­åˆ™é€šè¿‡ import æ¥å®ç°ï¼Œè€Œåœ¨ C# ä¸­åˆ™ç”¨çš„æ˜¯ using è¯­å¥ã€‚æ€»ä¹‹ï¼Œæ¯ä¸ªå‡½æ•°çš„è°ƒç”¨æ–¹éƒ½å¿…é¡»è¦å¼•ç”¨è¢«è°ƒç”¨æ–¹æ‰€åœ¨çš„æ¨¡å—ã€‚</p></blockquote><p>This requirement presented the software architect with few, if any, options. The flow of control was dictated by the behavior of the system, and the source code dependencies were dictated by that flow of control.</p><blockquote><p>æ˜¾ç„¶ï¼Œè¿™æ ·åšå°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨è½¯ä»¶æ¶æ„ä¸Šåˆ«æ— é€‰æ‹©ã€‚åœ¨è¿™é‡Œï¼Œç³»ç»Ÿè¡Œä¸ºå†³å®šäº†æ§åˆ¶æµï¼Œè€Œæ§åˆ¶æµåˆ™å†³å®šäº†æºä»£ç ä¾èµ–å…³ç³»ã€‚</p></blockquote><p>When polymorphism is brought into play, however, something very different can happen (Figure 5.2).</p><blockquote><p>ä½†ä¸€æ—¦æˆ‘ä»¬ä½¿ç”¨äº†å¤šæ€ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼ˆè¯¦è§å›¾ 5.2ï¼‰ã€‚</p></blockquote><!----><p>In Figure 5.2, module HL1 calls the F() function in module ML1. The fact that it calls this function through an interface is a source code contrivance. At runtime, the interface doesnâ€™t exist. HL1 simply calls F() within ML1.7</p><blockquote><p>åœ¨å›¾ 5.2 ä¸­ï¼Œæ¨¡å— HL1 è°ƒç”¨äº† ML1 æ¨¡å—ä¸­çš„ F() å‡½æ•°ï¼Œè¿™é‡Œçš„è°ƒç”¨æ˜¯é€šè¿‡æºä»£ç çº§åˆ«çš„æ¥å£æ¥å®ç°çš„ã€‚å½“ç„¶åœ¨ç¨‹åºå®é™…è¿è¡Œæ—¶ï¼Œæ¥å£è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸å­˜åœ¨çš„ï¼ŒHL1 ä¼šè°ƒç”¨ ML1 ä¸­çš„ F() å‡½æ•°ã€‚</p></blockquote><p>Note, however, that the source code dependency (the inheritance relationship) between ML1 and the interface I points in the opposite direction compared to the flow of control. This is called dependency inversion, and its implications for the software architect are profound.</p><blockquote><p>è¯·æ³¨æ„æ¨¡å— ML1 å’Œæ¥å£ I åœ¨æºä»£ç ä¸Šçš„ä¾èµ–å…³ç³»ï¼ˆæˆ–è€…å«ç»§æ‰¿å…³ç³»ï¼‰ï¼Œè¯¥å…³ç³»çš„æ–¹å‘å’Œæ§åˆ¶æµæ­£å¥½æ˜¯ç›¸åçš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºä¾èµ–åè½¬ã€‚è¿™ç§åè½¬å¯¹è½¯ä»¶æ¶æ„è®¾è®¡çš„å½±å“æ˜¯éå¸¸å¤§çš„ã€‚</p></blockquote><p>The fact that OO languages provide safe and convenient polymorphism means that any source code dependency, no matter where it is, can be inverted.</p><blockquote><p>äº‹å®ä¸Šï¼Œé€šè¿‡åˆ©ç”¨é¢å‘ç¼–ç¨‹è¯­è¨€æ‰€æä¾›çš„è¿™ç§å®‰å…¨ä¾¿åˆ©çš„å¤šæ€å®ç°ï¼Œæ— è®ºæˆ‘ä»¬é¢å¯¹æ€æ ·çš„æºä»£ç çº§åˆ«çš„ä¾èµ–å…³ç³»ï¼Œéƒ½å¯ä»¥å°†å…¶åè½¬ã€‚</p></blockquote><p>Now look back at that calling tree in Figure 5.1, and its many source code dependencies. Any of those source code dependencies can be turned around by inserting an interface between them.</p><blockquote><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å†å›å¤´æ¥çœ‹å›¾ 5.1 ä¸­çš„è°ƒç”¨æ ‘ï¼Œå°±ä¼šå‘ç°å…¶ä¸­çš„ä¼—å¤šæºä»£ç ä¾èµ–å…³ç³»éƒ½å¯ä»¥é€šè¿‡å¼•å…¥æ¥å£çš„æ–¹å¼æ¥è¿›è¡Œåè½¬ã€‚</p></blockquote><p>With this approach, software architects working in systems written in OO languages have absolute control over the direction of all source code dependencies in the system. They are not constrained to align those dependencies with the flow of control. No matter which module does the calling and which module is called, the software architect can point the source code dependency in either direction.</p><blockquote><p>é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œè½¯ä»¶æ¶æ„å¸ˆå¯ä»¥å®Œå…¨æ§åˆ¶é‡‡ç”¨äº†é¢å‘å¯¹è±¡è¿™ç§ç¼–ç¨‹æ–¹å¼çš„ç³»ç»Ÿä¸­æ‰€æœ‰çš„æºä»£ç ä¾èµ–å…³ç³»ï¼Œè€Œä¸å†å—åˆ°ç³»ç»Ÿæ§åˆ¶æµçš„é™åˆ¶ã€‚ä¸ç®¡å“ªä¸ªæ¨¡å—è°ƒç”¨æˆ–è€…è¢«è°ƒç”¨ï¼Œè½¯ä»¶æ¶æ„å¸ˆéƒ½å¯ä»¥éšæ„æ›´æ”¹æºä»£ç ä¾èµ–å…³ç³»ã€‚</p></blockquote><p>That is power! That is the power that OO provides. Thatâ€™s what OO is really all aboutâ€”at least from the architectâ€™s point of view.</p><blockquote><p>è¿™å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¥½å¤„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¿™ç§èŒƒå¼çš„æ ¸å¿ƒæœ¬è´¨è‡³å°‘å¯¹ä¸€ä¸ªè½¯ä»¶æ¶æ„å¸ˆæ¥è¯´æ˜¯è¿™æ ·çš„ã€‚</p></blockquote><p>What can you do with that power? As an example, you can rearrange the source code dependencies of your system so that the database and the user interface (UI) depend on the business rules (Figure 5.3), rather than the other way around.</p><blockquote><p>è¿™ç§èƒ½åŠ›æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è®©æ•°æ®åº“æ¨¡å—å’Œç”¨æˆ·ç•Œé¢æ¨¡å—éƒ½ä¾èµ–äºä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼ˆè§å›¾ 5.3ï¼‰ï¼Œè€Œéç›¸åã€‚</p></blockquote><!----><p>This means that the UI and the database can be plugins to the business rules. It means that the source code of the business rules never mentions the UI or the database.</p><blockquote><p>è¿™æ„å‘³ç€æˆ‘ä»¬è®©ç”¨æˆ·ç•Œé¢å’Œæ•°æ®åº“éƒ½æˆä¸ºä¸šåŠ¡é€»è¾‘çš„æ’ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸šåŠ¡é€»è¾‘æ¨¡å—çš„æºä»£ç ä¸éœ€è¦å¼•å…¥ç”¨æˆ·ç•Œé¢å’Œæ•°æ®åº“è¿™ä¸¤ä¸ªæ¨¡å—ã€‚</p></blockquote><p>As a consequence, the business rules, the UI, and the database can be compiled into three separate components or deployment units (e.g., jar files, DLLs, or Gem files) that have the same dependencies as the source code. The component containing the business rules will not depend on the components containing the UI and database.</p><blockquote><p>è¿™æ ·ä¸€æ¥ï¼Œä¸šåŠ¡é€»è¾‘ã€ç”¨æˆ·ç•Œé¢ä»¥åŠæ•°æ®åº“å°±å¯ä»¥è¢«ç¼–è¯‘æˆä¸‰ä¸ªç‹¬ç«‹çš„ç»„ä»¶æˆ–è€…éƒ¨ç½²å•å…ƒï¼ˆä¾‹å¦‚ jar æ–‡ä»¶ã€DLL æ–‡ä»¶ã€Gem æ–‡ä»¶ç­‰ï¼‰äº†ï¼Œè¿™äº›ç»„ä»¶æˆ–è€…éƒ¨ç½²å•å…ƒçš„ä¾èµ–å…³ç³»ä¸æºä»£ç çš„ä¾èµ–å…³ç³»æ˜¯ä¸€è‡´çš„ï¼Œä¸šåŠ¡é€»è¾‘ç»„ä»¶ä¹Ÿä¸ä¼šä¾èµ–äºç”¨æˆ·ç•Œé¢å’Œæ•°æ®åº“è¿™ä¸¤ä¸ªç»„ä»¶ã€‚</p></blockquote><p>In turn, the business rules can be deployed independently of the UI and the database. Changes to the UI or the database need not have any effect on the business rules. Those components can be deployed separately and independently.</p><blockquote><p>äºæ˜¯ï¼Œä¸šåŠ¡é€»è¾‘ç»„ä»¶å°±å¯ä»¥ç‹¬ç«‹äºç”¨æˆ·ç•Œé¢å’Œæ•°æ®åº“æ¥è¿›è¡Œéƒ¨ç½²äº†ï¼Œæˆ‘ä»¬å¯¹ç”¨æˆ·ç•Œé¢æˆ–è€…æ•°æ®åº“çš„ä¿®æ”¹å°†ä¸ä¼šå¯¹ä¸šåŠ¡é€»è¾‘äº§ç”Ÿä»»ä½•å½±å“ï¼Œè¿™äº›ç»„ä»¶éƒ½å¯ä»¥è¢«åˆ†å¦ç‹¬ç«‹åœ°éƒ¨ç½²ã€‚</p></blockquote><p>In short, when the source code in a component changes, only that component needs to be redeployed. This is independent deployability.</p><blockquote><p>ç®€å•æ¥è¯´ï¼Œå½“æŸä¸ªç»„ä»¶çš„æºä»£ç éœ€è¦ä¿®æ”¹æ—¶ï¼Œä»…ä»…éœ€è¦é‡æ–°éƒ¨ç½²è¯¥ç»„ä»¶ï¼Œä¸éœ€è¦æ›´æ”¹å…¶ä»–ç»„ä»¶ï¼Œè¿™å°±æ˜¯ç‹¬ç«‹éƒ¨ç½²èƒ½åŠ›ã€‚</p></blockquote><p>If the modules in your system can be deployed independently, then they can be developed independently by different teams. Thatâ€™s independent developability.</p><blockquote><p>å¦‚æœç³»ç»Ÿä¸­çš„æ‰€æœ‰ç»„ä»¶éƒ½å¯ä»¥ç‹¬ç«‹éƒ¨ç½²ï¼Œé‚£å®ƒä»¬å°±å¯ä»¥ç”±ä¸åŒçš„å›¢é˜Ÿå¹¶è¡Œå¼€å‘ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ç‹¬ç«‹å¼€å‘èƒ½åŠ›ã€‚</p></blockquote><h2 id="conclusion-æœ¬ç« å°ç»“" tabindex="-1"><a class="header-anchor" href="#conclusion-æœ¬ç« å°ç»“" aria-hidden="true">#</a> CONCLUSION æœ¬ç« å°ç»“</h2><p>What is OO? There are many opinions and many answers to this question. To the software architect, however, the answer is clear: OO is the ability, through the use of polymorphism, to gain absolute control over every source code dependency in the system. It allows the architect to create a plugin architecture, in which modules that contain high-level policies are independent of modules that contain low-level details. The low-level details are relegated to plugin modules that can be deployed and developed independently from the modules that contain high-level policies.</p><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿä¸šç•Œåœ¨è¿™ä¸ªé—®é¢˜ä¸Šå­˜åœ¨ç€å¾ˆå¤šä¸åŒçš„è¯´æ³•å’Œæ„è§ã€‚ç„¶è€Œå¯¹ä¸€ä¸ªè½¯ä»¶æ¶æ„å¸ˆæ¥è¯´ï¼Œå…¶å«ä¹‰åº”è¯¥æ˜¯éå¸¸æ˜ç¡®çš„ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹å°±æ˜¯ä»¥å¯¹è±¡ä¸ºæ‰‹æ®µæ¥å¯¹æºä»£ç ä¸­çš„ä¾èµ–å…³ç³»è¿›è¡Œæ§åˆ¶çš„èƒ½åŠ›ï¼Œè¿™ç§èƒ½åŠ›è®©è½¯ä»¶æ¶æ„å¸ˆå¯ä»¥æ„å»ºå‡ºæŸç§æ’ä»¶å¼æ¶æ„ï¼Œè®©é«˜å±‚ç­–ç•¥æ€§ç»„ä»¶ä¸åº•å±‚å®ç°æ€§ç»„ä»¶ç›¸åˆ†ç¦»ï¼Œåº•å±‚ç»„ä»¶å¯å¿…ç¼–è¯‘æˆæ’ä»¶ï¼Œå®ç°ç‹¬ç«‹äºé«˜å±‚ç»„ä»¶çš„å¼€å‘å’Œéƒ¨ç½²ã€‚</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/windily-cloud/obsidian-publish/edit/main/Publish/Publish/Clean Archtechture/ch5.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/9/20 11:11:04</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: wwww.4399li@qq.com">windilycloud</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link prev" aria-label="ch4.md"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-file"></span>ch4.md</div></a><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch6.html" class="nav-link next" aria-label="ch6.md"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">ch6.md<span class="icon iconfont icon-file"></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">ä»€ä¹ˆæ˜¯å¹¸è¤”ï¼Ÿ å¹¸ç¦å°±æ˜¯çŒ«åƒé±¼ç‹—åƒè‚‰ï¼Œå¥¥ç‰¹æ›¼æ‰“å°æ€ªå…½ï¼</div><div class="copyright">Copyright Â© 2022 Windily-Cloud</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/obsidian-publish/assets/app.887b133c.js" defer></script>
  </body>
</html>
