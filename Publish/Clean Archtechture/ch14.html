<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://windily-cloud.github.io/obsidian-publish/Publish/Clean%20Archtechture/ch14.html"><meta property="og:site_name" content="Windily Cloud"><meta property="og:title" content="Chap14. COMPONENT COUPLING ç»„ä»¶è€¦åˆ"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-09-20T11:11:04.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-09-20T11:11:04.000Z"><title>Chap14. COMPONENT COUPLING ç»„ä»¶è€¦åˆ | Windily Cloud</title><meta name="description" content="Windily Cloud's Blog">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/obsidian-publish/assets/style.12da8f21.css">
    <link rel="modulepreload" href="/obsidian-publish/assets/app.887b133c.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch14.html.199a9f38.js"><link rel="modulepreload" href="/obsidian-publish/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch14.html.9cf7c1a7.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c7e76e53.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.f01af163.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.d24325cb.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.fc3247cd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.279a3dae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.ad67b7a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.74f49c94.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.7b8b868f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.0897d88d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.871f1a29.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.1ee0e012.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.b2dc5528.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.d50b6029.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.f9083031.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.a8daed86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.f712f0c4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.008de7bb.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.bc3946ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.dcd080ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.4bd6fad0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.5af7f550.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.cdcf732e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.d56c6b1b.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.1d0c5f03.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.a9585c5e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.7898d2ef.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.4e106aa0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.efd82950.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.054b22ad.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.25d75f30.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.058b06f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.61d3f411.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.a6691c1e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.326ac1a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.b00c3f6a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.4e35799e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.f553bf58.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.1abe47e0.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.61a30e56.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.c688cf00.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.19a54833.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e97d623d.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.59f213ed.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.565d8d69.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.8c97282e.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.7a0981ad.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.609d0549.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.0ce08377.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.cc115e5e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.60ae3ce2.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c09081fd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.70634028.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.3b70efd7.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.f5a6049f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.d91b9c1f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.32852561.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0a68a710.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.93b7cca5.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.a1c9d7de.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0da27cdd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.b850d04a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.5aa5f6f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.413c371f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.3cd7a242.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.175ce04d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.fc4a1701.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.5b8799e9.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.20b93b21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.165fc3da.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.4cd429e5.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.3e2d64e7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.384a9648.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.b1ad3804.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.58811bd6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.44e934ae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.d77e680e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.79a8927d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.a6d9e7e0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.c53b41bf.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.fdbedd86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.8d17578d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.69ad75a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.ef8bfaee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.d5d16d0e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.33b5c44c.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.6c12ea21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.7adbcd24.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.c7a5cd99.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.f4b07606.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.0f2533d2.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.c64dc16e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.d8f304e4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.ac3dd3f7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.e8bdc588.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.f20e95e2.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.46fb949d.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.37fde797.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e291bbe5.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.7deee47f.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.6126ed62.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.f99ad030.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.f2f4101a.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.9eadd293.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.71c36bf1.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.24a96f75.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b76fc3f0.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.ba71ba2a.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.103ba7cd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.7d4c0d5f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b1a4c497.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0c6eca16.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.394348dd.js"><link rel="prefetch" href="/obsidian-publish/assets/auto.56c9cb2e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.1f644ee1.js"><link rel="prefetch" href="/obsidian-publish/assets/flowchart.parse.1479ec3f.js"><link rel="prefetch" href="/obsidian-publish/assets/mermaid.esm.min.0e041931.js"><link rel="prefetch" href="/obsidian-publish/assets/highlight.esm.9b852bc5.js"><link rel="prefetch" href="/obsidian-publish/assets/markdown.esm.77e8db25.js"><link rel="prefetch" href="/obsidian-publish/assets/math.esm.cb9d4be3.js"><link rel="prefetch" href="/obsidian-publish/assets/notes.esm.62c5f19d.js"><link rel="prefetch" href="/obsidian-publish/assets/reveal.esm.41ec5d7f.js"><link rel="prefetch" href="/obsidian-publish/assets/search.esm.04894411.js"><link rel="prefetch" href="/obsidian-publish/assets/zoom.esm.78977eba.js"><link rel="prefetch" href="/obsidian-publish/assets/VuePlayground.3cfc7758.js"><link rel="prefetch" href="/obsidian-publish/assets/photoswipe.esm.f594e77b.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/obsidian-publish/" class="brand"><img class="logo" src="/obsidian-publish/logo.svg" alt="Windily Cloud"><!----><span class="site-name hide-in-pad">Windily Cloud</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><span class="icon iconfont icon-home"></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/home.html" class="nav-link" aria-label="å›¾è°±"><span class="icon iconfont icon-home"></span>å›¾è°±<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="ä¸»é¢˜æ–‡æ¡£" class="nav-link"><span class="icon iconfont icon-note"></span>ä¸»é¢˜æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/windily-cloud/obsidian-publish" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><a href="/obsidian-publish/" class="title">Vault</a><!----></p><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">è§é—»</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">Obsidian</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><span class="title">Clean Archtechture</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/" class="nav-link sidebar-link sidebar-page" aria-label="README.md"><span class="icon iconfont icon-file"></span>README.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/afterword.html" class="nav-link sidebar-link sidebar-page" aria-label="afterword.md"><span class="icon iconfont icon-file"></span>afterword.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch1.html" class="nav-link sidebar-link sidebar-page" aria-label="ch1.md"><span class="icon iconfont icon-file"></span>ch1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch10.html" class="nav-link sidebar-link sidebar-page" aria-label="ch10.md"><span class="icon iconfont icon-file"></span>ch10.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch11.html" class="nav-link sidebar-link sidebar-page" aria-label="ch11.md"><span class="icon iconfont icon-file"></span>ch11.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch12.html" class="nav-link sidebar-link sidebar-page" aria-label="ch12.md"><span class="icon iconfont icon-file"></span>ch12.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch13.html" class="nav-link sidebar-link sidebar-page" aria-label="ch13.md"><span class="icon iconfont icon-file"></span>ch13.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ch14.md"><span class="icon iconfont icon-file"></span>ch14.md<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-acyclic-dependencies-principle-æ— ä¾èµ–ç¯åŸåˆ™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE ACYCLIC DEPENDENCIES PRINCIPLE æ— ä¾èµ–ç¯åŸåˆ™"><!---->THE ACYCLIC DEPENDENCIES PRINCIPLE æ— ä¾èµ–ç¯åŸåˆ™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-weekly-build-æ¯å‘¨æ„å»º" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE WEEKLY BUILD æ¯å‘¨æ„å»º"><!---->THE WEEKLY BUILD æ¯å‘¨æ„å»º<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#eliminating-dependency-cycles-æ¶ˆé™¤å¾ªç¯ä¾èµ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ELIMINATING DEPENDENCY CYCLES æ¶ˆé™¤å¾ªç¯ä¾èµ–"><!---->ELIMINATING DEPENDENCY CYCLES æ¶ˆé™¤å¾ªç¯ä¾èµ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-effect-of-a-cycle-in-the-component-dependency-graph-å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE EFFECT OF A CYCLE IN THE COMPONENT DEPENDENCY GRAPH å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“"><!---->THE EFFECT OF A CYCLE IN THE COMPONENT DEPENDENCY GRAPH å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#breaking-the-cycle-æ‰“ç ´å¾ªç¯ä¾èµ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="BREAKING THE CYCLE æ‰“ç ´å¾ªç¯ä¾èµ–"><!---->BREAKING THE CYCLE æ‰“ç ´å¾ªç¯ä¾èµ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-jitters-æŠ–åŠ¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE â€œJITTERSâ€ â€œæŠ–åŠ¨â€"><!---->THE â€œJITTERSâ€ â€œæŠ–åŠ¨â€<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#top-down-design-è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="TOP-DOWN DESIGN è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡"><!---->TOP-DOWN DESIGN è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-stable-dependencies-principle-ç¨³å®šä¾èµ–åŸåˆ™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE STABLE DEPENDENCIES PRINCIPLE ç¨³å®šä¾èµ–åŸåˆ™"><!---->THE STABLE DEPENDENCIES PRINCIPLE ç¨³å®šä¾èµ–åŸåˆ™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#stability-ç¨³å®šæ€§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="STABILITY ç¨³å®šæ€§"><!---->STABILITY ç¨³å®šæ€§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#stability-metrics-ç¨³å®šæ€§æŒ‡æ ‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="STABILITY METRICS ç¨³å®šæ€§æŒ‡æ ‡"><!---->STABILITY METRICS ç¨³å®šæ€§æŒ‡æ ‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#not-all-components-should-be-stable-å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="NOT ALL COMPONENTS SHOULD BE STABLE å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„"><!---->NOT ALL COMPONENTS SHOULD BE STABLE å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#abstract-components-æŠ½è±¡ç»„ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Abstract Components æŠ½è±¡ç»„ä»¶"><!---->Abstract Components æŠ½è±¡ç»„ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™"><!---->THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#where-do-we-put-the-high-level-policy-é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="WHERE DO WE PUT THE HIGH-LEVEL POLICY? é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ"><!---->WHERE DO WE PUT THE HIGH-LEVEL POLICY? é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#introducing-the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="INTRODUCING THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹"><!---->INTRODUCING THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#measuring-abstraction-è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MEASURING ABSTRACTION è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦"><!---->MEASURING ABSTRACTION è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-main-sequence-ä¸»åºåˆ—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE MAIN SEQUENCE ä¸»åºåˆ—"><!---->THE MAIN SEQUENCE ä¸»åºåˆ—<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-zone-of-pain-ç—›è‹¦åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="The Zone of Pain ç—›è‹¦åŒº"><!---->The Zone of Pain ç—›è‹¦åŒº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-zone-of-uselessness-æ— ç”¨åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="The Zone of Uselessness æ— ç”¨åŒº"><!---->The Zone of Uselessness æ— ç”¨åŒº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#avoiding-the-zones-of-exclusion-é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AVOIDING THE ZONES OF EXCLUSION é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ"><!---->AVOIDING THE ZONES OF EXCLUSION é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#distance-from-the-main-sequence-ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="DISTANCE FROM THE MAIN SEQUENCE ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»"><!---->DISTANCE FROM THE MAIN SEQUENCE ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#conclusion-æœ¬ç« å°ç»“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CONCLUSION æœ¬ç« å°ç»“"><!---->CONCLUSION æœ¬ç« å°ç»“<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch15.html" class="nav-link sidebar-link sidebar-page" aria-label="ch15.md"><span class="icon iconfont icon-file"></span>ch15.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch16.html" class="nav-link sidebar-link sidebar-page" aria-label="ch16.md"><span class="icon iconfont icon-file"></span>ch16.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch17.html" class="nav-link sidebar-link sidebar-page" aria-label="ch17.md"><span class="icon iconfont icon-file"></span>ch17.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch18.html" class="nav-link sidebar-link sidebar-page" aria-label="ch18.md"><span class="icon iconfont icon-file"></span>ch18.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch19.html" class="nav-link sidebar-link sidebar-page" aria-label="ch19.md"><span class="icon iconfont icon-file"></span>ch19.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch2.html" class="nav-link sidebar-link sidebar-page" aria-label="ch2.md"><span class="icon iconfont icon-file"></span>ch2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch20.html" class="nav-link sidebar-link sidebar-page" aria-label="ch20.md"><span class="icon iconfont icon-file"></span>ch20.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch21.html" class="nav-link sidebar-link sidebar-page" aria-label="ch21.md"><span class="icon iconfont icon-file"></span>ch21.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch22.html" class="nav-link sidebar-link sidebar-page" aria-label="ch22.md"><span class="icon iconfont icon-file"></span>ch22.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch23.html" class="nav-link sidebar-link sidebar-page" aria-label="ch23.md"><span class="icon iconfont icon-file"></span>ch23.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch24.html" class="nav-link sidebar-link sidebar-page" aria-label="ch24.md"><span class="icon iconfont icon-file"></span>ch24.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html" class="nav-link sidebar-link sidebar-page" aria-label="ch25.md"><span class="icon iconfont icon-file"></span>ch25.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch26.html" class="nav-link sidebar-link sidebar-page" aria-label="ch26.md"><span class="icon iconfont icon-file"></span>ch26.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch27.html" class="nav-link sidebar-link sidebar-page" aria-label="ch27.md"><span class="icon iconfont icon-file"></span>ch27.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch28.html" class="nav-link sidebar-link sidebar-page" aria-label="ch28.md"><span class="icon iconfont icon-file"></span>ch28.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch29.html" class="nav-link sidebar-link sidebar-page" aria-label="ch29.md"><span class="icon iconfont icon-file"></span>ch29.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch3.html" class="nav-link sidebar-link sidebar-page" aria-label="ch3.md"><span class="icon iconfont icon-file"></span>ch3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch30.html" class="nav-link sidebar-link sidebar-page" aria-label="ch30.md"><span class="icon iconfont icon-file"></span>ch30.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch31.html" class="nav-link sidebar-link sidebar-page" aria-label="ch31.md"><span class="icon iconfont icon-file"></span>ch31.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch32.html" class="nav-link sidebar-link sidebar-page" aria-label="ch32.md"><span class="icon iconfont icon-file"></span>ch32.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch33.html" class="nav-link sidebar-link sidebar-page" aria-label="ch33.md"><span class="icon iconfont icon-file"></span>ch33.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html" class="nav-link sidebar-link sidebar-page" aria-label="ch34.md"><span class="icon iconfont icon-file"></span>ch34.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link sidebar-link sidebar-page" aria-label="ch4.md"><span class="icon iconfont icon-file"></span>ch4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html" class="nav-link sidebar-link sidebar-page" aria-label="ch5.md"><span class="icon iconfont icon-file"></span>ch5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch6.html" class="nav-link sidebar-link sidebar-page" aria-label="ch6.md"><span class="icon iconfont icon-file"></span>ch6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch7.html" class="nav-link sidebar-link sidebar-page" aria-label="ch7.md"><span class="icon iconfont icon-file"></span>ch7.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch8.html" class="nav-link sidebar-link sidebar-page" aria-label="ch8.md"><span class="icon iconfont icon-file"></span>ch8.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch9.html" class="nav-link sidebar-link sidebar-page" aria-label="ch9.md"><span class="icon iconfont icon-file"></span>ch9.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part1.html" class="nav-link sidebar-link sidebar-page" aria-label="part1.md"><span class="icon iconfont icon-file"></span>part1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part2.html" class="nav-link sidebar-link sidebar-page" aria-label="part2.md"><span class="icon iconfont icon-file"></span>part2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part3.html" class="nav-link sidebar-link sidebar-page" aria-label="part3.md"><span class="icon iconfont icon-file"></span>part3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part4.html" class="nav-link sidebar-link sidebar-page" aria-label="part4.md"><span class="icon iconfont icon-file"></span>part4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part5.html" class="nav-link sidebar-link sidebar-page" aria-label="part5.md"><span class="icon iconfont icon-file"></span>part5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part6.html" class="nav-link sidebar-link sidebar-page" aria-label="part6.md"><span class="icon iconfont icon-file"></span>part6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/%E5%AF%BC%E8%88%AA.html" class="nav-link sidebar-link sidebar-page" aria-label="å¯¼èˆª.md"><span class="icon iconfont icon-file"></span>å¯¼èˆª.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Chap14. COMPONENT COUPLING ç»„ä»¶è€¦åˆ</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://windily-cloud.github.io" target="_blank" rel="noopener noreferrer">Windily-Cloud</a></span><span property="author" content="Windily-Cloud"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´9æœˆ20æ—¥</span><meta property="datePublished" content="2022-09-20T11:03:58.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 47 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT47M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#chap14-component-coupling-ç»„ä»¶è€¦åˆ" class="router-link-active router-link-exact-active toc-link level1">Chap14. COMPONENT COUPLING ç»„ä»¶è€¦åˆ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-acyclic-dependencies-principle-æ— ä¾èµ–ç¯åŸåˆ™" class="router-link-active router-link-exact-active toc-link level2">THE ACYCLIC DEPENDENCIES PRINCIPLE æ— ä¾èµ–ç¯åŸåˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#top-down-design-è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡" class="router-link-active router-link-exact-active toc-link level2">TOP-DOWN DESIGN è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-stable-dependencies-principle-ç¨³å®šä¾èµ–åŸåˆ™" class="router-link-active router-link-exact-active toc-link level2">THE STABLE DEPENDENCIES PRINCIPLE ç¨³å®šä¾èµ–åŸåˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™" class="router-link-active router-link-exact-active toc-link level2">THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html#conclusion-æœ¬ç« å°ç»“" class="router-link-active router-link-exact-active toc-link level2">CONCLUSION æœ¬ç« å°ç»“</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="chap14-component-coupling-ç»„ä»¶è€¦åˆ" tabindex="-1"><a class="header-anchor" href="#chap14-component-coupling-ç»„ä»¶è€¦åˆ" aria-hidden="true">#</a> Chap14. COMPONENT COUPLING ç»„ä»¶è€¦åˆ</h1><p>The next three principles deal with the relationships between components. Here again we will run into the tension between develop-ability and logical design. The forces that impinge upon the architecture of a component structure are technical, political, and volatile.</p><blockquote><p>æ¥ä¸‹æ¥è¦è®¨è®ºçš„ä¸‰æ¡åŸåˆ™ä¸»è¦å…³æ³¨çš„æ˜¯ç»„ä»¶ä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™äº›åŸåˆ™ä¸­ï¼Œæˆ‘ä»¬åŒæ ·ä¼šé¢ä¸´ç€ç ”å‘èƒ½åŠ›å’Œé€»è¾‘è®¾è®¡ä¹‹é—´çš„å†²çªã€‚æ¯•ç«Ÿï¼Œå½±å“ç»„ä»¶ç»“æ„çš„ä¸ä»…æœ‰æŠ€æœ¯æ°´å¹³å’Œå…¬å¸å†…éƒ¨æ”¿æ²»æ–—äº‰è¿™ä¸¤ä¸ªå› ç´ ï¼Œå…¶ç»“æ„æœ¬èº«æ›´æ˜¯ä¸æ–­å˜åŒ–çš„ã€‚</p></blockquote><h2 id="the-acyclic-dependencies-principle-æ— ä¾èµ–ç¯åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#the-acyclic-dependencies-principle-æ— ä¾èµ–ç¯åŸåˆ™" aria-hidden="true">#</a> THE ACYCLIC DEPENDENCIES PRINCIPLE æ— ä¾èµ–ç¯åŸåˆ™</h2><p>Allow no cycles in the component dependency graph.</p><blockquote><p>ç»„ä»¶ä¾èµ–å…³ç³»å›¾ä¸­ä¸åº”è¯¥å‡ºç°ç¯ã€‚</p></blockquote><p>Have you ever worked all day, gotten some stuff working, and then gone home, only to arrive the next morning to find that your stuff no longer works? Why doesnâ€™t it work? Because somebody stayed later than you and changed something you depend on! I call this â€œthe morning after syndrome.â€</p><blockquote><p>æˆ‘ä»¬ä¸€å®šéƒ½æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼šå½“ä½ èŠ±äº†ä¸€æ•´å¤©çš„æ—¶é—´ï¼Œå¥½ä¸å®¹æ˜“æå®šäº†ä¸€æ®µä»£ç ï¼Œç¬¬äºŒå¤©ä¸Šç­æ—¶å´å‘ç°è¿™æ®µä»£ç è«åå…¶å¦™åœ°åˆä¸èƒ½å·¥ä½œäº†ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºæœ‰äººåœ¨ä½ èµ°åä¿®æ”¹äº†ä½ æ‰€ä¾èµ–çš„æŸä¸ªç»„ä»¶ã€‚æˆ‘ç»™è¿™ç§æƒ…å†µèµ·äº†ä¸ªåå­—â€”â€”â€œä¸€è§‰é†’æ¥ç»¼åˆå¾â€ã€‚</p></blockquote><p>The â€œmorning after syndromeâ€ occurs in development environments where many developers are modifying the same source files. In relatively small projects with just a few developers, it isnâ€™t too big a problem. But as the size of the project and the development team grow, the mornings after can get pretty nightmarish. It is not uncommon for weeks to go by without the team being able to build a stable version of the project. Instead, everyone keeps on changing and changing their code trying to make it work with the last changes that someone else made.</p><blockquote><p>è¿™ç§ç»¼åˆå¾çš„ä¸»è¦ç—…å› æ˜¯å¤šä¸ªç¨‹åºå‘˜åŒæ—¶ä¿®æ”¹äº†åŒä¸€ä¸ªæºä»£ç æ–‡ä»¶ã€‚è™½ç„¶åœ¨è§„æ¨¡ç›¸å¯¹è¾ƒå°ã€äººå‘˜è¾ƒå°‘çš„é¡¹ç›®ä¸­ï¼Œè¿™ç§é—®é¢˜æˆ–è®¸å¹¶ä¸ä¸¥é‡ï¼Œä½†æ˜¯éšç€é¡¹ç›®çš„å¢é•¿ï¼Œç ”å‘äººå‘˜çš„å¢åŠ ï¼Œè¿™ç§æ¯å¤©æ—©ä¸Šåˆšä¸Šç­æ—¶éƒ½è¦ç»å†ä¸€éçš„ç—›è‹¦å°±ä¼šè¶Šæ¥è¶Šå¤šã€‚ç”šè‡³ä¼šä¸¥é‡åˆ°è®©æœ‰çš„å›¢é˜Ÿåœ¨é•¿è¾¾æ•°å‘¨çš„æ—¶é—´å†…éƒ½ä¸èƒ½å‘å¸ƒä¸€ä¸ªç¨³å®šçš„é¡¹ç›®ç‰ˆæœ¬ï¼Œå› ä¸ºæ¯ä¸ªäººéƒ½åœ¨ä¸åœåœ°ä¿®æ”¹è‡ªå·±çš„ä»£ç ï¼Œä»¥é€‚åº”å…¶ä»–äººæ‰€æäº¤çš„å˜æ›´ã€‚</p></blockquote><p>Over the last several decades, two solutions to this problem have evolved, both of which came from the telecommunications industry. The first is â€œthe weekly build,â€ and the second is the Acyclic Dependencies Principle (ADP).</p><blockquote><p>åœ¨è¿‡å»å‡ åå¹´ä¸­ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜é€æ¸æ¼”åŒ–å‡ºäº†ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œå®ƒä»¬éƒ½æ¥è‡ªç”µä¿¡è¡Œä¸šã€‚ç¬¬ä¸€ç§æ˜¯â€œæ¯å‘¨æ„å»ºâ€ï¼Œç¬¬äºŒç§æ˜¯â€œæ— ä¾èµ–ç¯åŸåˆ™ï¼ˆADPï¼‰â€ã€‚</p></blockquote><h3 id="the-weekly-build-æ¯å‘¨æ„å»º" tabindex="-1"><a class="header-anchor" href="#the-weekly-build-æ¯å‘¨æ„å»º" aria-hidden="true">#</a> THE WEEKLY BUILD æ¯å‘¨æ„å»º</h3><p>The weekly build used to be common in medium-sized projects. It works like this: All the developers ignore each other for the first four days of the week. They all work on private copies of the code, and donâ€™t worry about integrating their work on a collective basis. Then, on Friday, they integrate all their changes and build the system.</p><blockquote><p>æ¯å‘¨æ„å»ºæ–¹æ¡ˆæ˜¯ä¸­å‹é¡¹ç›®ä¸­å¾ˆå¸¸è§çš„ä¸€ç§ç®¡ç†æ‰‹æ®µã€‚å…¶å…·ä½“åšæ³•å¦‚ä¸‹ï¼šåœ¨æ¯å‘¨çš„å‰å››å¤©ä¸­ï¼Œè®©æ‰€æœ‰çš„ç¨‹åºå‘˜åœ¨è‡ªå·±çš„ç§æœ‰åº“ä¸Šå·¥ä½œï¼Œå¿½ç•¥å…¶ä»–äººçš„ä¿®æ”¹ï¼Œä¹Ÿä¸è€ƒè™‘äº’ç›¸ä¹‹é—´çš„é›†æˆé—®é¢˜ï¼›ç„¶ååœ¨æ¯å‘¨äº”è¦æ±‚æ‰€æœ‰äººå°†è‡ªå·±æ‰€åšçš„å˜æ›´æäº¤ï¼Œè¿›è¡Œç»Ÿä¸€æ„å»ºã€‚</p></blockquote><p>This approach has the wonderful advantage of allowing the developers to live in an isolated world for four days out of five. The disadvantage, of course, is the large integration penalty that is paid on Friday.</p><blockquote><p>ä¸Šè¿°æ–¹æ¡ˆç¡®å®å¯ä»¥è®©ç¨‹åºå‘˜æ¯å‘¨éƒ½æœ‰å››å¤©çš„æ—¶é—´æ”¾æ‰‹å¹²æ´»ã€‚ç„¶è€Œä¸€åˆ°æ˜ŸæœŸäº”ï¼Œæ‰€æœ‰äººéƒ½å¿…é¡»è¦èŠ±è´¹å¤§é‡çš„ç²¾åŠ›æ¥å¤„ç†å‰å››å¤©ç•™ä¸‹æ¥çš„é—®é¢˜ã€‚</p></blockquote><p>Unfortunately, as the project grows, it becomes less feasible to finish integrating the project on Friday. The integration burden grows until it starts to overflow into Saturday. A few such Saturdays are enough to convince the developers that integration should really begin on Thursdayâ€”and so the start of integration slowly creeps toward the middle of the week.</p><blockquote><p>è€Œä¸”æ›´ä¸å¹¸çš„æ˜¯ï¼Œéšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œæ¯å‘¨äº”çš„é›†æˆå·¥ä½œä¼šè¶Šæ¥è¶Šéš¾ä»¥æŒ‰æ—¶å®Œæˆã€‚è€Œéšç€é›†æˆä»»åŠ¡è¶Šæ¥è¶Šé‡ï¼Œå‘¨å…­çš„åŠ ç­ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šé¢‘ç¹ã€‚ç»å†è¿‡å‡ æ¬¡è¿™æ ·çš„åŠ ç­ä¹‹åï¼Œå°±ä¼šæœ‰äººæå‡ºåº”è¯¥å°†é›†æˆä»»åŠ¡æå‰åˆ°æ˜ŸæœŸå››å¼€å§‹ï¼Œå°±è¿™æ ·ä¸€æ­¥ä¸€æ­¥åœ°ï¼Œé›†æˆå·¥ä½œæ¼«æ¼«åœ°å°±è¦å ç”¨æ‰å·®ä¸å¤šåŠå‘¨çš„æ—¶é—´ã€‚</p></blockquote><p>As the duty cycle of development versus integration decreases, the efficiency of the team decreases, too. Eventually this situation becomes so frustrating that the developers, or the project managers, declare that the schedule should be changed to a biweekly build. This suffices for a time, but the integration time continues to grow with project size.</p><blockquote><p>äº‹å®ä¸Šï¼Œè¿™ä¸ªé—®é¢˜æœ€ç»ˆè¿˜ä¼šé€ æˆæ›´å¤§çš„éº»çƒ¦ã€‚å› ä¸ºå¦‚æœæˆ‘ä»¬æƒ³æ­©ä¿æŒé«˜æ•ˆç‡çš„å¼€å‘ï¼Œå°±ä¸èƒ½é¢‘ç¹åœ°è¿›è¡Œæ„å»ºæ“ä½œï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å‡å°‘äº†æ„å»ºæ¬¡æ•°ï¼Œå»¶é•¿äº†é¡¹ç›®è¢«æ„å»ºçš„æ—¶é—´é—´éš”ï¼Œåˆä¼šå½±å“åˆ°è¯¥é¡¹ç›®çš„è´¨é‡ï¼Œå¢å¤§å®ƒçš„é£é™©ã€‚æ•´ä¸ªé¡¹ç›®ä¼šå˜å¾—è¶Šæ¥è¶Šéš¾ä»¥æ„å»ºä¸æµ‹è¯•ï¼Œå›¢é˜Ÿåé¦ˆå‘¨æœŸä¼šè¶Šæ¥è¶Šé•¿ï¼Œç ”å‘è´¨é‡è‡ªç„¶ä¹Ÿä¼šè¶Šæ¥è¶Šå·®ã€‚</p></blockquote><p>Eventually, this scenario leads to a crisis. To maintain efficiency, the build schedule has to be continually lengthenedâ€”but lengthening the build schedule increases project risks. Integration and testing become increasingly harder to do, and the team loses the benefit of rapid feedback.</p><h3 id="eliminating-dependency-cycles-æ¶ˆé™¤å¾ªç¯ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#eliminating-dependency-cycles-æ¶ˆé™¤å¾ªç¯ä¾èµ–" aria-hidden="true">#</a> ELIMINATING DEPENDENCY CYCLES æ¶ˆé™¤å¾ªç¯ä¾èµ–</h3><p>The solution to this problem is to partition the development environment into releasable components. The components become units of work that can be the responsibility of a single developer, or a team of developers. When developers get a component working, they release it for use by the other developers. They give it a release number and move it into a directory for other teams to use. They then continue to modify their component in their own private areas. Everyone else uses the released version.</p><blockquote><p>å¯¹äºä¸Šè¿°æƒ…æ™¯ï¼Œæˆ‘ä»¬çš„è§£å†³åŠæ³•æ˜¯å°†ç ”å‘é¡¹ç›®åˆ’åˆ†ä¸ºä¸€äº›å¯å•ç‹¬å‘å¸ƒçš„ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥äº¤ç”±å•äººæˆ–è€…æŸä¸€ç»„ç¨‹åºå‘˜æ¥ç‹¬ç«‹å®Œæˆã€‚å½“æœ‰äººæˆ–å›¢é˜Ÿå®ŒæˆæŸä¸ªç»„ä»¶çš„æŸä¸ªç‰ˆæœ¬æ—¶ï¼Œä»–ä»¬å°±ä¼šé€šè¿‡å‘å¸ƒæœºåˆ¶é€šçŸ¥å…¶ä»–ç¨‹åºå‘˜ï¼Œå¹¶ç»™è¯¥ç»„ä»¶æ‰“ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ”¾å…¥ä¸€ä¸ªå…±äº«ç›®å½•ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥ä¾èµ–äºè¿™äº›ç»„ä»¶å…¬å¼€å‘å¸ƒçš„ç‰ˆæœ¬æ¥è¿›è¡Œå¼€å‘ï¼Œè€Œç»„ä»¶å¼€å‘è€…åˆ™å¯ä»¥ç»§ç»­å»ä¿®æ”¹è‡ªå·±çš„ç§æœ‰ç‰ˆæœ¬ã€‚</p></blockquote><p>As new releases of a component are made available, other teams can decide whether they will immediately adopt the new release. If they decide not to, they simply continue using the old release. Once they decide that they are ready, they begin to use the new release.</p><blockquote><p>æ¯å½“ä¸€ä¸ªç»„ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œå…¶ä»–ä¾èµ–è¿™ä¸ªç»„ä»¶çš„å›¢é˜Ÿéƒ½å¯ä»¥è‡ªä¸»å†³å®šæ˜¯å¦ç«‹å³é‡‡ç”¨æ–°ç‰ˆæœ¬ã€‚è‹¥ä¸é‡‡ç”¨ï¼Œè¯¥å›¢é˜Ÿå¯ä»¥é€‰æ‹©ç»§ç»­ä½¿ç”¨æ—§ç‰ˆç»„ä»¶ï¼Œç›´åˆ°ä»–ä»¬å‡†å¤‡å¥½é‡‡ç”¨æ–°ç‰ˆæœ¬ä¸ºæ­¢ã€‚</p></blockquote><p>Thus no team is at the mercy of the others. Changes made to one component do not need to have an immediate affect on other teams. Each team can decide for itself when to adapt its own components to new releases of the components. Moreover, integration happens in small increments. There is no single point in time when all developers must come together and integrate everything they are doing.</p><blockquote><p>è¿™æ ·å°±ä¸ä¼šå‡ºç°å›¢é˜Ÿä¹‹é—´ç›¸äº’ä¾èµ–çš„æƒ…å†µäº†ã€‚ä»»ä½•ä¸€ä¸ªç»„ä»¶ä¸Šçš„å˜æ›´éƒ½ä¸ä¼šç«‹åˆ»å½±å“åˆ°å…¶ä»–å›¢é˜Ÿã€‚æ¯ä¸ªå›¢é˜Ÿéƒ½å¯ä»¥è‡ªä¸»å†³å®šæ˜¯å¦ç«‹å³é›†æˆè‡ªå·±æ‰€ä¾èµ–ç»„ä»¶çš„æ–°ç‰ˆæœ¬ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä½¿æˆ‘ä»¬çš„é›†æˆå·¥ä½œèƒ½ä»¥ä¸€ç§å°å‹æ¸è¿›çš„æ–¹å¼æ¥è¿›è¡Œã€‚ç¨‹åºå‘˜ä»¬å†ä¹Ÿä¸éœ€è¦é›†ä¸­åœ¨ä¸€èµ·ï¼Œç»Ÿä¸€é›†æˆç›¸äº’çš„å˜æ›´äº†ã€‚</p></blockquote><p>This is a very simple and rational process, and it is widely used. To make it work successfully, however, you must manage the dependency structure of the components. There can be no cycles. If there are cycles in the dependency structure, then the â€œmorning after syndromeâ€ cannot be avoided.</p><blockquote><p>å¦‚ä½ æ‰€è§ï¼Œä¸Šè¿°æ•´ä¸ªè¿‡ç¨‹æ—¢ç®€å•åˆå¾ˆç¬¦åˆé€»è¾‘ï¼Œå› è€Œå¾—åˆ°äº†å„ä¸ªç ”å‘å›¢é˜Ÿçš„å¹¿æ³›é‡‡ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³è¦æˆåŠŸæ¨å¹¿è¿™ä¸ªå¼€å‘æµç¨‹ï¼Œå°±å¿…é¡»æ§åˆ¶å¥½ç»„ä»¶ä¹‹é—´çš„ä¾èµ–ç»“æ„ï¼Œç»å¯¹ä¸èƒ½å…è®¸è¯¥ç»“æ„ä¸­å­˜åœ¨ç€å¾ªç¯ä¾èµ–å…³ç³»ã€‚å¦‚æœæŸé¡¹ç›®ç»“æ„ä¸­å­˜åœ¨ç€å¾ªç¯ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆâ€œä¸€è§‰é†’æ¥ç»¼åˆå¾â€å°†æ˜¯ä¸å¯é¿å…çš„ã€‚</p></blockquote><p>Consider the component diagram in Figure 14.1. It shows a rather typical structure of components assembled into an application. The function of this application is unimportant for the purpose of this example. What is important is the dependency structure of the components. Notice that this structure is a directed graph. The components are the nodes, and the dependency relationships are the directed edges.</p><blockquote><p>ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹çœ‹å›¾ 14.1ï¼Œè¯¥å›¾å±•ç¤ºäº†ä¸€ä¸ªå…¸å‹åº”ç”¨ç¨‹åºçš„ç»„ä»¶ç»“æ„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºçš„å…·ä½“åŠŸèƒ½ä¸æˆ‘ä»¬è¦è®¨è®ºçš„æ— å…³ï¼ŒçœŸæ­£é‡è¦çš„æ˜¯å…¶ç»„ä»¶ä¹‹é—´çš„ä¾èµ–ç»“æ„ã€‚æˆ‘ä»¬åº”è¯¥å¯ä»¥æ³¨æ„åˆ°ï¼Œè¯¥ç»„ä»¶ä¾èµ–ç»“æ„æ‰€å‘ˆç°çš„æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªé¡¹ç›®ç»„ä»¶ï¼Œä¾èµ–å…³ç³»å°±æ˜¯æœ‰å‘å›¾ä¸­çš„è¾¹ã€‚</p></blockquote><!----><p>Notice one more thing: Regardless of which component you begin at, it is impossible to follow the dependency relationships and wind up back at that component. This structure has no cycles. It is a directed acyclic graph (DAG).</p><blockquote><p>æ›´é‡è¦çš„æ˜¯ï¼Œä¸ç®¡æˆ‘ä»¬ä»è¯¥å›¾ä¸­çš„å“ªä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œéƒ½ä¸èƒ½æ²¿ç€è¿™äº›ä»£è¡¨äº†ä¾èµ–å…³ç³»çš„è¾¹æœ€ç»ˆèµ°å›åˆ°èµ·å§‹ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§ç»“æ„ä¸­ä¸å­˜åœ¨åï¼Œæˆ‘ä»¬ç§°è¿™ç§ç»“æ„ä¸ºæœ‰å‘æ— ç¯å›¾ï¼ˆDirected Acyclic Graphï¼Œç®€å†™ä¸º DAGï¼‰ã€‚</p></blockquote><p>Now consider what happens when the team responsible for Presenters makes a new release of their component. It is easy to find out who is affected by this release; you just follow the dependency arrows backward. Thus View and Main will both be affected. The developers currently working on those components will have to decide when they should integrate their work with the new release of Presenters.</p><blockquote><p>ç°åœ¨ï¼Œå¦‚æœè´Ÿè´£ Presenters ç»„ä»¶çš„å›¢é˜Ÿéœ€è¦å‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å°±åº”è¯¥å¾ˆå®¹æ˜“åˆ¤æ–­å‡ºå“ªäº›ç»„ä»¶ä¼šå—è¿™ä¸ªå˜æ›´çš„å½±å“â€”â€”åªéœ€è¦æŒ‰å…¶ä¾èµ–å…³ç³»åå‘è¿½æº¯å³å¯ã€‚æ˜¾ç„¶åœ¨å›¾ 14.1 ä¸­ï¼ŒView å’Œ Main æ˜¯åŒæ—¶ä¼šè¢«å½±å“çš„ä¸¤ä¸ªç»„ä»¶ã€‚è¿™ä¸¤ä¸ªç»„ä»¶çš„ç ”å‘å›¢é˜Ÿéœ€è¦å†³å®šæ˜¯å¦é‡‡ç”¨ Presenters ç»„ä»¶çš„æ–°ç‰ˆæœ¬ã€‚</p></blockquote><p>Notice also that when Main is released, it has utterly no effect on any of the other components in the system. They donâ€™t know about Main, and they donâ€™t care when it changes. This is nice. It means that the impact of releasing Main is relatively small.</p><blockquote><p>å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ Main ç»„ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œå®ƒå¯¹ç³»ç»Ÿä¸­çš„å…¶ä»–ç»„ä»¶æ ¹æœ¬å°±æ²¡æœ‰å½±å“ï¼Œæ—¢æ²¡æœ‰ä¸€ä¸ªç»„ä»¶ä¾èµ–äº Mainï¼Œä¹Ÿå°±æ²¡æœ‰äººå…³ç³» Main ç»„ä»¶ä¸Šå‘ç”Ÿçš„å˜æ›´ã€‚è¿™å¤ªå¥½äº†ï¼Œè‡³å°‘è¡¨ç¤ºæˆ‘ä»¬åœ¨å‘å¸ƒ Main çš„æ–°ç‰ˆæœ¬æ—¶ï¼Œå¯ä»¥ä¸å¿…è€ƒè™‘å®ƒå¯¹æ•´ä¸ªé¡¹ç›®å¾®ä¹å…¶å¾®çš„å½±å“ã€‚</p></blockquote><p>When the developers working on the Presenters component would like to run a test of that component, they just need to build their version of Presenters with the versions of the Interactors and Entities components that they are currently using. None of the other components in the system need be involved. This is nice. It means that the developers working on Presenters have relatively little work to do to set up a test, and that they have relatively few variables to consider.</p><blockquote><p>å½“ Presenters ç»„ä»¶çš„ç¨‹åºå‘˜ä»¬éœ€è¦è¿›è¡Œä¸€æ¬¡æµ‹è¯•æ—¶ï¼Œä»–ä»¬åªéœ€å°†å¯¹åº”ç‰ˆæœ¬çš„ Presenters å’Œ Interactors åŠ Entities çš„å½“å‰ç‰ˆæœ¬ä¸€èµ·æ„å»ºå¹¶æµ‹è¯•å³å¯ï¼Œå…¶ä»–çš„ç»„ä»¶ä¸éœ€è¦åšä»»ä½•ä¿®æ”¹ã€‚è¿™å¯ä»¥è®©ç¼–å†™ Presenters ç»„ä»¶çš„ç¨‹åºå‘˜ä»¬åœ¨ç¼–å†™æµ‹è¯•æ—¶è€ƒè™‘æ›´å°‘çš„å˜é‡ï¼Œå·¥ä½œé‡æ›´å°ã€‚</p></blockquote><p>When it is time to release the whole system, the process proceeds from the bottom up. First the Entities component is compiled, tested, and released. Then the same is done for Database and Interactors. These components are followed by Presenters, View, Controllers, and then Authorizer. Main goes last. This process is very clear and easy to deal with. We know how to build the system because we understand the dependencies between its parts.</p><blockquote><p>å½“æˆ‘ä»¬éœ€è¦å‘å¸ƒæ•´ä¸ªç³»ç»Ÿæ—¶ï¼Œå¯ä»¥è®©æ•´ä¸ªè¿‡ç¨‹ä»ä¸‹è‡³ä¸Šæ¥è¿›è¡Œã€‚è²ä½“æ¥è¯´å°±æ˜¯é¦–å…ˆå¯¹ Entities ç»„ä»¶è¿›è¡Œç¼–è¯‘ã€æµ‹è¯•ã€å‘å¸ƒã€‚éšåæ˜¯ Database å’Œ Interactors è¿™ä¸¤ä¸ªç»„ä»¶ã€‚å†ç´§éšå…¶åçš„æ˜¯ Presentersã€Viewã€Controllersï¼Œä»¥åŠ Authorizer å››ä¸ªç»„ä»¶ã€‚æœ€åæ˜¯ Main ç»„ä»¶ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ•´ä¸ªæµç¨‹ä¼šéå¸¸æ¸…æ™°ï¼Œä¹Ÿå¾ˆå®¹æ˜“ã€‚åªè¦æˆ‘ä»¬äº†è§£ç³»ç»Ÿå„éƒ¨åˆ†ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ„å»ºæ•´å¥—ç³»ç»Ÿå°±ä¼šå˜å¾—å¾ˆå®¹æ˜“ã€‚</p></blockquote><h3 id="the-effect-of-a-cycle-in-the-component-dependency-graph-å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“" tabindex="-1"><a class="header-anchor" href="#the-effect-of-a-cycle-in-the-component-dependency-graph-å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“" aria-hidden="true">#</a> THE EFFECT OF A CYCLE IN THE COMPONENT DEPENDENCY GRAPH å¾ªç¯ä¾èµ–åœ¨ç»„ä»¶ä¾èµ–å›¾ä¸­çš„å½±å“</h3><p>Suppose that a new requirement forces us to change one of the classes in Entities such that it makes use of a class in Authorizer. For example, letâ€™s say that the User class in Entities uses the Permissions class in Authorizer. This creates a dependency cycle, as shown in Figure 14.2.</p><blockquote><p>å‡è®¾æŸä¸ªæ–°éœ€æ±‚ä½¿æˆ‘ä»¬ä¿®æ”¹äº† Entities ç»„ä»¶ä¸­çš„æŸä¸ªç±»ï¼Œè€Œè¿™ä¸ªç±»åˆä¾èµ–äº Authorizer ç»„ä»¶ä¸­çš„æŸä¸ªç±»ã€‚ä¾‹å¦‚ï¼ŒEntities ç»„ä»¶ä¸­çš„ User ç±»ä½¿ç”¨äº† Authorizer ç»„ä»¶ä¸­çš„ Permissions ç±»ã€‚è¿™å°±å½¢æˆäº†ä¸€ä¸ªå¾ªç¯ä¾èµ–å…³ç³»ï¼Œå¦‚å›¾ 14.2 æ‰€ç¤ºã€‚</p></blockquote><p>This cycle creates some immediate problems. For example, the developers working on the Database component know that to release it, the component must be compatible with Entities. However, with the cycle in place, the Database component must now also be compatible with Authorizer. But Authorizer depends on Interactors. This makes Database much more difficult to release. Entities, Authorizer, and Interactors have, in effect, become one large componentâ€”which means that all of the developers working on any of those components will experience the dreaded â€œmorning after syndrome.â€ They will be stepping all over one another because they must all use exactly the same release of one anotherâ€™s components.</p><blockquote><p>è¿™ç§å¾ªç¯ä¾èµ–ç«‹åˆ»å°±ä¼šç»™æˆ‘ä»¬çš„é¡¹ç›®å¸¦æ¥éº»çƒ¦ã€‚ä¾‹å¦‚ï¼Œå½“ Database ç»„ä»¶çš„ç¨‹åºå‘˜éœ€è¦å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œä»–ä»¬éœ€è¦ä¸ Entities ç»„ä»¶è¿›è¡Œé›†æˆã€‚ä½†ç°åœ¨ç”±äºå‡ºç°äº†å¾ªç¯ä¾èµ–ï¼ŒDatabase ç»„ä»¶å°±å¿…é¡»ä¹Ÿè¦ä¸ Authorizer ç»„ä»¶å…¼å®¹ï¼Œè€Œ Authorizer ç»„ä»¶åˆä¾èµ–äº Interactors ç»„ä»¶ã€‚è¿™æ ·ä¸€æ¥ï¼ŒDatabase ç»„ä»¶çš„å‘å¸ƒå°±ä¼šå˜å¾—éå¸¸å›°éš¾ã€‚åœ¨è¿™é‡Œï¼ŒEntitiesã€Authorizer åŠ Interactors è¿™ä¸‰ä¸ªç»„ä»¶äº‹å®ä¸Šè¢«åˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„ç»„ä»¶ã€‚è¿™äº›ç»„ä»¶çš„ç¨‹åºå‘˜ç°åœ¨ä¼šäº’ç›¸å½¢æˆå¹²æ‰°ï¼Œå› ä¸ºä»–ä»¬åœ¨å¼€å‘ä¸­éƒ½å¿…é¡»ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç»„ä»¶ç‰ˆæœ¬ã€‚</p></blockquote><!----><p>But this is just part of the trouble. Consider what happens when we want to test the Entities component. To our chagrin, we find that we must build and integrate with Authorizer and Interactors. This level of coupling between components is troubling, if not intolerable.</p><blockquote><p>è¿™è¿˜åªæ˜¯é—®é¢˜çš„å†°å±±ä¸€è§’ï¼Œè¯·æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬åœ¨æµ‹è¯• Entities ç»„ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæƒ…å†µä¼šè®©äººè§¦ç›®æƒŠå¿ƒæˆ‘ä»¬ä¼šå‘ç°è‡ªå·±å¿…é¡»å°† Authorizer å’Œ Interactors é›†æˆåˆ°ä¸€èµ·æµ‹è¯•ã€‚å³ä½¿è¿™ä¸æ˜¯ä¸èƒ½å®¹å¿çš„äº‹ï¼Œä½†è‡³å°‘è¿™äº›ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ä¹Ÿæ˜¯éå¸¸ä»¤äººä¸å®‰çš„ã€‚</p></blockquote><p>You may have wondered why you have to include so many different libraries, and so much of everybody elseâ€™s stuff, just to run a simple unit test of one of your classes. If you investigate the matter a bit, you will probably discover that there are cycles in the dependency graph. Such cycles make it very difficult to isolate components. Unit testing and releasing become very difficult and error prone. In addition, build issues grow geometrically with the number of modules.</p><blockquote><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™æ ·ä¸€ä¸ªå°å°çš„æµ‹è¯•å¿…é¡»è¦ä¾èµ–å¤§é‡çš„åº“å°±æ˜¯å› ä¸ºå…¶ç»„ä»¶ç»“æ„ä¾èµ–å›¾ä¸­å­˜åœ¨çš„è¿™ä¸ªå¾ªç¯ä¾èµ–ã€‚è¿™ç§å¾ªç¯ä¾èµ–ä¼šä½¿å¾—ç»„ä»¶çš„ç‹¬ç«‹ç»´æŠ¤å·¥ä½œå˜å¾—ååˆ†å›°éš¾ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå•å…ƒæµ‹è¯•å’Œå‘å¸ƒæµç¨‹ä¹Ÿéƒ½ä¼šå˜å¾—éå¸¸å›°éš¾ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å‡ºé”™ã€‚æ­¤å¤–ï¼Œé¡¹ç›®åœ¨æ„å»ºä¸­å‡ºç°çš„é—®é¢˜ä¼šéšç€ç»„ä»¶æ•°é‡çš„å¢å¤šè€Œå‘ˆç°å‡ºå‡ ä½•çº§æ•°çš„å¢é•¿ã€‚</p></blockquote><p>Moreover, when there are cycles in the dependency graph, it can be very difficult to work out the order in which you must build the components. Indeed, there probably is no correct order. This can lead to some very nasty problems in languages like Java that read their declarations from compiled binary files.</p><blockquote><p>æ‰€ä»¥ï¼Œå½“ç»„ä»¶ç»“æ„ä¾èµ–å›¾ä¸­å­˜åœ¨å¾ªç¯ä¾èµ–æ—¶ï¼Œæƒ³è¦æŒ‰æ­£ç¡®çš„é¡ºåºæ„å»ºç»„ä»¶å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™ç§ä¾èµ–å…³ç³»å°†ä¼šåœ¨ Java è¿™ç§éœ€è¦åœ¨ç¼–è¯‘å¥½çš„äºŒçº§åˆ¶æ–‡ä»¶ä¸­è¯»å–å£°æ˜ä¿¡æ¯çš„è¯­è¨€ä¸­å¯¼è‡´ä¸€äº›éå¸¸æ£˜æ‰‹çš„é—®é¢˜ã€‚</p></blockquote><h3 id="breaking-the-cycle-æ‰“ç ´å¾ªç¯ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#breaking-the-cycle-æ‰“ç ´å¾ªç¯ä¾èµ–" aria-hidden="true">#</a> BREAKING THE CYCLE æ‰“ç ´å¾ªç¯ä¾èµ–</h3><p>It is always possible to break a cycle of components and reinstate the dependency graph as a DAG. There are two primary mechanisms for doing so:</p><blockquote><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“ç ´è¿™äº›ç»„ä»¶ä¸­çš„å¾ªç¯ä¾èµ–ï¼Œå¹¶å°†å…¶ä¾èµ–å›¾è½¬åŒ–ä¸º DAGã€‚ç›®å‰æœ‰ä»¥ä¸‹ä¸¤ç§ä¸»è¦æœºåˆ¶å¯ä»¥åšåˆ°è¿™ä»¶äº‹æƒ…ã€‚</p></blockquote><ol><li>Apply the Dependency Inversion Principle (DIP). In the case in Figure 14.3, we could create an interface that has the methods that User needs. We could then put that interface into Entities and inherit it into Authorizer. This inverts the dependency between Entities and Authorizer, thereby breaking the cycle.</li></ol><blockquote><ol><li>åº”ç”¨ä¾èµ–åè½¬åŸåˆ™ï¼ˆDIPï¼‰ï¼šåœ¨å›¾ 14.3 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª User ç±»éœ€è¦ä½¿ç”¨çš„æ¥å£ï¼Œç„¶åå°†è¿™ä¸ªæ¥å£æ”¾å…¥ Entities ç»„ä»¶ï¼Œå¹¶åœ¨ Authorizer ç»„ä»¶ä¸­ç»§æ‰¿å®ƒã€‚è¿™æ ·å°±å°† Entities ä¸ Authorizer ä¹‹é—´çš„ä¾èµ–å…³ç³»åè½¬äº†ï¼Œè‡ªç„¶ä¹Ÿå°±æ‰“ç ´äº†å¾ªç¯ä¾èµ–å…³ç³»ã€‚</li></ol></blockquote><!----><ol start="2"><li>Create a new component that both Entities and Authorizer depend on. Move the class(es) that they both depend on into that new component (Figure 14.4).</li></ol><blockquote><ol start="2"><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œå¹¶è®© Entities ä¸ Authorize è¿™ä¸¤ä¸ªç»„ä»¶éƒ½ä¾èµ–äºå®ƒã€‚å°†ç°æœ‰çš„è¿™ä¸¤ä¸ªç»„ä»¶ä¸­äº’ç›¸ä¾èµ–çš„ç±»å…¨éƒ¨æ”¾å…¥æ–°ç»„ä»¶ï¼ˆå¦‚å›¾ 14.4 æ‰€ç¤ºï¼‰ã€‚</li></ol></blockquote><!----><h3 id="the-jitters-æŠ–åŠ¨" tabindex="-1"><a class="header-anchor" href="#the-jitters-æŠ–åŠ¨" aria-hidden="true">#</a> THE â€œJITTERSâ€ â€œæŠ–åŠ¨â€</h3><p>The second solution implies that the component structure is volatile in the presence of changing requirements. Indeed, as the application grows, the component dependency structure jitters and grows. Thus the dependency structure must always be monitored for cycles. When cycles occur, they must be broken somehow. Sometimes this will mean creating new components, making the dependency structure grow.</p><blockquote><p>å½“ç„¶ï¼Œé‡‡ç”¨ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¹Ÿæ„å‘³ç€åœ¨éœ€æ±‚å˜æ›´æ—¶ï¼Œé¡¹ç›®çš„ç»„ä»¶ç»“æ„ä¹Ÿè¦éšä¹‹å˜æ›´ã€‚ç¡®å®æ˜¯è¿™æ ·çš„ï¼Œéšç€åº”ç”¨ç¨‹åºçš„ä¸æ–­æ¼”è¿›ï¼Œå…¶ç»„ä»¶ç»“æ„ä¹Ÿä¼šä¸åœåœ°æŠ–åŠ¨å’Œæ‰©å¼ ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è¦æŒç»­åœ°ç›‘æ§é¡¶ç›®ä¸­çš„å¾ªç¯ä¾èµ–å…³ç³»ã€‚å½“å¾ªç¯ä¾èµ–å‡ºç°æ—¶ï¼Œå¿…é¡»ä»¥æŸç§åŠ›å¼æ¶ˆé™¤å®ƒä»¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¸å¯é¿å…åœ°éœ€è¦åˆ›å»ºæ–°çš„ç»„ä»¶ï¼Œè€Œä½¿æ•´ä¸ªç»„ä»¶ç»“æ„å˜å¾—æ›´å¤§ã€‚</p></blockquote><h2 id="top-down-design-è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#top-down-design-è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡" aria-hidden="true">#</a> TOP-DOWN DESIGN è‡ªä¸Šè€Œä¸‹çš„è®¾è®¡</h2><p>The issues we have discussed so far lead to an inescapable conclusion: The component structure cannot be designed from the top down. It is not one of the first things about the system that is designed, but rather evolves as the system grows and changes.</p><blockquote><p>æ ¹æ®ä¸Šè¿°è®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæ— æ³•é€ƒé¿çš„ç»“è®ºï¼šç»„ä»¶ç»“æ„å›¾æ˜¯ä¸å¯èƒ½è‡ªä¸Šè€Œä¸‹è¢«è®¾è®¡å‡ºæ¥çš„ã€‚å®ƒå¿…é¡»éšç€è½¯ä»¶ç³»ç»Ÿçš„å˜åŒ–è€Œå˜åŒ–å’Œæ‰©å¼ ï¼Œè€Œä¸å¯èƒ½åœ¨ç³»ç»Ÿæ„å»ºçš„æœ€åˆå°±è¢«å®Œç¾è®¾è®¡å‡ºæ¥ã€‚</p></blockquote><p>Some readers may find this point to be counterintuitive. We have come to expect that large-grained decompositions, like components, will also be high-level functional decompositions.</p><blockquote><p>æœ‰äº›è¯»è€…å¯èƒ½ä¼šè§‰å¾—è¿™ä¸ªç»“è®ºæœ‰äº›åç›´è§‰ã€‚äººä»¬é€šå¸¸ä¼šç›´è§‚åœ°è®¤ä¸ºï¼Œä»£è¡¨é¡¹ç›®ç²—ç²’åº¦çš„ç»“æ„å•å…ƒï¼Œä¹Ÿå°±æ˜¯ç»„ä»¶ï¼Œåº”è¯¥ä¸é¡¶å±‚è®¾è®¡ä¸­çš„åŠŸèƒ½å•å…ƒæ˜¯ç›¸å¯¹åº”çš„ã€‚</p></blockquote><p>When we see a large-grained grouping such as a component dependency structure, we believe that the components ought to somehow represent the functions of the system. Yet this does not seem to be an attribute of component dependency diagrams.</p><blockquote><p>åŒæ ·çš„ï¼Œäººä»¬ä¹Ÿæ™®éè®¤ä¸ºé¡¹ç›®ç²—ç²’åº¦çš„ç»„ä»¶åˆ†ç»„è§„åˆ™æ‰€äº§ç”Ÿçš„å°±æ˜¯ç»„ä»¶çš„ä¾èµ–ç»“æ„ï¼Œä¹Ÿåº”è¯¥åœ¨æŸç§ç¨‹åº¦ä¸Šä¸é¡¹ç›®çš„ç³»ç»ŸåŠŸèƒ½åˆ†è§£çš„ç»“æœç›¸äº’å¯¹åº”ã€‚ä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œç»„ä»¶ä¾èµ–å…³ç³»å›¾å…¶å®ä¸å…·å¤‡è¿™æ ·çš„å±æ€§ã€‚</p></blockquote><p>In fact, component dependency diagrams have very little do to with describing the function of the application. Instead, they are a map to the buildability and maintainability of the application. This is why they arenâ€™t designed at the beginning of the project. There is no software to build or maintain, so there is no need for a build and maintenance map. But as more and more modules accumulate in the early stages of implementation and design, there is a growing need to manage the dependencies so that the project can be developed without the â€œmorning after syndrome.â€ Moreover, we want to keep changes as localized as possible, so we start paying attention to the SRP and CCP and collocate classes that are likely to change together.</p><blockquote><p>äº‹å®ä¸Šï¼Œç»„ä»¶ä¾èµ–ç»“æ„å›¾å¹¶ä¸æ˜¯ç”¨æ¥æè¿°åº”ç”¨ç¨‹åºåŠŸèƒ½çš„ï¼Œå®ƒæ›´åƒæ˜¯åº”ç”¨ç¨‹åºåœ¨æ„å»ºæ€§ä¸ç»´æŠ¤æ€§æ–¹é¢çš„ä¸€å¼ åœ°å›¾ã€‚è¿™å°±æ˜¯ç»„ä»¶çš„ä¾èµ–ç»“æ„å›¾ä¸èƒ½åœ¨é¡¹ç›®çš„å¼€å§‹é˜¶æ®µè¢«è®¾è®¡å‡ºæ¥çš„åŸå› â€”â€”å½“æ—¶è¯¥é¡¹ç›®è¿˜æ²¡æœ‰ä»»ä½•è¢«æ„å»ºå’Œç»´æŠ¤çš„éœ€è¦ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸éœ€è¦ä¸€å¼ åœ°å›¾æ¥æŒ‡å¼•ã€‚ç„¶è€Œï¼Œéšç€æ—©æœŸè¢«è®¾è®¡å¹¶å®ç°å‡ºæ¥çš„æ¨¡å—è¶Šæ¥è¶Šå¤šï¼Œé¡¹ç›®ä¸­å°±é€æ¸å‡ºç°äº†è¦å¯¹ç»„ä»¶ä¾èµ–å…³ç³»è¿›è¡Œç®¡ç†çš„éœ€æ±‚ï¼Œä»¥æ­¤æ¥é¢„é˜²â€œä¸€è§‰é†’æ¥ç»¼åˆå¾â€çš„çˆ†å‘ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›å°†é¡¹ç›®å˜æ›´æ‰€å½±å“çš„èŒƒå›´è¢«é™åˆ¶å¾—è¶Šå°è¶Šå¥½ï¼Œå› æ­¤éœ€è¦åº”ç”¨å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰å’Œå…±åŒé—­åŒ…åŸåˆ™ï¼ˆCCPï¼‰æ¥å°†ç»å¸¸åŒæ—¶è¢«å˜æ›´çš„ç±»èšåˆåœ¨ä¸€èµ·ã€‚</p></blockquote><p>One of the overriding concerns with this dependency structure is the isolation of volatility. We donâ€™t want components that change frequently and for capricious reasons to affect components that otherwise ought to be stable. For example, we donâ€™t want cosmetic changes to the GUI to have an impact on our business rules. We donâ€™t want the addition or modification of reports to have an impact on our highest-level policies. Consequently, the component dependency graph is created and molded by architects to protect stable high-value components from volatile components.</p><blockquote><p>ç»„ä»¶ç»“æ„å›¾ä¸­çš„ä¸€ä¸ªé‡è¦ç›®æ ‡æ˜¯æŒ‡å¯¼å¦‚ä½•éš”ç¦»é¢‘ç¹çš„å˜æ›´ã€‚æˆ‘ä»¬ä¸å¸Œæœ›é‚£äº›é¢‘ç¹å˜æ›´çš„ç»„ä»¶å½±å“åˆ°å…¶ä»–æœ¬æ¥åº”è¯¥å¾ˆç¨³å®šçš„ç»„ä»¶ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šå¸Œæœ›æ— å…³ç´§è¦çš„ GUI å˜æ›´å½±å“åˆ°ä¸šåŠ¡é€»è¾‘ç»„ä»¶ï¼›æˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›å¯¹æŠ¥è¡¨çš„å¢åˆ æ“ä½œå½±å“åˆ°å…¶é«˜é˜¶ç­–ç•¥ã€‚å‡ºäºè¿™æ ·çš„è€ƒè™‘ï¼Œè½¯ä»¶æ¶æ„å¸ˆä»¬æ‰æœ‰å¿…è¦è®¾è®¡å¹¶ä¸”é“¸é€ å‡ºä¸€å¥—ç»„ä»¶ä¾èµ–å…³ç³»å›¾æ¥ï¼Œä»¥ä¾¿å°†ç¨³å®šçš„é«˜ä»·å€¼ç»„ä»¶ä¸å¸¸å˜çš„ç»„ä»¶éš”ç¦»å¼€ï¼Œä»è€Œèµ·åˆ°ä¿æŠ¤ä½œç”¨ã€‚</p></blockquote><p>As the application continues to grow, we start to become concerned about creating reusable elements. At this point, the CRP begins to influence the composition of the components. Finally, as cycles appear, the ADP is applied and the component dependency graph jitters and grows.</p><blockquote><p>å¦å¤–ï¼Œéšç€åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œåˆ›å»ºå¯é‡ç”¨ç»„ä»¶çš„éœ€è¦ä¹Ÿä¼šé€æ¸é‡è¦èµ·æ¥ã€‚è¿™æ—¶ CRP åˆä¼šå¼€å§‹å½±å“ç»„ä»¶çš„ç»„æˆã€‚æœ€åå½“å¾ªç¯ä¾èµ–å‡ºç°æ—¶ï¼Œéšç€æ— å¾ªç¯ä¾èµ–åŸåˆ™ï¼ˆADPï¼‰çš„åº”ç”¨ï¼Œç»„ä»¶ä¾èµ–å…³ç³»ä¼šäº§ç”Ÿç›¸åº”çš„æŠ–åŠ¨å’Œæ‰©å¼ ã€‚</p></blockquote><p>If we tried to design the component dependency structure before we designed any classes, we would likely fail rather badly. We would not know much about common closure, we would be unaware of any reusable elements, and we would almost certainly create components that produced dependency cycles. Thus the component dependency structure grows and evolves with the logical design of the system.</p><blockquote><p>å¦‚æœæˆ‘ä»¬åœ¨è®¾è®¡å…·ä½“ç±»ä¹‹å‰å°±æ¥è®¾è®¡ç»„ä»¶ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆå‡ ä¹æ˜¯å¿…ç„¶è¦å¤±è´¥çš„ã€‚å› ä¸ºåœ¨å½“ä¸‹ï¼Œæˆ‘ä»¬å¯¹é¡¹ç›®ä¸­çš„å…±åŒé—­åŒ…ä¸€æ— æ‰€çŸ¥ï¼Œä¹Ÿä¸å¯èƒ½çŸ¥é“å“ªäº›ç»„ä»¶å¯ä»¥å¤ç”¨ï¼Œè¿™æ ·å‡ ä¹ä¸€å®šä¼šåˆ›é€ å‡ºå¾ªç¯ä¾èµ–çš„ç»„ä»¶ã€‚å› æ­¤ï¼Œç»„ä»¶ä¾èµ–å…³ç³»æ˜¯å¿…é¡»è¦éšç€é¡¹ç›®çš„é€»è¾‘è®¾è®¡ä¸€èµ·æ‰©å¼ å’Œæ¼”è¿›çš„ã€‚</p></blockquote><h2 id="the-stable-dependencies-principle-ç¨³å®šä¾èµ–åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#the-stable-dependencies-principle-ç¨³å®šä¾èµ–åŸåˆ™" aria-hidden="true">#</a> THE STABLE DEPENDENCIES PRINCIPLE ç¨³å®šä¾èµ–åŸåˆ™</h2><p>Depend in the direction of stability.</p><blockquote><p>ä¾èµ–å…³ç³»å¿…é¡»è¦æŒ‡å‘æ›´ç¨³å®šçš„æ–¹å‘ã€‚</p></blockquote><p>Designs cannot be completely static. Some volatility is necessary if the design is to be maintained. By conforming to the Common Closure Principle (CCP), we create components that are sensitive to certain kinds of changes but immune to others. Some of these components are designed to be volatile. We expect them to change.</p><blockquote><p>è®¾è®¡è¿™ä»¶äº‹ä¸å¯èƒ½æ˜¯å®Œå…¨é™æ­¢çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è®©ä¸€ä¸ªè®¾è®¡æ˜¯å¯ç»´æŠ¤çš„ï¼Œé‚£ä¹ˆå…¶ä¸­æŸäº›éƒ¨åˆ†å°±å¿…é¡»æ˜¯å¯å˜çš„ã€‚é€šè¿‡éµå®ˆå…±åŒé—­åŒ…åŸåˆ™ï¼ˆCCPï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ å‡ºå¯¹æŸäº›å˜æ›´æ•æ„Ÿï¼Œå¯¹å…¶ä»–å˜æ›´ä¸æ•æ„Ÿçš„ç»„ä»¶ã€‚è¿™å…¶ä¸­çš„ä¸€äº›ç»„ä»¶åœ¨è®¾è®¡ä¸Šå°±å·²ç»æ˜¯è€ƒè™‘äº†æ˜“å˜æ€§ï¼Œé¢„æœŸå®ƒä»¬ä¼šç»å¸¸å‘ç”Ÿå˜æ›´çš„ã€‚</p></blockquote><p>Any component that we expect to be volatile should not be depended on by a component that is difficult to change. Otherwise, the volatile component will also be difficult to change.</p><blockquote><p>ä»»ä½•ä¸€ä¸ªæˆ‘ä»¬é¢„æœŸä¼šç»å¸¸å˜æ›´çš„ç»„ä»¶éƒ½ä¸åº”è¯¥è¢«ä¸€ä¸ªéš¾äºä¿®æ”¹çš„ç»„ä»¶æ‰€ä¾èµ–ï¼Œå¦åˆ™è¿™ä¸ªå¤šå˜çš„ç»„ä»¶ä¹Ÿå°†ä¼šå˜å¾—éå¸¸éš¾ä»¥è¢«ä¿®æ”¹ã€‚</p></blockquote><p>It is the perversity of software that a module that you have designed to be easy to change can be made difficult to change by someone else who simply hangs a dependency on it. Not a line of source code in your module need change, yet your module will suddenly become more challenging to change. By conforming to the Stable Dependencies Principle (SDP), we ensure that modules that are intended to be easy to change are not depended on by modules that are harder to change.</p><blockquote><p>è¿™å°±æ˜¯è½¯ä»¶å¼€å‘çš„å›°éš¾ä¹‹å¤„ï¼Œæˆ‘ä»¬ç²¾å¿ƒè®¾è®¡çš„ä¸€ä¸ªå®¹æ˜“è¢«ä¿®æ”¹çš„ç»„ä»¶å¾ˆå¯èƒ½ä¼šç”±äºåˆ«äººçš„ä¸€æ¡ç®€å•ä¾èµ–è€Œå˜å¾—éå¸¸éš¾ä»¥è¢«ä¿®æ”¹ã€‚å³ä½¿è¯¥æ¨¡å—ä¸­æ²¡æœ‰ä¸€è¡Œä»£ç éœ€è¦è¢«ä¿®æ”¹ï¼Œä½†æ˜¯æ•´ä¸ªæ¨¡å—åœ¨è¢«ä¿®æ”¹æ—¶æ‰€é¢ä¸´çš„æŒ‘æˆ˜æ€§ä¹Ÿå·²ç»å­˜åœ¨äº†ã€‚è€Œé€šè¿‡éµå®ˆç¨³å®šä¾èµ–åŸåˆ™ï¼ˆSDPï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¡®ä¿è‡ªå·±è®¾è®¡ä¸­é‚£äº›å®¹æ˜“å˜æ›´çš„æ¨¡å—ä¸ä¼šè¢«é‚£äº›éš¾äºä¿®æ”¹çš„ç»„ä»¶æ‰€ä¾èµ–ã€‚</p></blockquote><h3 id="stability-ç¨³å®šæ€§" tabindex="-1"><a class="header-anchor" href="#stability-ç¨³å®šæ€§" aria-hidden="true">#</a> STABILITY ç¨³å®šæ€§</h3><p>What is meant by â€œstabilityâ€? Stand a penny on its side. Is it stable in that position? You would likely say â€œno.â€ However, unless disturbed, it will remain in that position for a very long time. Thus stability has nothing directly to do with frequency of change. The penny is not changing, but it is difficult to think of it as stable.</p><blockquote><p>æˆ‘ä»¬è¯¥å¦‚ä½•å®šä¹‰â€œç¨³å®šæ€§â€å‘¢ï¼Ÿè­¬å¦‚è¯´å°†ä¸€ä¸ªç¡¬å¸ç«‹èµ·æ¥æ”¾ï¼Œä½ è®¤ä¸ºå®ƒä¼šå¤„äºä¸€ä¸ªç¨³å®šçš„ä½ç½®å—ï¼Ÿå½“ç„¶ä¸ä¼šã€‚ç„¶è€Œï¼Œé™¤éå—åˆ°å¤–ç•Œå› ç´ å¹²æ‰°ï¼Œå¦åˆ™ç¡¬å¸æœ¬èº«å¯ä»¥åœ¨è¿™ä¸ªä½ç½®ä¿æŒç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´ã€‚å› æ­¤ç¨³å®šæ€§åº”è¯¥ä¸å˜æ›´çš„é¢‘ç¹åº¦æ²¡æœ‰ç›´æ¥å…³ç³»ä½†é—®é¢˜æ˜¯ç¡¬å¸å¹¶æ²¡æœ‰å€’ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å´å¹¶ä¸è®¤ä¸ºå®ƒæ˜¯ç¨³å®šçš„å‘¢?</p></blockquote><p>Websterâ€™s Dictionary says that something is stable if it is â€œnot easily moved.â€ Stability is related to the amount of work required to make a change. On the one hand, the standing penny is not stable because it requires very little work to topple it. On the other hand, a table is very stable because it takes a considerable amount of effort to turn it over.</p><blockquote><p>ä¸‹é¢æ¥çœ‹çœ‹ Webster åœ¨çº¿å­—å…¸ä¸­çš„æè¿°ï¼šç¨³å®šæŒ‡çš„æ˜¯â€œå¾ˆéš¾ç§»åŠ¨â€ã€‚æ‰€ä»¥ç¨³å®šæ€§åº”è¯¥ä¸å˜æ›´æ‰€éœ€çš„å·¥ä½œé‡æœ‰å…³ã€‚ä¾‹å¦‚ï¼Œç¡¬å¸æ˜¯ä¸ç¨³å®šçš„ï¼Œå› ä¸ºåªéœ€è¦å¾ˆå°çš„åŠ¨ä½œå°±å¯ä»¥æ¨å€’å®ƒï¼Œè€Œæ¡Œå­åˆ™æ˜¯éå¸¸ç¨³å®šçš„ï¼Œå› ä¸ºå°†å®ƒæ€ç¿»éœ€è¦å¾ˆå¤§çš„åŠ¨ä½œã€‚</p></blockquote><p>How does this relate to software? Many factors may make a software component hard to changeâ€”for example, its size, complexity, and clarity, among other characteristics. We will ignore all those factors and focus on something different here. One sure way to make a software component difficult to change, is to make lots of other software components depend on it. A component with lots of incoming dependencies is very stable because it requires a great deal of work to reconcile any changes with all the dependent components.</p><blockquote><p>ä½†å¦‚æœå°†è¿™å¥—ç†è®ºå…³è”åˆ°è½¯ä»¶å¼€å‘çš„é—®é¢˜ä¸Šå‘¢ï¼Ÿè½¯ä»¶ç»„ä»¶çš„å˜æ›´å›°éš¾åº¦ä¸å¾ˆå¤šå› ç´ æœ‰å…³ï¼Œä¾‹å¦‚ä»£ç çš„ä½“é‡å¤§å°ã€å¤æ‚åº¦ã€æ¸…æ™°åº¦ç­‰ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä¼šå¿½ç•¥è¿™äº›å› ç´ ï¼Œåªé›†ä¸­è®¨è®ºä¸€ä¸ªç‰¹åˆ«çš„å› ç´ â€”â€”è®©è½¯ä»¶ç»„ä»¶éš¾äºä¿®æ”¹çš„ä¸€ä¸ªæœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯è®©å¾ˆå¤šå…¶ä»–ç»„ä»¶ä¾èµ–äºå®ƒã€‚å¸¦æœ‰è®¸å¤šå…¥å‘ä¾èµ–å…³ç³»çš„ç»„ä»¶æ˜¯éå¸¸ç¨³å®šçš„ï¼Œå› ä¸ºå®ƒçš„ä»»ä½•å˜æ›´éƒ½éœ€è¦åº”ç”¨åˆ°æ‰€æœ‰ä¾èµ–å®ƒçš„ç»„ä»¶ä¸Šã€‚</p></blockquote><p>The diagram in Figure 14.5 shows X, which is a stable component. Three components depend on X, so it has three good reasons not to change. We say that X is responsible to those three components. Conversely, X depends on nothing, so it has no external influence to make it change. We say it is independent.</p><blockquote><p>åœ¨å›¾ 14.5 ä¸­ï¼ŒX æ˜¯ä¸€ä¸ªç¨³å®šçš„ç»„ä»¶ã€‚å› ä¸ºæœ‰ä¸‰ä¸ªç»„ä»¶ä¾èµ–ç€ Xï¼Œæ‰€ä»¥ X æœ‰ä¸‰ä¸ªä¸åº”è¯¥è¢«ä¿®æ”¹çš„åŸå› ã€‚è¿™é‡Œå°±è¯´ X è¦å¯¹ä¸‰ä¸ªç»„ä»¶è´Ÿè´£ã€‚å¦ä¸€æ–¹é¢ï¼ŒX ä¸ä¾èµ–äºä»»ä½•ç»„ä»¶ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ä»»ä½•åŸå› å¯¼è‡´å®ƒéœ€è¦è¢«å˜æ›´ï¼Œæˆ‘ä»¬ç§°å®ƒä¸ºâ€œç‹¬ç«‹â€ç»„ä»¶ã€‚</p></blockquote><!----><p>Figure 14.6 shows Y, which is a very unstable component. No other components depend on Y, so we say that it is irresponsible. Y also has three components that it depends on, so changes may come from three external sources. We say that Y is dependent.</p><blockquote><p>ä¸‹é¢å†æ¥çœ‹çœ‹å›¾ 14.6 ä¸­çš„ Y ç»„ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¸ç¨³å®šçš„ç»„ä»¶ã€‚ç”±äºæ²¡æœ‰å…¶ä»–çš„ç»„ä»¶ä¾èµ– Yï¼Œæ‰€ä»¥ Y å¹¶ä¸å¯¹ä»»ä½•ç»„ä»¶è´Ÿè´£ã€‚ä½†å› ä¸º Y åŒæ—¶ä¾èµ–äºä¸‰ä¸ªç»„ä»¶ï¼Œæ‰€ä»¥å®ƒçš„å˜æ›´å°±å¯èƒ½ç”±ä¸‰ä¸ªä¸åŒçš„æºäº§ç”Ÿã€‚è¿™é‡Œå°±è¯´ Y æ˜¯æœ‰ä¾èµ–æ€§çš„ç»„ä»¶ã€‚</p></blockquote><!----><h3 id="stability-metrics-ç¨³å®šæ€§æŒ‡æ ‡" tabindex="-1"><a class="header-anchor" href="#stability-metrics-ç¨³å®šæ€§æŒ‡æ ‡" aria-hidden="true">#</a> STABILITY METRICS ç¨³å®šæ€§æŒ‡æ ‡</h3><p>How can we measure the stability of a component? One way is to count the number of dependencies that enter and leave that component. These counts will allow us to calculate the positional stability of the component.</p><blockquote><p>é‚£ä¹ˆï¼Œç©¶ç«Ÿè¯¥å¦‚ä½•æ¥é‡åŒ–ä¸€ä¸ªç»„ä»¶çš„ç¨³å®šæ€§å‘¢ï¼Ÿå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯è®¡ç®—æ‰€æœ‰å…¥å’Œå‡ºçš„ä¾èµ–å…³ç³»ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªç»„ä»¶çš„ä½ç½®ç¨³å®šæ€§ï¼ˆpositional stabilityï¼‰ã€‚</p></blockquote><ul><li>Fan-in: Incoming dependencies. This metric identifies the number of classes outside this component that depend on classes within the component.</li><li>Fan-out: Outgoing dependencies. This metric identifies the number of classes inside this component that depend on classes outside the component.</li><li>I: Instability: I = Fan-out / (Fan-in + Fan-out). This metric has the range [0, 1]. I = 0 indicates a maximally stable component. I = 1 indicates a maximally unstable component.</li></ul><hr><blockquote><ul><li>Fan-inï¼šå…¥å‘ä¾èµ–ï¼Œè¿™ä¸ªæŒ‡æ ‡æŒ‡ä»£äº†ç»„ä»¶å¤–éƒ¨ç±»ä¾èµ–äºç»„ä»¶å†…éƒ¨ç±»çš„æ•°é‡ã€‚</li><li>Fan-outï¼šå‡ºå‘ä¾èµ–ï¼Œè¿™ä¸ªæŒ‡æ ‡æŒ‡ä»£äº†ç»„ä»¶å†…éƒ¨ç±»ä¾èµ–äºç»„ä»¶å¤–éƒ¨ç±»çš„æ•°é‡ã€‚</li><li>Iï¼šä¸ç¨³å®šæ€§ï¼Œ<code>I=Fan-out/(Fan-in+Fan-out)</code>.è¯¥æŒ‡æ ‡çš„èŒƒå›´æ˜¯[0,1]ï¼ŒI=0 æ„å‘³ç€ç»„ä»¶æ˜¯æœ€ç¨³å®šçš„ï¼ŒI=1 æ„å‘³ç€ç»„ä»¶æ˜¯æœ€ä¸ç¨³å®šçš„ã€‚</li></ul></blockquote><p>The Fan-in and Fan-out metrics1 are calculated by counting the number of classes outside the component in question that have dependencies with the classes inside the component in question. Consider the example in Figure 14.7.</p><blockquote><p>åœ¨è¿™é‡Œï¼ŒFan-in å’Œ Fan-out è¿™ä¸¤ä¸ªæŒ‡æ ‡æ˜¯é€šè¿‡ç»Ÿè®¡å’Œç»„ä»¶å†…éƒ¨ç±»æœ‰ä¾èµ–çš„ç»„ä»¶å¤–éƒ¨ç±»çš„æ•°é‡æ¥è®¡ç®—çš„ï¼Œå…·ä½“å¦‚å›¾ 14.7 æ‰€ç¤ºã€‚</p></blockquote><!----><p>Letâ€™s say we want to calculate the stability of the component Cc. We find that there are three classes outside Cc that depend on classes in Cc. Thus, Fan-in = 3. Moreover, there is one class outside Cc that classes in Cc depend on. Thus, Fan-out = 1 and I = 1/4.</p><blockquote><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æƒ³è¦è®¡ç®—ç»„ä»¶ Cc çš„ç¨³å®šæ€§æŒ‡æ ‡ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æœ‰ 3 ä¸ªç±»åœ¨ Cc å¤–éƒ¨ï¼Œå®ƒä»¬éƒ½ä¾èµ–äº Cc å†…éƒ¨çš„ç±»ï¼Œå› æ­¤ Fan-in=3ï¼Œæ­¤å¤–ï¼ŒCc ä¸­çš„ä¸€ä¸ªç±»ä¹Ÿä¾èµ–äºç»„ä»¶å¤–éƒ¨çš„ç±»ï¼Œå› æ­¤ Fan-out=1ï¼ŒI=1/4ã€‚</p></blockquote><p>In C++, these dependencies are typically represented by #include statements. Indeed, the I metric is easiest to calculate when you have organized your source code such that there is one class in each source file. In Java, the I metric can be calculated by counting import statements and qualified names.</p><blockquote><p>åœ¨ C++ä¸­ï¼Œè¿™äº›ä¾èµ–å…³ç³»ä¸€èˆ¬æ˜¯é€šè¿‡ <code>#include</code> è¯­å¥æ¥è¡¨è¾¾çš„ã€‚äº‹å®ä¸Šï¼Œå½“æ¯ä¸ªæºæ–‡ä»¶åªåŒ…å«ä¸€ä¸ªç±»çš„æ—¶å€™ï¼ŒI æŒ‡æ ‡æ˜¯æœ€å®¹æ˜“è®¡ç®—çš„ã€‚åŒæ ·åœ¨ Java ä¸­ï¼ŒI æŒ‡æ ‡ä¹Ÿå¯ä»¥é€šè¿‡ import è¯­å¥å’Œå…¨å¼•ç”¨åå­—çš„æ•°é‡æ¥è®¡ç®—ã€‚</p></blockquote><p>When the I metric is equal to 1, it means that no other component depends on this component (Fan-in = 0), and this component depends on other components (Fan-out &gt; 0). This situation is as unstable as a component can get; it is irresponsible and dependent. Its lack of dependents gives the component no reason not to change, and the components that it depends on may give it ample reason to change.</p><blockquote><p>å½“ I æŒ‡æ ‡ç­‰äº 1 æ—¶ï¼Œè¯´æ˜æ²¡æœ‰ç»„ä»¶ä¾èµ–å½“å‰ç»„ä»¶ï¼ˆFan-in=0ï¼‰ï¼ŒåŒæ—¶è¯¥ç»„ä»¶å´ä¾èµ–äºå…¶ä»–ç»„ä»¶ï¼ˆFan-out&gt;0ï¼‰ã€‚è¿™æ˜¯ç»„ä»¶æœ€ä¸ç¨³å®šçš„ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ç§ç»„ä»¶æ˜¯â€œä¸è´Ÿè´£çš„ï¼ˆirresponsibleï¼‰ã€å¯¹å¤–ä¾èµ–çš„ï¼ˆdependentï¼‰â€ã€‚ç”±äºè¿™ä¸ªç»„ä»¶æ²¡æœ‰è¢«å…¶ä»–ç»„ä»¶ä¾èµ–ï¼Œæ‰€ä»¥è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰åŠ›é‡ä¼šå¹²é¢„å®ƒçš„å˜æ›´ï¼ŒåŒæ—¶ä¹Ÿå› ä¸ºè¯¥ç»„ä»¶ä¾èµ–äºå…¶ä»–ç»„ä»¶ï¼Œæ‰€ä»¥å°±å¿…ç„¶ä¼šç»å¸¸éœ€è¦å˜æ›´ã€‚</p></blockquote><p>In contrast, when the I metric is equal to 0, it means that the component is depended on by other components (Fan-in &gt; 0), but does not itself depend on any other components (Fan-out = 0). Such a component is responsible and independent. It is as stable as it can get. Its dependents make it hard to change the component, and its has no dependencies that might force it to change.</p><blockquote><p>ç›¸åï¼Œå½“ 1=0 çš„æ—¶å€™ï¼Œè¯´æ˜å½“å‰ç»„ä»¶æ˜¯å…¶ä»–ç»„ä»¶æ‰€ä¾èµ–çš„ç›®æ ‡(Fan-in&gt;0)ï¼ŒåŒæ—¶å…¶è‡ªèº«å¹¶ä¸ä¾èµ–ä»»ä½•å…¶ä»–ç»„ä»¶ï¼ˆFan-out=0ï¼‰ã€‚æˆ‘ä»¬é€šå¸¸è®¤ä¸ºè¿™æ ·çš„ç»„ä»¶æ˜¯â€œè´Ÿè´£çš„ï¼ˆresponsibileï¼‰ã€ä¸å¯¹å¤–ä¾èµ–çš„ï¼ˆindependentï¼‰â€ã€‚è¿™æ˜¯ç»„ä»¶æœ€å…·ç¨³å®šæ€§çš„ä¸€ç§æƒ…å†µï¼Œå…¶ä»–ç»„ä»¶å¯¹å®ƒçš„ä¾èµ–å…³ç³»ä¼šå¯¼è‡´è¿™ä¸ªç»„ä»¶å¾ˆéš¾è¢«å˜æ›´ï¼ŒåŒæ—¶ç”±äºå®ƒæ²¡æœ‰å¯¹å¤–ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰æ¥è‡ªå¤–éƒ¨çš„å˜æ›´ç†ç”±ã€‚</p></blockquote><p>The SDP says that the I metric of a component should be larger than the I metrics of the components that it depends on. That is, I metrics should decrease in the direction of dependency.</p><blockquote><p>ç¨³å®šä¾èµ–åŸåˆ™ï¼ˆSDPï¼‰çš„è¦æ±‚æ˜¯è®©æ¯ä¸ªç»„ä»¶çš„/æŒ‡æ ‡éƒ½å¿…é¡»å¤§äºå…¶æ‰€ä¾èµ–ç»„ä»¶çš„ I æŒ‡æ ‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç»„ä»¶ç»“æ„ä¾èµ–å›¾ä¸­å„ç»„ä»¶çš„/æŒ‡æ ‡å¿…é¡»è¦æŒ‰å…¶ä¾èµ–å…³ç³»æ–¹å‘é€’å‡ã€‚</p></blockquote><h3 id="not-all-components-should-be-stable-å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„" tabindex="-1"><a class="header-anchor" href="#not-all-components-should-be-stable-å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„" aria-hidden="true">#</a> NOT ALL COMPONENTS SHOULD BE STABLE å¹¶ä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½åº”è¯¥æ˜¯ç¨³å®šçš„</h3><p>If all the components in a system were maximally stable, the system would be unchangeable. This is not a desirable situation. Indeed, we want to design our component structure so that some components are unstable and some are stable. The diagram in Figure 14.8 shows an ideal configuration for a system with three components.</p><blockquote><p>å¦‚æœä¸€ä¸ªç³»ç»Ÿä¸­çš„æ‰€æœ‰ç»„ä»¶éƒ½å¤„äºæœ€é«˜ç¨³å®šæ€§çŠ¶æ€ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¸€å®šæ— æ³•å†è¿›è¡Œå˜æ›´äº†ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬è®¾è®¡ç»„ä»¶æ¶æ„å›¾çš„ç›®çš„å°±æ˜¯è¦å†³å®šåº”è¯¥è®©å“ªäº›ç»„ä»¶ç¨³å®šï¼Œè®©å“ªäº›ç»„ä»¶ä¸ç¨³å®šã€‚è­¬å¦‚åœ¨å›¾ 14.8 ä¸­ï¼Œæˆ‘ä»¬æ‰€ç¤ºèŒƒçš„å°±æ˜¯ä¸€ä¸ªå…·æœ‰ä¸‰ä¸ªç»„ä»¶çš„ç³»ç»Ÿçš„ç†æƒ³é…ç½®ã€‚</p></blockquote><p>The changeable components are on top and depend on the stable component at the bottom. Putting the unstable components at the top of the diagram is a useful convention because any arrow that points up is violating the SDP (and, as we shall see later, the ADP).</p><blockquote><p>åœ¨è¯¥ç³»ç»Ÿç»„ä»¶ç»“æ„å›¾ä¸­ï¼Œå¯å˜æ›´çš„ç»„ä»¶ä½äºé¡¶å±‚ï¼ŒåŒæ—¶ä¾èµ–äºåº•å±‚çš„ç¨³å®šç»„ä»¶ã€‚å°†ä¸ç¨³å®šç»„ä»¶æ”¾åœ¨è¯¥ç»“æ„å›¾çš„é¡¶å±‚æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾å‡ºç®­å¤´å‘ä¸Šçš„ä¾èµ–å…³ç³»ï¼Œè€Œè¿™äº›å…³ç³»æ˜¯è¿å SDPï¼ˆä»¥åŠåé¢å°†ä¼šè®¨è®ºçš„ ADPï¼‰çš„ã€‚</p></blockquote><!----><p>The diagram in Figure 14.9 shows how the SDP can be violated.</p><blockquote><p>ä¸‹é¢å†é€šè¿‡å›¾ 14.9 æ¥çœ‹çœ‹è¿å SDP çš„æƒ…å†µï¼š</p></blockquote><!----><p>Flexible is a component that we have designed to be easy to change. We want Flexible to be unstable. However, some developer, working in the component named Stable, has hung a dependency on Flexible. This violates the SDP because the I metric for Stable is much smaller than the I metric for Flexible. As a result, Flexible will no longer be easy to change. A change to Flexible will force us to deal with Stable and all its dependents.</p><blockquote><p>åœ¨å›¾ 14.9 ä¸­ï¼ŒFlexible æ˜¯åœ¨è®¾è®¡ä¸­è¦ç¡®ä¿å…¶æ˜“äºå˜æ›´çš„ç»„ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ä¼šå¸Œæœ› Flexible æ˜¯ä¸ç¨³å®šçš„ã€‚ç„¶è€Œï¼ŒStable ç»„ä»¶çš„å¼€å‘äººå‘˜å´å¼•å…¥äº†å¯¹ Flexible ç»„ä»¶çš„ä¾èµ–ã€‚è¿™ç§æƒ…å†µå°±è¿åäº† SDPï¼Œå› ä¸º Stable ç»„ä»¶çš„ I æŒ‡æ ‡è¦è¿œå°äº Flexible çš„ I æŒ‡æ ‡ã€‚è¿™å°†å¯¼è‡´ Flexible ç»„ä»¶çš„å˜æ›´éš¾åº¦å¤§å¤§å¢åŠ ï¼Œå› ä¸ºå¯¹ Flexible ç»„ä»¶çš„ä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»è¦è€ƒè™‘ Stable ç»„ä»¶åŠè¯¥ç»„ä»¶è‡ªèº«å­˜åœ¨çš„ä¾èµ–å…³ç³»ã€‚</p></blockquote><p>To fix this problem, we somehow have to break the dependence of Stable on Flexible. Why does this dependency exist? Letâ€™s assume that there is a class C within Flexible that another class U within Stable needs to use (Figure 14.10).</p><blockquote><p>å¦‚æœæƒ³è¦ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå°±å¿…é¡»è¦å°† stable ä¸ Flexible è¿™ä¸¤ä¸ªç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»æ‰“ç ´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°±éœ€è¦äº†è§£è¿™ä¸ªä¾èµ–å…³ç³»åˆ°åº•ä¸ºä»€ä¹ˆä¼šå­˜åœ¨ï¼Œè¿™é‡Œå‡è®¾æ˜¯å› ä¸º Stable ç»„ä»¶ä¸­çš„æŸä¸ªç±» U éœ€è¦ä½¿ç”¨ Flexible ç»„ä»¶ä¸­çš„ä¸€ä¸ªç±» Cï¼Œå¦‚å›¾ 14.10 æ‰€ç¤ºï¼š</p></blockquote><!----><p>We can fix this by employing the DIP. We create an interface class called US and put it in a component named UServer. We make sure that this interface declares all the methods that U needs to use. We then make C implement this interface as shown in Figure 14.11. This breaks the dependency of Stable on Flexible, and forces both components to depend on UServer. UServer is very stable (I = 0), and Flexible retains its necessary instability (I = 1). All the dependencies now flow in the direction of decreasing I.</p><blockquote><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ DIP æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚å…·ä½“æ¥è¯´å°±æ˜¯åˆ›é€ ä¸€ä¸ª UServer ç»„ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­è®¾ç½®ä¸€ä¸ª US æ¥å£ç±»ã€‚ç„¶åï¼Œç¡®ä¿è¿™ä¸ªæ¥å£ç±»ä¸­åŒ…å«äº†æ‰€æœ‰ U éœ€è¦ä½¿ç”¨çš„å‡½æ•°ï¼Œå†è®© C å®ç°è¿™ä¸ªæ¥å£ï¼Œå¦‚å›¾ 14.11 æ‰€ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å°†ä» Stable åˆ° Flexible çš„è¿™æ¡ä¾èµ–å…³ç³»æ‰“ç ´äº†ï¼Œå¼ºè¿«è¿™ä¸¤ä¸ªç»„ä»¶éƒ½ä¾èµ–äº UServerã€‚ç°åœ¨ï¼ŒUServer ç»„ä»¶ä¼šæ˜¯éå¸¸ç¨³å®šçš„ï¼ˆI=0ï¼‰ï¼Œè€Œ Flexibile ç»„ä»¶åˆ™ä¼šä¾ç„¶ä¿æŒä¸ç¨³å®šçš„çŠ¶æ€ï¼ˆI=1ï¼‰ï¼Œç»“æ„å›¾ä¸­æ‰€æœ‰çš„ä¾èµ–å…³ç³»éƒ½æµå‘ I é€’å‡çš„æ–¹å‘äº†ã€‚</p></blockquote><!----><h3 id="abstract-components-æŠ½è±¡ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#abstract-components-æŠ½è±¡ç»„ä»¶" aria-hidden="true">#</a> Abstract Components æŠ½è±¡ç»„ä»¶</h3><p>You may find it strange that we would create a componentâ€”in this example, UServiceâ€”that contains nothing but an interface. Such a component contains no executable code! It turns out, however, that this is a very common, and necessary, tactic when using statically typed languages like Java and C#. These abstract components are very stable and, therefore, are ideal targets for less stable components to depend on.</p><blockquote><p>è¯»è€…å¯èƒ½ä¼šè§‰å¾—åˆ›é€ æ–°ç»„ä»¶ï¼ˆè­¬å¦‚ä¸Šè¿°ä¾‹å­ä¸­çš„ UService ç»„ä»¶ï¼Œå®ƒå…¶å®åªåŒ…å«äº†ä¸€ä¸ªæ¥å£ç±»ï¼‰è¿™ç§åšæ³•æŒºå¥‡æ€ªçš„ã€‚å› ä¸ºè¿™æ ·çš„ç»„ä»¶ä¸­å‡ ä¹ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼ä½†äº‹å®ä¸Šï¼Œè¿™ç§åšæ³•åœ¨ C# æˆ–è€… Java è¿™ç§é™æ€ç±»å‹è¯­è¨€ä¸­æ˜¯éå¸¸æ™®éçš„ï¼Œè€Œä¸”ä¹Ÿå¿…é¡»è¿™æ ·åšã€‚å› ä¸ºè¿™äº›æŠ½è±¡ç»„ä»¶é€šå¸¸ä¼šéå¸¸ç¨³å®šï¼Œå¯ä»¥è¢«é‚£äº›ç›¸å¯¹ä¸ç¨³å®šçš„ç»„ä»¶ä¾èµ–ã€‚</p></blockquote><p>When using dynamically typed languages like Ruby and Python, these abstract components donâ€™t exist at all, nor do the dependencies that would have targeted them. Dependency structures in these languages are much simpler because dependency inversion does not require either the declaration or the inheritance of interfaces.</p><blockquote><p>è€Œå½“æˆ‘ä»¬ä½¿ç”¨ Ruby å’Œ Python è¿™ç§åŠ¨æ€ç±»å‹è¯­è¨€æ—¶ï¼Œè¿™äº›æŠ½è±¡æ¥å£äº‹å®ä¸Šå¹¶ä¸å­˜åœ¨ï¼Œå› æ­¤ä¹Ÿå°±æ²¡æœ‰å¯¹å®ƒä»¬çš„ä¾èµ–ã€‚åŠ¨æ€ç±»å‹è¯­è¨€ä¸­çš„ä¾èµ–å…³ç³»æ˜¯éå¸¸ç®€å•çš„ï¼Œå› ä¸ºå…¶ä¾èµ–åè½¬çš„è¿‡ç¨‹å¹¶ä¸éœ€è¦å£°æ˜å’Œç»§æ‰¿æ¥å£ã€‚</p></blockquote><h2 id="the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™" aria-hidden="true">#</a> THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™</h2><p>A component should be as abstract as it is stable.</p><blockquote><p>ä¸€ä¸ªç»„ä»¶çš„æŠ½è±¡åŒ–ç¨‹åº¦åº”è¯¥ä¸å…¶ç¨³å®šæ€§ä¿æŒä¸€è‡´ã€‚</p></blockquote><h3 id="where-do-we-put-the-high-level-policy-é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ" tabindex="-1"><a class="header-anchor" href="#where-do-we-put-the-high-level-policy-é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ" aria-hidden="true">#</a> WHERE DO WE PUT THE HIGH-LEVEL POLICY? é«˜é˜¶ç­–ç•¥åº”è¯¥æ”¾åœ¨å“ªé‡Œ</h3><p>Some software in the system should not change very often. This software represents high-level architecture and policy decisions. We donâ€™t want these business and architectural decisions to be volatile. Thus the software that encapsulates the high-level policies of the system should be placed into stable components (I = 0). Unstable components (I = 1) should contain only the software that is volatileâ€”software that we want to be able to quickly and easily change.</p><blockquote><p>åœ¨ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæ€»æœ‰äº›éƒ¨åˆ†æ˜¯ä¸åº”è¯¥ç»å¸¸å‘ç”Ÿå˜æ›´çš„ã€‚è¿™äº›éƒ¨åˆ†é€šå¸¸ç”¨äºè¡¨ç°è¯¥ç³»ç»Ÿçš„é«˜é˜¶æ¶æ„è®¾è®¡åŠä¸€äº›ç­–ç•¥ç›¸å…³çš„é«˜é˜¶å†³ç­–ã€‚æˆ‘ä»¬ä¸æƒ³è®©è¿™äº›ä¸šåŠ¡å†³ç­–å’Œæ¶æ„è®¾è®¡ç»å¸¸å‘ç”Ÿå˜æ›´ï¼Œå› æ­¤è¿™äº›ä»£è¡¨äº†ç³»ç»Ÿå’¼é˜¶ç­–ç•¥çš„ç»„ä»¶åº”è¯¥è¢«æ”¾åˆ°ç¨³å®šç»„ä»¶ï¼ˆI=0ï¼‰ä¸­ï¼Œè€Œä¸ç¨³å®šçš„ç»„ä»¶ï¼ˆI=1ï¼‰ä¸­åº”è¯¥åªåŒ…å«é‚£äº›æˆ‘ä»¬æƒ³è¦å¿«é€Ÿå’Œæ–¹ä¾¿ä¿®æ”¹çš„éƒ¨åˆ†ã€‚</p></blockquote><p>However, if the high-level policies are placed into stable components, then the source code that represents those policies will be difficult to change. This could make the overall architecture inflexible. How can a component that is maximally stable (I = 0) be flexible enough to withstand change? The answer is found in the OCP. This principle tells us that it is possible and desirable to create classes that are flexible enough to be extended without requiring modification. Which kind of classes conform to this principle? Abstract classes.</p><blockquote><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬å°†é«˜é˜¶ç­–ç•¥æ”¾å…¥ç¨³å®šç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆç”¨äºæè¿°é‚£äº›ç­–ç•¥çš„æºä»£ç å°±å¾ˆéš¾è¢«ä¿®æ”¹äº†ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„æ¶æ„è®¾è®¡éš¾äºè¢«ä¿®æ”¹ã€‚å¦‚ä½•æ‰èƒ½è®©ä¸€ä¸ªæ— é™ç¨³å®šçš„ç»„ä»¶ï¼ˆI=0ï¼‰æ¥å—å˜æ›´å‘¢ï¼Ÿå¼€é—­åŸåˆ™ï¼ˆOCPï¼‰ä¸ºæˆ‘ä»¬æä¾›äº†ç­”æ¡ˆã€‚è¿™ä¸ªåŸåˆ™å‘Šè¯‰æˆ‘ä»¬ï¼šåˆ›é€ ä¸€ä¸ªè¶³å¤Ÿçµæ´»ã€èƒ½å¤Ÿè¢«æ‰©å±•ï¼Œè€Œä¸”ä¸éœ€è¦ä¿®æ”¹çš„ç±»æ˜¯å¯èƒ½çš„ï¼Œè€Œè¿™æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚å“ªä¸€ç§ç±»ç¬¦åˆè¿™ä¸ªåŸåˆ™å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æŠ½è±¡ç±»ã€‚</p></blockquote><h3 id="introducing-the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#introducing-the-stable-abstractions-principle-ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹" aria-hidden="true">#</a> INTRODUCING THE STABLE ABSTRACTIONS PRINCIPLE ç¨³å®šæŠ½è±¡åŸåˆ™ç®€ä»‹</h3><p>The Stable Abstractions Principle (SAP) sets up a relationship between stability and abstractness. On the one hand, it says that a stable component should also be abstract so that its stability does not prevent it from being extended. On the other hand, it says that an unstable component should be concrete since its instability allows the concrete code within it to be easily changed.</p><blockquote><p>ç¨³å®šæŠ½è±¡åŸåˆ™ï¼ˆSAPï¼‰ä¸ºç»„ä»¶çš„ç¨³å®šæ€§ä¸å®ƒçš„æŠ½è±¡åŒ–ç¨‹åº¦å»ºç«‹äº†ä¸€ç§å…³è”ã€‚ä¸€æ–¹é¢ï¼Œè¯¥åŸåˆ™è¦æ±‚ç¨³å®šçš„ç»„ä»¶åŒæ—¶åº”è¯¥æ˜¯æŠ½è±¡çš„ï¼Œè¿™æ ·å®ƒçš„ç¨³å®šæ€§å°±ä¸ä¼šå½±å“åˆ°æ‰©å±•æ€§ã€‚å¦ä¸€æ–¹é¢ï¼Œè¯¥åŸåˆ™ä¹Ÿè¦æ±‚ä¸€ä¸ªä¸ç¨³å®šçš„ç»„ä»¶åº”è¯¥åŒ…å«å…·ä½“çš„å®ç°ä»£ç ï¼Œè¿™æ ·å®ƒçš„ç¨³å®šæ€§å°±å¯ä»¥é€šè¿‡å…·ä½“çš„ä»£ç è¢«è½»æ˜“ä¿®æ”¹ã€‚</p></blockquote><p>Thus, if a component is to be stable, it should consist of interfaces and abstract classes so that it can be extended. Stable components that are extensible are flexible and do not overly constrain the architecture.</p><blockquote><p>å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶æƒ³è¦æˆä¸ºç¨³å®šç»„ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±åº”è¯¥ç”±æ¥å£å’ŒæŠ½è±¡ç±»ç»„æˆï¼Œä»¥ä¾¿å°†æ¥åšæ‰©å±•ã€‚å¦‚æ­¤ï¼Œè¿™äº›æ—¢ç¨³å®šåˆä¾¿äºæ‰©å±•çš„ç»„ä»¶å¯ä»¥è¢«ç»„åˆæˆæ—¢çµæ´»åˆä¸ä¼šå—åˆ°è¿‡åº¦é™åˆ¶çš„æ¶æ„ã€‚</p></blockquote><p>The SAP and the SDP combined amount to the DIP for components. This is true because the SDP says that dependencies should run in the direction of stability, and the SAP says that stability implies abstraction. Thus dependencies run in the direction of abstraction.</p><blockquote><p>å°† SAP ä¸ SDP è¿™ä¸¤ä¸ªåŸåˆ™ç»“åˆèµ·æ¥ï¼Œå°±ç­‰äºç»„ä»¶å±‚æ¬¡ä¸Šçš„ DIPã€‚å› ä¸º SDP è¦æ±‚çš„æ˜¯è®©ä¾èµ–å…³ç³»æŒ‡å‘æ›´ç¨³å®šçš„æ–¹å‘ï¼Œè€Œ SAP åˆ™å‘Šè¯‰æˆ‘ä»¬ç¨³å®šæ€§æœ¬èº«å°±éšå«äº†å¯¹æŠ½è±¡åŒ–çš„è¦æ±‚ï¼Œå³ä¾èµ–å…³ç³»åº”è¯¥æŒ‡å‘æ›´æŠ½è±¡çš„æ–¹å‘ã€‚</p></blockquote><p>The DIP, however, is a principle that deals with classesâ€”and with classes there are no shades of gray. Either a class is abstract or it is not. The combination of the SDP and the SAP deals with components, and allows that a component can be partially abstract and partially stable.</p><blockquote><p>ç„¶è€Œï¼ŒDIP æ¯•ç«Ÿæ˜¯ä¸ç±»è¿™ä¸ªå±‚æ¬¡æœ‰å…³çš„åŸåˆ™â€”â€”å¯¹ç±»æ¥è¯´ï¼Œè®¾è®¡æ˜¯æ²¡æœ‰ç°è‰²åœ°å¸¦çš„ã€‚ä¸€ä¸ªç±»è¦ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Œè¦ä¹ˆå°±ä¸æ˜¯ã€‚SDP ä¸ SAP è¿™å¯¹åŸåˆ™æ˜¯åº”ç”¨åœ¨ç»„ä»¶å±‚é¢ä¸Šçš„ï¼Œæˆ‘ä»¬è¦å…è®¸ä¸€ä¸ªç»„ä»¶éƒ¨åˆ†æŠ½è±¡ï¼Œéƒ¨åˆ†ç¨³å®šã€‚</p></blockquote><h3 id="measuring-abstraction-è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦" tabindex="-1"><a class="header-anchor" href="#measuring-abstraction-è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦" aria-hidden="true">#</a> MEASURING ABSTRACTION è¡¡é‡æŠ½è±¡åŒ–ç¨‹åº¦</h3><p>The A metric is a measure of the abstractness of a component. Its value is simply the ratio of interfaces and abstract classes in a component to the total number of classes in the component.</p><blockquote><p>ä¸‹é¢ï¼Œå‡è®¾ A æŒ‡æ ‡æ˜¯å¯¹ç»„ä»¶æŠ½è±¡åŒ–ç¨‹åº¦çš„ä¸€ä¸ªè¡¡é‡ï¼Œå®ƒçš„å€¼æ˜¯ç»„ä»¶ä¸­æŠ½è±¡ç±»ä¸æ¥å£æ‰€å çš„æ¯”ä¾‹ã€‚é‚£ä¹ˆï¼š</p></blockquote><ul><li>Nc: The number of classes in the component.</li><li>Na: The number of abstract classes and interfaces in the component.</li><li>A: Abstractness. A = Na Ã· Nc.</li></ul><hr><blockquote><ul><li>Ncï¼šç»„ä»¶ä¸­ç±»çš„æ•°é‡ã€‚</li><li>Naï¼šç»„ä»¶ä¸­æŠ½è±¡ç±»å’Œæ¥å£çš„æ•°é‡ã€‚</li><li>Aï¼šæŠ½è±¡ç¨‹åº¦ï¼ŒA=Na/Ncã€‚</li></ul></blockquote><p>The A metric ranges from 0 to 1. A value of 0 implies that the component has no abstract classes at all. A value of 1 implies that the component contains nothing but abstract classes.</p><blockquote><p>A æŒ‡æ ‡çš„å–å€¼èŒƒå›´æ˜¯ä» 0 åˆ° 1ï¼Œå€¼ä¸º 0 ä»£è¡¨ç»„ä»¶ä¸­æ²¡æœ‰ä»»ä½•æŠ½è±¡ç±»ï¼Œå€¼ä¸º 1 å°±æ„å‘³ç€ç»„ä»¶ä¸­åªæœ‰æŠ½è±¡ç±»ã€‚</p></blockquote><h3 id="the-main-sequence-ä¸»åºåˆ—" tabindex="-1"><a class="header-anchor" href="#the-main-sequence-ä¸»åºåˆ—" aria-hidden="true">#</a> THE MAIN SEQUENCE ä¸»åºåˆ—</h3><p>We are now in a position to define the relationship between stability (I) and abstractness (A). To do so, we create a graph with A on the vertical axis and I on the horizontal axis (Figure 14.12). If we plot the two â€œgoodâ€ kinds of components on this graph, we will find the components that are maximally stable and abstract at the upper left at (0, 1). The components that are maximally unstable and concrete are at the lower right at (1, 0).</p><blockquote><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å®šä¹‰ç»„ä»¶çš„ç¨³å®šæ€§ I ä¸å…¶æŠ½è±¡åŒ–ç¨‹åº¦ A ä¹‹é—´çš„å…³ç³»äº†ï¼Œå…·ä½“å¦‚å›¾ 14.12 æ‰€ç¤ºã€‚åœ¨è¯¥å›¾ä¸­ï¼Œçºµè½´ä¸º A å€¼ï¼Œæ¨ªè½´ä¸º I å€¼ã€‚å¦‚æœæˆ‘ä»¬å°†ä¸¤ä¸ªâ€œè®¾è®¡è‰¯å¥½â€çš„ç»„ä»¶ç»˜åˆ¶åœ¨è¯¥å›¾ä¸Šï¼Œé‚£ä¹ˆæœ€ç¨³å®šçš„ã€åŒ…å«äº†æ— é™æŠ½è±¡ç±»çš„ç»„ä»¶åº”è¯¥ä½äºå·¦ä¸Šè§’(0,1)ï¼Œæœ€ä¸ç¨³å®šçš„ã€æœ€å…·ä½“çš„ç»„ä»¶åº”è¯¥ä½äºå³ä¸‹è§’(1,0)ã€‚</p></blockquote><!----><p>Not all components fall into one of these two positions, because components often have degrees of abstraction and stability. For example, it is very common for one abstract class to derive from another abstract class. The derivative is an abstraction that has a dependency. Thus, though it is maximally abstract, it will not be maximally stable. Its dependency will decrease its stability.</p><blockquote><p>å½“ç„¶ï¼Œä¸å¯èƒ½æ‰€æœ‰çš„ç»„ä»¶éƒ½èƒ½å¤„äºè¿™ä¸¤ä¸ªä½ç½®ä¸Šï¼Œå› ä¸ºç»„ä»¶é€šå¸¸éƒ½æœ‰å„è‡ªçš„ç¨³å®šç¨‹åº¦å’ŒæŠ½è±¡åŒ–ç¨‹åº¦ã€‚ä¾‹å¦‚ä¸€ä¸ªæŠ½è±¡ç±»æœ‰æ—¶ä¼šè¡ç”Ÿäºå¦ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¿™ç§æƒ…å†µæ˜¯å¾ˆå¸¸è§çš„ï¼Œè€Œè¿™ä¸ªè¡ç”Ÿè¿‡ç¨‹å°±æ„å‘³ç€æŸç§ä¾èµ–å…³ç³»çš„äº§ç”Ÿã€‚å› æ­¤ï¼Œè™½ç„¶è¯¥ç»„ä»¶æ˜¯å…¨æŠ½è±¡çš„ï¼Œä½†å®ƒå¹¶ä¸æ˜¯å®Œå…¨ç¨³å®šçš„ï¼Œä¸Šè¿°ä¾èµ–å…³ç³»é™ä½äº†å®ƒçš„ç¨³å®šç¨‹åº¦ã€‚</p></blockquote><p>Since we cannot enforce a rule that all components sit at either (0, 1) or (1, 0), we must assume that there is a locus of points on the A/I graph that defines reasonable positions for components. We can infer what that locus is by finding the areas where components should not beâ€”in other words, by determining the zones of exclusion (Figure 14.13).</p><blockquote><p>æ—¢ç„¶ä¸èƒ½å¼ºåˆ¶è¦æ±‚æ‰€æœ‰çš„ç»„ä»¶éƒ½å¤„äº(0,1)å’Œ(1,0)è¿™ä¸¤ä¸ªä½ç½®ä¸Šï¼Œé‚£ä¹ˆå°±å¿…é¡»å‡è®¾ A/I å›¾ä¸Šå­˜åœ¨ç€ä¸€ä¸ªåˆç†ç»„ä»¶çš„åŒºé—´ã€‚è€Œè¿™ä¸ªåŒºé—´åº”è¯¥å¯ä»¥é€šè¿‡æ’é™¤æ³•æ¨å¯¼å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ‰¾å‡ºé‚£äº›ç»„ä»¶ä¸åº”è¯¥å¤„äºçš„ä½ç½®ï¼ˆè¯·å‚è€ƒå›¾ 14.13ï¼‰ï¼š</p></blockquote><!----><h3 id="the-zone-of-pain-ç—›è‹¦åŒº" tabindex="-1"><a class="header-anchor" href="#the-zone-of-pain-ç—›è‹¦åŒº" aria-hidden="true">#</a> The Zone of Pain ç—›è‹¦åŒº</h3><p>Consider a component in the area of (0, 0). This is a highly stable and concrete component. Such a component is not desirable because it is rigid. It cannot be extended because it is not abstract, and it is very difficult to change because of its stability. Thus we do not normally expect to see well-designed components sitting near (0, 0). The area around (0, 0) is a zone of exclusion called the Zone of Pain.</p><blockquote><p>åœ¨å›¾ 14.13 ä¸­ï¼Œå‡è®¾æŸä¸ªç»„ä»¶å¤„äº(0,0)ä½ç½®ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªéå¸¸ç¨³å®šä½†ä¹Ÿéå¸¸å…·ä½“çš„ç»„ä»¶ã€‚è¿™æ ·çš„ç»„ä»¶åœ¨è®¾è®¡ä¸Šæ˜¯ä¸ä½³çš„ï¼Œå› ä¸ºå®ƒå¾ˆéš¾è¢«ä¿®æ”¹ï¼Œè¿™æ„å‘³ç€è¯¥ç»„ä»¶ä¸èƒ½è¢«æ‰©å±•ã€‚è¿™æ ·ä¸€æ¥ï¼Œå› ä¸ºè¿™ä¸ªç»„ä»¶ä¸æ˜¯æŠ½è±¡çš„ï¼Œè€Œä¸”å®ƒåˆç”±äºç¨³å®šæ€§çš„åŸå› å˜å¾—ç‰¹åˆ«éš¾ä»¥è¢«ä¿®æ”¹ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ç»„ä»¶è´´è¿‘è¿™ä¸ªåŒºåŸŸï¼Œå› æ­¤(0,0)å‘¨å›´çš„è¿™ä¸ªåŒºåŸŸè¢«æˆ‘ä»¬ç§°ä¸ºç—›è‹¦åŒºï¼ˆzone of painï¼‰ã€‚</p></blockquote><p>Some software entities do, in fact, fall within the Zone of Pain. An example would be a database schema. Database schemas are notoriously volatile, extremely concrete, and highly depended on. This is one reason why the interface between OO applications and databases is so difficult to manage, and why schema updates are generally painful.</p><blockquote><p>å½“ç„¶ï¼Œæœ‰äº›è½¯ä»¶ç»„ä»¶ç¡®å®ä¼šå¤„äºè¿™ä¸ªåŒºåŸŸä¸­ï¼Œè¿™æ–¹é¢çš„ä¸€ä¸ªå…¸å‹æ¡ˆä¾‹å°±æ˜¯æ•°æ®åº“çš„è¡¨ç»“æ„ï¼ˆschemaï¼‰ã€‚å®ƒåœ¨å¯å˜æ€§ä¸Šå¯è°“è‡­åæ˜­è‘—ï¼Œä½†æ˜¯å®ƒåŒæ—¶åˆéå¸¸å…·ä½“ï¼Œå¹¶è¢«éå¸¸å¤šçš„ç»„ä»¶ä¾èµ–ã€‚è¿™å°±æ˜¯é¢å‘å¯¹è±¡åº”ç”¨ç¨‹åºä¸æ•°æ®åº“ä¹‹é—´çš„æ¥å£è¿™ä¹ˆéš¾ä»¥ç®¡ç†ï¼Œä»¥åŠæ¯æ¬¡æ›´æ–°æ•°æ®åº“çš„è¿‡ç¨‹éƒ½é‚£ä¹ˆç—›è‹¦çš„åŸå› ã€‚</p></blockquote><p>Another example of software that sits near the area of (0, 0) is a concrete utility library. Although such a library has an I metric of 1, it may actually be nonvolatile. Consider the String component, for example. Even though all the classes within it are concrete, it is so commonly used that changing it would create chaos. Therefore String is nonvolatile.</p><blockquote><p>å¦ä¸€ä¸ªä¼šå¤„äºè¿™ä¸ªåŒºåŸŸçš„å…¸å‹è½¯ä»¶ç»„ä»¶æ˜¯å·¥å…·å‹ç±»åº“ã€‚è™½ç„¶è¿™ç§ç±»åº“çš„ I æŒ‡æ ‡ä¸º 1ï¼Œä½†äº‹å®ä¸Šé€šå¸¸æ˜¯ä¸å¯å˜çš„ã€‚ä¾‹å¦‚ String ç»„ä»¶ï¼Œè™½ç„¶å…¶ä¸­æ‰€æœ‰çš„ç±»éƒ½æ˜¯å…·ä½“çš„ï¼Œä½†ç”±äºå®ƒè¢«ä½¿ç”¨å¾—å¤ªè¿‡æ™®éï¼Œä»»ä½•ä¿®æ”¹éƒ½ä¼šé€ æˆå¤§èŒƒå›´çš„æ··ä¹±ï¼Œå› æ­¤ String ç»„ä»¶åªèƒ½æ˜¯ä¸å¯å˜çš„ã€‚</p></blockquote><p>Nonvolatile components are harmless in the (0, 0) zone since they are not likely to be changed. For that reason, it is only volatile software components that are problematic in the Zone of Pain. The more volatile a component in the Zone of Pain, the more â€œpainfulâ€ it is. Indeed, we might consider volatility to be a third axis of the graph. With this understanding, Figure 14.13 shows only the most painful plane, where volatility = 1.</p><blockquote><p>ä¸å¯å˜ç»„ä»¶è½åœ¨(0,0)è¿™ä¸€åŒºåŸŸä¸­æ˜¯æ— å®³çš„ï¼Œå› ä¸ºå®ƒä»¬ä¸å¤ªå¯èƒ½ä¼šå‘ç”Ÿå˜æ›´ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œåªæœ‰å¤šå˜çš„è½¯ä»¶ç»„ä»¶è½åœ¨ç—›è‹¦åŒºä¸­æ‰ä¼šé€ æˆéº»çƒ¦ï¼Œè€Œä¸”ç»„ä»¶çš„å¤šå˜æ€§è¶Šå¼ºï¼Œé€ æˆçš„éº»çƒ¦å°±ä¼šè¶Šå¤§ã€‚å…¶å®ï¼Œæˆ‘ä»¬åº”è¯¥å°†å¤šå˜æ€§ä½œä¸ºå›¾ 14.13 çš„ç¬¬ä¸‰ä¸ªè½´ï¼Œè¿™æ—¶å›¾ 14.13 æ‰€å±•ç¤ºçš„ä¾¿æ˜¯å¤šå˜æ€§=1 æ—¶çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯æœ€ç—›è‹¦çš„åˆ‡é¢ã€‚</p></blockquote><h3 id="the-zone-of-uselessness-æ— ç”¨åŒº" tabindex="-1"><a class="header-anchor" href="#the-zone-of-uselessness-æ— ç”¨åŒº" aria-hidden="true">#</a> The Zone of Uselessness æ— ç”¨åŒº</h3><p>Consider a component near (1, 1). This location is undesirable because it is maximally abstract, yet has no dependents. Such components are useless. Thus this area is called the Zone of Uselessness.</p><blockquote><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹é è¿‘(1,1)è¿™ä¸€ä½ç½®ç‚¹çš„ç»„ä»¶ã€‚è¯¥ä½ç½®ä¸Šçš„ç»„ä»¶ä¸ä¼šæ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºè¿™äº›ç»„ä»¶é€šå¸¸æ˜¯æ— é™æŠ½è±¡çš„ï¼Œä½†æ˜¯æ²¡æœ‰è¢«å…¶ä»–ç»„ä»¶ä¾èµ–ï¼Œè¿™æ ·çš„ç»„ä»¶å¾€å¾€æ— æ³•ä½¿ç”¨ã€‚å› æ­¤æˆ‘ä»¬å°†è¿™ä¸ªåŒºåŸŸç§°ä¸ºæ— ç”¨åŒºã€‚</p></blockquote><p>The software entities that inhabit this region are a kind of detritus. They are often leftover abstract classes that no one ever implemented. We find them in systems from time to time, sitting in the code base, unused.</p><blockquote><p>å¯¹äºè¿™ä¸ªåŒºåŸŸä¸­çš„è½¯ä»¶ç»„ä»¶æ¥è¯´ï¼Œå…¶æºç æˆ–è€…ç±»ä¸­çš„è®¾è®¡é—®é¢˜é€šå¸¸æ˜¯ç”±äºå†å²åŸå› é€ æˆçš„ã€‚ä¾‹å¦‚æˆ‘ä»¬å¸¸å¸¸ä¼šåœ¨ç³»ç»Ÿçš„æŸä¸ªè§’è½é‡Œçœ‹åˆ°æŸä¸ªæ²¡æœ‰äººå®ç°çš„æŠ½è±¡ç±»ï¼Œå®ƒä»¬ä¸€ç›´é™é™åœ°èººåœ¨é‚£é‡Œï¼Œæ²¡æœ‰äººä½¿ç”¨ã€‚</p></blockquote><p>A component that has a position deep within the Zone of Uselessness must contain a significant fraction of such entities. Clearly, the presence of such useless entities is undesirable.</p><blockquote><p>åŒæ ·çš„ï¼Œè½åœ¨æ— ç”¨åŒºä¸­çš„ç»„ä»¶ä¹Ÿä¸€å®šä¼šåŒ…å«å¤§é‡çš„æ— ç”¨ä»£ç ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ç±»ç»„ä»¶ä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p></blockquote><h3 id="avoiding-the-zones-of-exclusion-é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ" tabindex="-1"><a class="header-anchor" href="#avoiding-the-zones-of-exclusion-é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ" aria-hidden="true">#</a> AVOIDING THE ZONES OF EXCLUSION é¿å¼€è¿™ä¸¤ä¸ªåŒºåŸŸ</h3><p>It seems clear that our most volatile components should be kept as far from both zones of exclusion as possible. The locus of points that are maximally distant from each zone is the line that connects (1, 0) and (0, 1). I call this line the Main Sequence.2</p><blockquote><p>å¾ˆæ˜æ˜¾ï¼Œæœ€å¤šå˜çš„ç»„ä»¶åº”è¯¥ç¦»ä¸Šè¿°ä¸¤ä¸ªåŒºåŸŸè¶Šè¿œè¶Šå¥½ã€‚åœ¨å›¾ 14.13 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è·ç¦»ä¸¤ä¸ªåŒºåŸŸæœ€è¿œçš„ç‚¹è¿æˆä¸€æ¡çº¿ï¼Œå³ä»(1,0)è¿æ¥åˆ°(0,1)ã€‚æˆ‘å°†è¿™æ¡çº¿ç§°ä¸ºä¸»åºåˆ—çº¿ï¼ˆmain sequenceï¼‰ã€‚</p></blockquote><p>A component that sits on the Main Sequence is not â€œtoo abstractâ€ for its stability, nor is it â€œtoo unstableâ€ for its abstractness. It is neither useless nor particularly painful. It is depended on to the extent that it is abstract, and it depends on others to the extent that it is concrete.</p><blockquote><p>åè½äºä¸»åºåˆ—çº¿ä¸Šçš„ç»„ä»¶ä¸ä¼šä¸ºäº†è¿½æ±‚ç¨³å®šæ€§è€Œè¢«è®¾è®¡å¾—â€œå¤ªè¿‡æŠ½è±¡â€ï¼Œä¹Ÿä¸ä¼šä¸ºäº†é¿å…æŠ½è±¡åŒ–è€Œè¢«è®¾è®¡å¾—â€œå¤ªè¿‡ä¸ç¨³å®šâ€ã€‚è¿™æ ·çš„ç»„ä»¶æ—¢ä¸ä¼šç‰¹åˆ«éš¾ä»¥è¢«ä¿®æ”¹ï¼Œåˆå¯ä»¥å®ç°è¶³å¤Ÿçš„åŠŸèƒ½ã€‚å¯¹äºè¿™äº›ç»„ä»¶æ¥è¯´ï¼Œé€šå¸¸ä¼šæœ‰è¶³å¤Ÿå¤šçš„ç»„ä»¶ä¾èµ–äºå®ƒä»¬ï¼Œè¿™ä½¿å¾—å®ƒä»¬ä¼šå…·æœ‰ä¸€å®šç¨‹åº¦çš„æŠ½è±¡ï¼ŒåŒæ—¶å®ƒä»¬ä¹Ÿä¾èµ–äº†è¶³å¤Ÿå¤šçš„å…¶ä»–ç»„ä»¶ï¼Œè¿™åˆä½¿å¾—å®ƒä¸€å®šä¼šåŒ…å«å¾ˆå¤šå…·ä½“å®ç°ã€‚</p></blockquote><p>The most desirable position for a component is at one of the two endpoints of the Main Sequence. Good architects strive to position the majority of their components at those endpoints. However, in my experience, some small fraction of the components in a large system are neither perfectly abstract nor perfectly stable. Those components have the best characteristics if they are on, or close, to the Main Sequence.</p><blockquote><p>åœ¨è¿™æ¡ä¸»åºåˆ—çº¿ä¸Šï¼Œç»„ä»¶æ‰€èƒ½å¤„äºæœ€ä¼˜çš„ä½ç½®æ˜¯çº¿çš„ä¸¤ç«¯ã€‚ä¸€ä¸ªä¼˜ç§€çš„è½¯ä»¶æ¶æ„å¸ˆåº”è¯¥äº‰å–å°†è‡ªå·±è®¾è®¡çš„å¤§éƒ¨åˆ†ç»„ä»¶å°½å¯èƒ½åœ°æ¨å‘è¿™ä¸¤ä¸ªä½ç½®ã€‚ç„¶è€Œï¼Œä»¥æˆ‘çš„ä¸ªäººç»éªŒæ¥è¯´ï¼Œå¤§å‹ç³»ç»Ÿä¸­çš„ç»„ä»¶ä¸å¯èƒ½åšåˆ°å®Œå…¨æŠ½è±¡ï¼Œä¹Ÿä¸å¯èƒ½åšåˆ°å®Œå…¨ç¨³å®šã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦è¿½æ±‚è®©è¿™äº›ç»„ä»¶ä½äºä¸»åºåˆ—çº¿ä¸Šï¼Œæˆ–è€…è´´è¿‘è¿™æ¡çº¿å³å¯ã€‚</p></blockquote><h3 id="distance-from-the-main-sequence-ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»" tabindex="-1"><a class="header-anchor" href="#distance-from-the-main-sequence-ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»" aria-hidden="true">#</a> DISTANCE FROM THE MAIN SEQUENCE ç¦»ä¸»åºåˆ—çº¿çš„è·ç¦»</h3><p>This leads us to our last metric. If it is desirable for components to be on, or close, to the Main Sequence, then we can create a metric that measures how far away a component is from this ideal.</p><blockquote><p>æ¥ä¸‹æ¥ä»‹ç»æœ€åä¸€ä¸ªæŒ‡æ ‡ï¼šå¦‚æœè®©ç»„ä»¶ä½äºæˆ–è€…é è¿‘ä¸»åºåˆ—æ˜¯å¯å–çš„ç›®æ ‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡æ ‡æ¥è¡¡é‡ä¸€ä¸ªç»„ä»¶è·ç¦»æœ€ä½³ä½ç½®çš„è·ç¦»ã€‚</p></blockquote><ul><li>D3: Distance. D = |A+Iâ€“1| . The range of this metric is [0, 1]. A value of 0 indicates that the component is directly on the Main Sequence. A value of 1 indicates that the component is as far away as possible from the Main Sequence.</li></ul><blockquote><ul><li>D æŒ‡æ ‡ï¼šè·ç¦» <code>D=|A+I-1|</code>ï¼Œè¯¥æŒ‡æ ‡çš„å–å€¼èŒƒå›´æ˜¯[0,1]ã€‚å€¼ä¸º 0 æ„å‘³ç€ç»„ä»¶æ˜¯ç›´æ¥ä½äºä¸»åºåˆ—çº¿ä¸Šçš„ï¼Œå€¼ä¸º 1 åˆ™æ„å‘³ç€ç»„ä»¶åœ¨è·ç¦»ä¸»åºåˆ—æœ€è¿œçš„ä½ç½®ã€‚</li></ul></blockquote><p>Given this metric, a design can be analyzed for its overall conformance to the Main Sequence. The D metric for each component can be calculated. Any component that has a D value that is not near zero can be reexamined and restructured.</p><blockquote><p>é€šè¿‡è®¡ç®—æ¯ä¸ªç»„ä»¶çš„ D æŒ‡æ ‡ï¼Œå°±å¯ä»¥é‡åŒ–ä¸€ä¸ªç³»ç»Ÿè®¾è®¡ä¸ä¸»åºåˆ—çš„å¥‘åˆç¨‹åº¦äº†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ D æŒ‡æ ‡å¤§äº 0 å¤šå°‘æ¥æŒ‡å¯¼ç»„ä»¶çš„é‡æ„ä¸é‡æ–°è®¾è®¡ã€‚</p></blockquote><p>Statistical analysis of a design is also possible. We can calculate the mean and variance of all the D metrics for the components within a design. We would expect a conforming design to have a mean and variance that are close to zero. The variance can be used to establish â€œcontrol limitsâ€ so as to identify components that are â€œexceptionalâ€ in comparison to all the others.</p><blockquote><p>é™¤æ­¤ä¹‹å¤–ï¼Œé€šè¿‡è®¡ç®—è®¾è®¡ä¸­æ‰€æœ‰ç»„ä»¶çš„ D æŒ‡æ ‡çš„å¹³å‡å€¼å’Œæ–¹å·®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ç»Ÿè®¡å­¦çš„æ–¹æ³•æ¥é‡åŒ–åˆ†æä¸€ä¸ªç³»ç»Ÿè®¾è®¡ã€‚å¯¹äºä¸€ä¸ªè‰¯å¥½çš„ç³»ç»Ÿè®¾è®¡æ¥è¯´ï¼ŒD æŒ‡æ ‡çš„å¹³å‡å€¼å’Œæ–¹å·®éƒ½åº”è¯¥æ¥è¿‘äº 0ã€‚å…¶ä¸­ï¼Œæ–¹å·®è¿˜å¯ä»¥è¢«å½“ä½œç»„ä»¶çš„â€œè¾¾æ ‡çº¢çº¿â€æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ‰¾å‡ºç³»ç»Ÿè®¾è®¡ä¸­é‚£äº›ä¸åˆå¸¸è§„çš„ç»„ä»¶ã€‚</p></blockquote><p>In the scatterplot in Figure 14.14, we see that the bulk of the components lie along the Main Sequence, but some of them are more than one standard deviation (Z = 1) away from the mean. These aberrant components are worth examining more closely. For some reason, they are either very abstract with few dependents or very concrete with many dependents.</p><blockquote><p>åœ¨å›¾ 14.14 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†çš„ç»„ä»¶éƒ½ä½äºä¸»åºåˆ—é™„è¿‘ï¼Œä½†æ˜¯æœ‰äº›ç»„ä»¶å¤„äºå¹³å‡å€¼çš„æ ‡å‡†å·®ï¼ˆZ=1ï¼‰ä»¥å¤–ã€‚è¿™äº›ç»„ä»¶å€¼å¾—è¢«é‡ç‚¹åˆ†æï¼Œå®ƒä»¬è¦ä¹ˆè¿‡äºæŠ½è±¡ä¾èµ–ä¸è¶³ï¼Œè¦ä¹ˆè¿‡äºå…·ä½“è€Œè¢«ä¾èµ–å¾—å¤ªå¤šã€‚</p></blockquote><!----><p>Another way to use the metrics is to plot the D metric of each component over time. The graph in Figure 14.15 is a mock-up of such a plot. You can see that some strange dependencies have been creeping into the Payroll component over the last few releases. The plot shows a control threshold at D = 0.1. The R2.1 point has exceeded this control limit, so it would be worth our while to find out why this component is so far from the main sequence.</p><blockquote><p>D æŒ‡æ ‡çš„å¦å¤–ä¸€ç§ç”¨æ³•æ˜¯æŒ‰æ—¶é—´æ¥è·Ÿè¸ªæ¯ä¸ªç»„ä»¶çš„å€¼ï¼Œä¸‹é¢ç”¨å›¾ 14.15 æ¥åšä¸€ä¸ªç¤ºèŒƒã€‚åœ¨è¯¥å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒPayroll ç»„ä»¶åœ¨æœ€è¿‘å‡ æ¬¡å‘å¸ƒä¸­ç´¯ç§¯äº†ä¸€äº›æ„å¤–çš„å¯¹å¤–ä¾èµ–ã€‚å›¾ä¸­çš„ Q=0.1 æ˜¯ç»„ä»¶çš„è¾¾æ ‡çº¢çº¿ï¼ŒR2.1 è¿™ä¸ªå€¼å·²ç»è¶…å‡ºäº†çº¢çº¿èŒƒå›´ï¼Œè¿™å°±å‘Šè¯‰æˆ‘ä»¬ç°åœ¨å€¼å¾—èŠ±ä¸€äº›ç²¾åŠ›æ¥æ‰¾å‡ºè¿™ä¸ªç»„ä»¶åç¦»ä¸»åºåˆ—çº¿çš„åŸå› äº†ã€‚</p></blockquote><!----><h2 id="conclusion-æœ¬ç« å°ç»“" tabindex="-1"><a class="header-anchor" href="#conclusion-æœ¬ç« å°ç»“" aria-hidden="true">#</a> CONCLUSION æœ¬ç« å°ç»“</h2><p>The dependency management metrics described in this chapter measure the conformance of a design to a pattern of dependency and abstraction that I think is a â€œgoodâ€ pattern. Experience has shown that certain dependencies are good and others are bad. This pattern reflects that experience. However, a metric is not a god; it is merely a measurement against an arbitrary standard. These metrics are imperfect, at best, but it is my hope that you find them useful.</p><blockquote><p>æœ¬ç« ä»‹ç»äº†å„ç§å¯ç”¨äºä¾èµ–å…³ç³»ç®¡ç†çš„æŒ‡æ ‡ï¼Œå®ƒä»¬å¯ä»¥è¢«ç”¨æ¥é‡ŒåŒ–åˆ†ææŸä¸ªç³»ç»Ÿè®¾è®¡ä¸â€œä¼˜ç§€â€è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å¥‘åˆåº¦ã€‚æ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œç»„ä»¶ä¹‹é—´æœ‰äº›ä¾èµ–å…³ç³»æ˜¯å¥½çš„ï¼Œæœ‰äº›ä¾èµ–å…³ç³»åˆ™æ˜¯ä¸å¥½çš„ï¼Œè¿™äº›ç»éªŒæœ€åéƒ½ä¼šä½“ç°åœ¨è¿™ä¸ªè®¾è®¡æ¨¡å¼ä¸­ã€‚å½“ç„¶ï¼ŒæŒ‡æ ‡å¹¶ä¸ç­‰åŒäºçœŸç†ï¼Œå®ƒåªæ˜¯å¯¹æˆ‘ä»¬æ‰€å®šä¹‰æ ‡å‡†çš„ä¸€ä¸ªè¡¡é‡ã€‚è¿™äº›æŒ‡æ ‡è‚¯å®šæ˜¯ä¸å®Œç¾çš„ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›å®ƒä»¬å¯¹è¯»è€…æœ‰ä»·å€¼ã€‚</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/windily-cloud/obsidian-publish/edit/main/Publish/Publish/Clean Archtechture/ch14.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/9/20 11:11:04</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: wwww.4399li@qq.com">windilycloud</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch13.html" class="nav-link prev" aria-label="ch13.md"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-file"></span>ch13.md</div></a><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch15.html" class="nav-link next" aria-label="ch15.md"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">ch15.md<span class="icon iconfont icon-file"></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">ä»€ä¹ˆæ˜¯å¹¸è¤”ï¼Ÿ å¹¸ç¦å°±æ˜¯çŒ«åƒé±¼ç‹—åƒè‚‰ï¼Œå¥¥ç‰¹æ›¼æ‰“å°æ€ªå…½ï¼</div><div class="copyright">Copyright Â© 2022 Windily-Cloud</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/obsidian-publish/assets/app.887b133c.js" defer></script>
  </body>
</html>
