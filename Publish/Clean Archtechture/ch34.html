<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://windily-cloud.github.io/obsidian-publish/Publish/Clean%20Archtechture/ch34.html"><meta property="og:site_name" content="Windily Cloud"><meta property="og:title" content="Chap34. THE MISSING CHAPTER æ‹¾é—"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-09-20T11:11:04.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-09-20T11:11:04.000Z"><title>Chap34. THE MISSING CHAPTER æ‹¾é— | Windily Cloud</title><meta name="description" content="Windily Cloud's Blog">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/obsidian-publish/assets/style.12da8f21.css">
    <link rel="modulepreload" href="/obsidian-publish/assets/app.887b133c.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch34.html.c7a5cd99.js"><link rel="modulepreload" href="/obsidian-publish/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch34.html.61d3f411.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c7e76e53.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.f01af163.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.d24325cb.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.fc3247cd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.279a3dae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.ad67b7a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.74f49c94.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.7b8b868f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.0897d88d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.871f1a29.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.9cf7c1a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.1ee0e012.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.b2dc5528.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.d50b6029.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.f9083031.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.a8daed86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.f712f0c4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.008de7bb.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.bc3946ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.dcd080ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.4bd6fad0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.5af7f550.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.cdcf732e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.d56c6b1b.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.1d0c5f03.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.a9585c5e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.7898d2ef.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.4e106aa0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.efd82950.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.054b22ad.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.25d75f30.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.058b06f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.a6691c1e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.326ac1a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.b00c3f6a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.4e35799e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.f553bf58.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.1abe47e0.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.61a30e56.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.c688cf00.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.19a54833.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e97d623d.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.59f213ed.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.565d8d69.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.8c97282e.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.7a0981ad.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.609d0549.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.0ce08377.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.cc115e5e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.60ae3ce2.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c09081fd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.70634028.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.3b70efd7.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.f5a6049f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.d91b9c1f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.32852561.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0a68a710.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.93b7cca5.js"><link rel="prefetch" href="/obsidian-publish/assets/å¯¼èˆª.html.a1c9d7de.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0da27cdd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.b850d04a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.5aa5f6f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.413c371f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.3cd7a242.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.175ce04d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.fc4a1701.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.199a9f38.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.5b8799e9.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.20b93b21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.165fc3da.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.4cd429e5.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.3e2d64e7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.384a9648.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.b1ad3804.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.58811bd6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.44e934ae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.d77e680e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.79a8927d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch25.html.a6d9e7e0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.c53b41bf.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.fdbedd86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.8d17578d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.69ad75a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.ef8bfaee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.d5d16d0e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.33b5c44c.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.6c12ea21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.7adbcd24.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.f4b07606.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.0f2533d2.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.c64dc16e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.d8f304e4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.ac3dd3f7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.e8bdc588.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.f20e95e2.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.46fb949d.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.37fde797.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e291bbe5.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.7deee47f.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.6126ed62.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidainæ–‡æ¡£å¯¼å‡ºçš„æ–¹æ³•.html.f99ad030.js"><link rel="prefetch" href="/obsidian-publish/assets/ç¬”è®°åˆ†ç±»æ–¹æ³•çš„æ€è€ƒ.html.f2f4101a.js"><link rel="prefetch" href="/obsidian-publish/assets/æ‚è¯ï¼šä»æ„è¯†å½¢æ€åˆ†æè¥¿æ–¹ç–«æƒ….html.9eadd293.js"><link rel="prefetch" href="/obsidian-publish/assets/è¯»æ¸…æ”¿åºœæ˜¯å¦åº”è¯¥ä¿®å»ºé“è·¯ä¸€æ–‡.html.71c36bf1.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.24a96f75.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b76fc3f0.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.ba71ba2a.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.103ba7cd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.7d4c0d5f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b1a4c497.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0c6eca16.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.394348dd.js"><link rel="prefetch" href="/obsidian-publish/assets/auto.56c9cb2e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.1f644ee1.js"><link rel="prefetch" href="/obsidian-publish/assets/flowchart.parse.1479ec3f.js"><link rel="prefetch" href="/obsidian-publish/assets/mermaid.esm.min.0e041931.js"><link rel="prefetch" href="/obsidian-publish/assets/highlight.esm.9b852bc5.js"><link rel="prefetch" href="/obsidian-publish/assets/markdown.esm.77e8db25.js"><link rel="prefetch" href="/obsidian-publish/assets/math.esm.cb9d4be3.js"><link rel="prefetch" href="/obsidian-publish/assets/notes.esm.62c5f19d.js"><link rel="prefetch" href="/obsidian-publish/assets/reveal.esm.41ec5d7f.js"><link rel="prefetch" href="/obsidian-publish/assets/search.esm.04894411.js"><link rel="prefetch" href="/obsidian-publish/assets/zoom.esm.78977eba.js"><link rel="prefetch" href="/obsidian-publish/assets/VuePlayground.3cfc7758.js"><link rel="prefetch" href="/obsidian-publish/assets/photoswipe.esm.f594e77b.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/obsidian-publish/" class="brand"><img class="logo" src="/obsidian-publish/logo.svg" alt="Windily Cloud"><!----><span class="site-name hide-in-pad">Windily Cloud</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><span class="icon iconfont icon-home"></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/home.html" class="nav-link" aria-label="å›¾è°±"><span class="icon iconfont icon-home"></span>å›¾è°±<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="ä¸»é¢˜æ–‡æ¡£" class="nav-link"><span class="icon iconfont icon-note"></span>ä¸»é¢˜æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/windily-cloud/obsidian-publish" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><a href="/obsidian-publish/" class="title">Vault</a><!----></p><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">è§é—»</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">Obsidian</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><span class="title">Clean Archtechture</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/" class="nav-link sidebar-link sidebar-page" aria-label="README.md"><span class="icon iconfont icon-file"></span>README.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/afterword.html" class="nav-link sidebar-link sidebar-page" aria-label="afterword.md"><span class="icon iconfont icon-file"></span>afterword.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch1.html" class="nav-link sidebar-link sidebar-page" aria-label="ch1.md"><span class="icon iconfont icon-file"></span>ch1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch10.html" class="nav-link sidebar-link sidebar-page" aria-label="ch10.md"><span class="icon iconfont icon-file"></span>ch10.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch11.html" class="nav-link sidebar-link sidebar-page" aria-label="ch11.md"><span class="icon iconfont icon-file"></span>ch11.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch12.html" class="nav-link sidebar-link sidebar-page" aria-label="ch12.md"><span class="icon iconfont icon-file"></span>ch12.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch13.html" class="nav-link sidebar-link sidebar-page" aria-label="ch13.md"><span class="icon iconfont icon-file"></span>ch13.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html" class="nav-link sidebar-link sidebar-page" aria-label="ch14.md"><span class="icon iconfont icon-file"></span>ch14.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch15.html" class="nav-link sidebar-link sidebar-page" aria-label="ch15.md"><span class="icon iconfont icon-file"></span>ch15.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch16.html" class="nav-link sidebar-link sidebar-page" aria-label="ch16.md"><span class="icon iconfont icon-file"></span>ch16.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch17.html" class="nav-link sidebar-link sidebar-page" aria-label="ch17.md"><span class="icon iconfont icon-file"></span>ch17.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch18.html" class="nav-link sidebar-link sidebar-page" aria-label="ch18.md"><span class="icon iconfont icon-file"></span>ch18.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch19.html" class="nav-link sidebar-link sidebar-page" aria-label="ch19.md"><span class="icon iconfont icon-file"></span>ch19.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch2.html" class="nav-link sidebar-link sidebar-page" aria-label="ch2.md"><span class="icon iconfont icon-file"></span>ch2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch20.html" class="nav-link sidebar-link sidebar-page" aria-label="ch20.md"><span class="icon iconfont icon-file"></span>ch20.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch21.html" class="nav-link sidebar-link sidebar-page" aria-label="ch21.md"><span class="icon iconfont icon-file"></span>ch21.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch22.html" class="nav-link sidebar-link sidebar-page" aria-label="ch22.md"><span class="icon iconfont icon-file"></span>ch22.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch23.html" class="nav-link sidebar-link sidebar-page" aria-label="ch23.md"><span class="icon iconfont icon-file"></span>ch23.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch24.html" class="nav-link sidebar-link sidebar-page" aria-label="ch24.md"><span class="icon iconfont icon-file"></span>ch24.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html" class="nav-link sidebar-link sidebar-page" aria-label="ch25.md"><span class="icon iconfont icon-file"></span>ch25.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch26.html" class="nav-link sidebar-link sidebar-page" aria-label="ch26.md"><span class="icon iconfont icon-file"></span>ch26.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch27.html" class="nav-link sidebar-link sidebar-page" aria-label="ch27.md"><span class="icon iconfont icon-file"></span>ch27.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch28.html" class="nav-link sidebar-link sidebar-page" aria-label="ch28.md"><span class="icon iconfont icon-file"></span>ch28.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch29.html" class="nav-link sidebar-link sidebar-page" aria-label="ch29.md"><span class="icon iconfont icon-file"></span>ch29.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch3.html" class="nav-link sidebar-link sidebar-page" aria-label="ch3.md"><span class="icon iconfont icon-file"></span>ch3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch30.html" class="nav-link sidebar-link sidebar-page" aria-label="ch30.md"><span class="icon iconfont icon-file"></span>ch30.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch31.html" class="nav-link sidebar-link sidebar-page" aria-label="ch31.md"><span class="icon iconfont icon-file"></span>ch31.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch32.html" class="nav-link sidebar-link sidebar-page" aria-label="ch32.md"><span class="icon iconfont icon-file"></span>ch32.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch33.html" class="nav-link sidebar-link sidebar-page" aria-label="ch33.md"><span class="icon iconfont icon-file"></span>ch33.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ch34.md"><span class="icon iconfont icon-file"></span>ch34.md<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-layer-æŒ‰å±‚å°è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PACKAGE BY LAYER æŒ‰å±‚å°è£…"><!---->PACKAGE BY LAYER æŒ‰å±‚å°è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-feature-æŒ‰åŠŸèƒ½å°è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PACKAGE BY FEATURE æŒ‰åŠŸèƒ½å°è£…"><!---->PACKAGE BY FEATURE æŒ‰åŠŸèƒ½å°è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#ports-and-adapters-ç«¯å£å’Œé€‚é…å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PORTS AND ADAPTERS ç«¯å£å’Œé€‚é…å™¨"><!---->PORTS AND ADAPTERS ç«¯å£å’Œé€‚é…å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-component-æŒ‰ç»„ä»¶å°è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PACKAGE BY COMPONENT æŒ‰ç»„ä»¶å°è£…"><!---->PACKAGE BY COMPONENT æŒ‰ç»„ä»¶å°è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#the-devil-is-in-the-implementation-details-å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="THE DEVIL IS IN THE IMPLEMENTATION DETAILS å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±"><!---->THE DEVIL IS IN THE IMPLEMENTATION DETAILS å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#organization-versus-encapsulation-ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ORGANIZATION VERSUS ENCAPSULATION ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«"><!---->ORGANIZATION VERSUS ENCAPSULATION ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#other-decoupling-modes-å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="OTHER DECOUPLING MODES å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼"><!---->OTHER DECOUPLING MODES å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#conclusion-the-missing-advice-æœ¬ç« å°ç»“-æœ¬ä¹¦æ‹¾é—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CONCLUSION: THE MISSING ADVICE æœ¬ç« å°ç»“ï¼šæœ¬ä¹¦æ‹¾é—"><!---->CONCLUSION: THE MISSING ADVICE æœ¬ç« å°ç»“ï¼šæœ¬ä¹¦æ‹¾é—<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link sidebar-link sidebar-page" aria-label="ch4.md"><span class="icon iconfont icon-file"></span>ch4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html" class="nav-link sidebar-link sidebar-page" aria-label="ch5.md"><span class="icon iconfont icon-file"></span>ch5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch6.html" class="nav-link sidebar-link sidebar-page" aria-label="ch6.md"><span class="icon iconfont icon-file"></span>ch6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch7.html" class="nav-link sidebar-link sidebar-page" aria-label="ch7.md"><span class="icon iconfont icon-file"></span>ch7.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch8.html" class="nav-link sidebar-link sidebar-page" aria-label="ch8.md"><span class="icon iconfont icon-file"></span>ch8.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch9.html" class="nav-link sidebar-link sidebar-page" aria-label="ch9.md"><span class="icon iconfont icon-file"></span>ch9.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part1.html" class="nav-link sidebar-link sidebar-page" aria-label="part1.md"><span class="icon iconfont icon-file"></span>part1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part2.html" class="nav-link sidebar-link sidebar-page" aria-label="part2.md"><span class="icon iconfont icon-file"></span>part2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part3.html" class="nav-link sidebar-link sidebar-page" aria-label="part3.md"><span class="icon iconfont icon-file"></span>part3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part4.html" class="nav-link sidebar-link sidebar-page" aria-label="part4.md"><span class="icon iconfont icon-file"></span>part4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part5.html" class="nav-link sidebar-link sidebar-page" aria-label="part5.md"><span class="icon iconfont icon-file"></span>part5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part6.html" class="nav-link sidebar-link sidebar-page" aria-label="part6.md"><span class="icon iconfont icon-file"></span>part6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/%E5%AF%BC%E8%88%AA.html" class="nav-link sidebar-link sidebar-page" aria-label="å¯¼èˆª.md"><span class="icon iconfont icon-file"></span>å¯¼èˆª.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Chap34. THE MISSING CHAPTER æ‹¾é—</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://windily-cloud.github.io" target="_blank" rel="noopener noreferrer">Windily-Cloud</a></span><span property="author" content="Windily-Cloud"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´9æœˆ20æ—¥</span><meta property="datePublished" content="2022-09-20T11:03:58.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´9æœˆ20æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 30 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT30M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#chap34-the-missing-chapter-æ‹¾é—" class="router-link-active router-link-exact-active toc-link level1">Chap34. THE MISSING CHAPTER æ‹¾é—</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-layer-æŒ‰å±‚å°è£…" class="router-link-active router-link-exact-active toc-link level2">PACKAGE BY LAYER æŒ‰å±‚å°è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-feature-æŒ‰åŠŸèƒ½å°è£…" class="router-link-active router-link-exact-active toc-link level2">PACKAGE BY FEATURE æŒ‰åŠŸèƒ½å°è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#ports-and-adapters-ç«¯å£å’Œé€‚é…å™¨" class="router-link-active router-link-exact-active toc-link level2">PORTS AND ADAPTERS ç«¯å£å’Œé€‚é…å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#package-by-component-æŒ‰ç»„ä»¶å°è£…" class="router-link-active router-link-exact-active toc-link level2">PACKAGE BY COMPONENT æŒ‰ç»„ä»¶å°è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#the-devil-is-in-the-implementation-details-å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±" class="router-link-active router-link-exact-active toc-link level2">THE DEVIL IS IN THE IMPLEMENTATION DETAILS å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#organization-versus-encapsulation-ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«" class="router-link-active router-link-exact-active toc-link level2">ORGANIZATION VERSUS ENCAPSULATION ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#other-decoupling-modes-å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼" class="router-link-active router-link-exact-active toc-link level2">OTHER DECOUPLING MODES å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html#conclusion-the-missing-advice-æœ¬ç« å°ç»“-æœ¬ä¹¦æ‹¾é—" class="router-link-active router-link-exact-active toc-link level2">CONCLUSION: THE MISSING ADVICE æœ¬ç« å°ç»“ï¼šæœ¬ä¹¦æ‹¾é—</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="chap34-the-missing-chapter-æ‹¾é—" tabindex="-1"><a class="header-anchor" href="#chap34-the-missing-chapter-æ‹¾é—" aria-hidden="true">#</a> Chap34. THE MISSING CHAPTER æ‹¾é—</h1><p>By Simon Brown</p><p>All of the advice youâ€™ve read so far will certainly help you design better software, composed of classes and components with well-defined boundaries, clear responsibilities, and controlled dependencies. But it turns out that the devil is in the implementation details, and itâ€™s really easy to fall at the last hurdle if you donâ€™t give that some thought, too.</p><blockquote><p>æ ¹æ®æœ¬ä¹¦ä¹‹å‰ç»™å‡ºçš„æ‰€æœ‰å»ºè®®ï¼Œç›¸ä¿¡è¯»è€…ä¸€å®šèƒ½å¤Ÿå»ºæ„å‡ºå…·æœ‰è‰¯å¥½è¾¹ç•Œè®¾è®¡çš„ç±»å’Œç»„ä»¶ï¼Œä»¥å½¢æˆæ¸…æ™°çš„è´£ä»»åˆ’åˆ†ä»¥åŠå¯æ§çš„ä¾èµ–å…³ç³»ï¼Œè®¾è®¡å‡ºæ›´å¥½çš„è½¯ä»¶äº†ã€‚ä½†æ˜¯å›°éš¾ä¹‹å¤„å¾€å¾€åœ¨äºç»†èŠ‚ä¹‹ä¸­ï¼Œä¸€æ—¦ç–å¿½ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šå¯¹è½¯ä»¶è´¨é‡é€ æˆä¸è‰¯å½±å“ã€‚</p></blockquote><p>Letâ€™s imagine that weâ€™re building an online book store, and one of the use cases weâ€™ve been asked to implement is about customers being able to view the status of their orders. Although this is a Java example, the principles apply equally to other programming languages. Letâ€™s put the Clean Architecture to one side for a moment and look at a number of approaches to design and code organization.</p><blockquote><p>ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æ­£åœ¨æ„å»ºä¸€ä¸ªåœ¨çº¿ä¹¦åº—ï¼Œè¿™ä¸ªä¾‹å­çš„ä»»åŠ¡æ˜¯å®ç°ä¸€ä¸ªå®¢æˆ·æŸ»çœ‹è®¢å•çŠ¶æ€çš„ç”¨ä¾‹ï¼Œè™½ç„¶è¿™æ˜¯ä¸€ä¸ª Java ç¨‹åºçš„ç¤ºä¾‹ï¼Œä½†å…¶æ‰€ç¤ºèŒƒçš„åŸç†é€‚ç”¨äºä»»ä½•è¯­è¨€ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æš‚æ—¶å°†æ•´æ´æ¶æ„çš„æ¦‚å¿µæ”¾åœ¨ä¸€è¾¹ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹å¦‚ä½•å…·ä½“å®‰æ’ä»£ç è®¾è®¡å’Œä»£ç ç»“æ„ã€‚</p></blockquote><h2 id="package-by-layer-æŒ‰å±‚å°è£…" tabindex="-1"><a class="header-anchor" href="#package-by-layer-æŒ‰å±‚å°è£…" aria-hidden="true">#</a> PACKAGE BY LAYER æŒ‰å±‚å°è£…</h2><p>The first, and perhaps simplest, design approach is the traditional horizontal layered architecture, where we separate our code based on what it does from a technical perspective. This is often called â€œpackage by layer.â€ Figure 34.1 shows what this might look like as a UML class diagram.</p><blockquote><p>æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯æœ€ç®€å•çš„è®¾è®¡æ–¹å¼ï¼Œå°±æ˜¯ä¼ ç»Ÿçš„æ°´å¹³åˆ†å±‚æ¶æ„ã€‚åœ¨è¿™ä¸ªæ¶æ„é‡Œï¼Œæˆ‘ä»¬å°†ä»£ç ä»æŠ€æœ¯è§’åº¦è¿›è¡Œåˆ†ç±»ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œæŒ‰å±‚å°è£…â€ã€‚å›¾ 34.1 ç”¨ UML ç±»å›¾å±•ç¤ºäº†è¿™ç§è®¾è®¡ã€‚</p></blockquote><p>In this typical layered architecture, we have one layer for the web code, one layer for our â€œbusiness logic,â€ and one layer for persistence. In other words, code is sliced horizontally into layers, which are used as a way to group similar types of things. In a â€œstrict layered architecture,â€ layers should depend only on the next adjacent lower layer. In Java, layers are typically implemented as packages. As you can see in Figure 34.1, all of the dependencies between layers (packages) point downward. In this example, we have the following Java types:</p><blockquote><p>åœ¨è¿™ç§å¸¸è§çš„åˆ†å±‚æ¶æ„ä¸­ï¼ŒWeb ä»£ç åˆ†ä¸ºä¸€å±‚ï¼Œä¸šåŠ¡é€»è¾‘åˆ†ä¸ºä¸€å±‚ï¼ŒæŒä¹…åŒ–æ˜¯å¦å¤–ä¸€å±‚ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œäº†æ°´å¹³åˆ†å±‚ï¼Œç›¸åŒç±»å‹çš„ä»£ç åœ¨ä¸€å±‚ã€‚åœ¨â€œä¸¥æ ¼çš„åˆ†å±‚æ¶æ„â€ä¸­ï¼Œæ¯ä¸€å±‚åªèƒ½å¯¹ç›¸é‚»çš„ä¸‹å±‚æœ‰ä¾èµ–å…³ç³»ã€‚åœ¨ Java ä¸­ï¼Œåˆ†å±‚çš„æ¦‚å¿µé€šå¸¸æ˜¯ç”¨åŒ…æ¥è¡¨ç¤ºçš„ã€‚å¦‚å›¾ 34.1 æ‰€ç¤ºï¼Œæ‰€æœ‰çš„åˆ†å±‚ï¼ˆåŒ…ï¼‰ä¹‹é—´çš„ä¾èµ–å…³ç³»éƒ½æ˜¯æŒ‡å‘ä¸‹çš„ã€‚è¿™é‡ŒåŒ…æ‹¬äº†ä»¥ä¸‹ Java ç±»ã€‚</p></blockquote><ul><li>OrdersController: A web controller, something like a Spring MVC controller, that handles requests from the web.</li><li>OrdersService: An interface that defines the â€œbusiness logicâ€ related to orders.</li><li>OrdersServiceImpl: The implementation of the orders service.1</li><li>OrdersRepository: An interface that defines how we get access to persistent order information.</li><li>JdbcOrdersRepository: An implementation of the repository interface.</li></ul><hr><blockquote><ul><li>OrdersControllerï¼šWeb æ§åˆ¶å™¨ï¼Œç±»ä¼¼ Spring MVC æ§åˆ¶å™¨ï¼Œè´Ÿè´£å¤„ç† Web è¯·æ±‚ã€‚</li><li>OrderServiceï¼šå®šä¹‰è®¢å•ç›¸å…³ä¸šåŠ¡é€»è¾‘çš„æ¥å£ã€‚</li><li>OrderServicelmplï¼šOrder æœåŠ¡çš„å…·ä½“å®ç°</li><li>OrdersRepositoryï¼šå®šä¹‰å¦‚ä½•è®¿é—®è®¢å•æŒä¹…ä¿¡æ¯çš„æ¥å£ã€‚</li><li>JdbcOrderRepositoryï¼šæŒä¹…ä¿¡æ¯è®¿é—®æ¥å£çš„å®ç°ã€‚</li></ul></blockquote><!----><p>In â€œPresentation Domain Data Layering,â€2 Martin Fowler says that adopting such a layered architecture is a good way to get started. Heâ€™s not alone. Many of the books, tutorials, training courses, and sample code youâ€™ll find will also point you down the path of creating a layered architecture. Itâ€™s a very quick way to get something up and running without a huge amount of complexity. The problem, as Martin points out, is that once your software grows in scale and complexity, you will quickly find that having three large buckets of code isnâ€™t sufficient, and you will need to think about modularizing further.</p><blockquote><p>åœ¨ presentation Domain Data Layering è¿™ç¯‡æ–‡ç« ä¸­ï¼ŒMartin Fowler å£°ç§°é‡†ç”¨è¿™ç§åˆ†å±‚æ¶æ„æ˜¯åˆæœŸä¸€ä¸ªä¸é”™é€‰æ‹©ã€‚ä»–çš„è§‚ç‚¹å¹¶ä¸ç¼ºä¹æ‹¥æˆ´è€…ã€‚å¾ˆå¤šä¹¦ç±ã€æ•™ç¨‹å’Œä»£ç ç¤ºèŒƒéƒ½åœ¨æ•™è‚²ä½ é‡‡ç”¨åˆ†å±‚æ¶æ„ã€‚è¿™ç§æ–¹å¼åœ¨åœ¨é¡¹ç›®åˆæœŸä¹‹æ‰€ä»¥ä¼šå¾ˆåˆé€‚ï¼Œæ˜¯å› ä¸ºå®ƒä¸ä¼šè¿‡äºå¤æ‚ã€‚ä½†å°±åƒ Martin æŒ‡å‡ºçš„é‚£æ ·ï¼Œä¸€æ—¦è½¯ä»¶è§„æ¨¡æ‰©å±•äº†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šå‘ç°å°†ä»£ç åˆ†ä¸ºä¸‰å¤§å—å¹¶ä¸å¤Ÿï¼Œéœ€è¦è¿›ä¸€æ­¥è¿›è¡Œæ¨¡å—åŒ–ã€‚</p></blockquote><p>Another problem is that, as Uncle Bob has already said, a layered architecture doesnâ€™t scream anything about the business domain. Put the code for two layered architectures, from two very different business domains, side by side and they will likely look eerily similar: web, services, and repositories. Thereâ€™s also another huge problem with layered architectures, but weâ€™ll get to that later.</p><blockquote><p>å¦‚ Bob æ‰€è¯´ï¼Œè¿™é‡Œè¿˜å­˜åœ¨å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåˆ†å±‚æ¶æ„æ— æ³•å±•ç°å…·ä½“çš„ä¸šåŠ¡é¢†åŸŸä¿¡æ¯ã€‚æŠŠä¸¤ä¸ªä¸åŒä¸šåŠ¡é¢†åŸŸçš„ã€ä½†æ˜¯éƒ½é‡‡ç”¨äº†åˆ†å±‚æ¶æ„çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œä½ ä¼šå‘ç°å®ƒä»¬çš„ç›¸ä¼¼ç¨‹åº¦æé«˜ï¼šéƒ½æœ‰ Web å±‚ã€æœåŠ¡å±‚å’Œæ•°æ®ä»“åº“å±‚ã€‚è¿™æ˜¯åˆ†å±‚æ¶æ„çš„å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œåæ–‡ä¼šå…·ä½“è®²è¿°ã€‚</p></blockquote><h2 id="package-by-feature-æŒ‰åŠŸèƒ½å°è£…" tabindex="-1"><a class="header-anchor" href="#package-by-feature-æŒ‰åŠŸèƒ½å°è£…" aria-hidden="true">#</a> PACKAGE BY FEATURE æŒ‰åŠŸèƒ½å°è£…</h2><p>Another option for organizing your code is to adopt a â€œpackage by featureâ€ style. This is a vertical slicing, based on related features, domain concepts, or aggregate roots (to use domain-driven design terminology). In the typical implementations that Iâ€™ve seen, all of the types are placed into a single Java package, which is named to reflect the concept that is being grouped.</p><blockquote><p>å¦å¤–ä¸€ç§ç»„ç»‡ä»£ç çš„å½¢å¼æ˜¯â€œæŒ‰åŠŸèƒ½å°è£…â€ï¼Œå³å‚ç›´åˆ‡åˆ†ï¼Œæ ¹æ®ç›¸å…³çš„åŠŸèƒ½ã€ä¸šåŠ¡æ¦‚å¿µæˆ–è€…èšåˆæ ¹ï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡åŸåˆ™ä¸­çš„æœ¯è¯­ï¼‰æ¥åˆ‡åˆ†ã€‚åœ¨å¸¸è§çš„å®ç°ä¸­ï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½ä¼šæ”¾åœ¨ä¸€ä¸ªç›¸åŒçš„åŒ…ä¸­ï¼Œä»¥ä¸šåŠ¡æ¦‚å¿µæ¥å‘½åã€‚</p></blockquote><p>With this approach, as shown in Figure 34.2, we have the same interfaces and classes as before, but they are all placed into a single Java package rather than being split among three packages. This is a very simple refactoring from the â€œpackage by layerâ€ style, but the top-level organization of the code now screams something about the business domain. We can now see that this code base has something to do with orders rather than the web, services, and repositories. Another benefit is that itâ€™s potentially easier to find all of the code that you need to modify in the event that the â€œview ordersâ€ use case changes. Itâ€™s all sitting in a single Java package rather than being spread out.3</p><blockquote><p>å›¾ 34.2 å±•ç¤ºäº†è¿™ç§æ–¹å¼ï¼Œç±»å’Œæ¥å£ä¸ä¹‹å‰ç±»ä¼¼ï¼Œä½†æ˜¯ç›¸æ¯”ä¹‹å‰ï¼Œè¿™æ¬¡å®ƒä»¬éƒ½è¢«æ”¾åˆ°äº†åŒä¸€ä¸ª Java åŒ…ä¸­ã€‚ç›¸ æ¯” â€œæŒ‰å±‚å°è£…â€ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå°å˜åŒ–ï¼Œä½†æ˜¯ç°åœ¨é¡¶å±‚ä»£ç ç»“æ„è‡³å°‘ä¸ä¸šåŠ¡é¢†åŸŸæœ‰ç‚¹ç›¸å…³äº†ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç æ˜¯ä¸è®¢å•æœ‰å…³çš„ï¼Œè€Œä¸æ˜¯åªèƒ½çœ‹åˆ° Webã€æœåŠ¡åŠæ•°æ®è®¿é—®ã€‚å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ â€œæŸ¥çœ‹è®¢å•â€è¿™ä¸ªä¸šåŠ¡ç”¨ä¾‹ï¼Œæ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°ç›¸å…³ä»£ç ï¼Œæ¯•ç«Ÿå®ƒä»¬éƒ½åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨å„å¤„ã€‚</p></blockquote><p>I often see software development teams realize that they have problems with horizontal layering (â€œpackage by layerâ€) and switch to vertical layering (â€œpackage by featureâ€) instead. In my opinion, both are suboptimal. If youâ€™ve read this book so far, you might be thinking that we can do much betterâ€”and youâ€™re right.</p><blockquote><p>è½¯ä»¶ç ”å‘å›¢é˜Ÿå¸¸å¸¸ä¸€å¼€å§‹é‡‡ç”¨æ°´å¹³åˆ†å±‚æ–¹å¼ï¼ˆå³ â€œæŒ‰å±‚å°è£…â€ï¼‰ï¼Œé‡åˆ°å›°éš¾åå†åˆ‡æ¢åˆ°å‚ç›´åˆ†å±‚æ–¹å¼ï¼ˆå³ â€œæŒ‰åŠŸèƒ½å°è£…â€ï¼‰ã€‚æˆ‘è®¤ä¸ºï¼Œä¸¤ç§æ–¹å¼éƒ½å¾ˆä¸å¥½ã€‚çœ‹å®Œæœ¬ä¹¦ï¼Œä½ åº”è¯¥æ„è¯†åˆ°è¿˜æœ‰æ›´å¥½çš„åˆ†ç±»æ–¹å¼â€”â€”æ²¡é”™ã€‚</p></blockquote><!----><h2 id="ports-and-adapters-ç«¯å£å’Œé€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#ports-and-adapters-ç«¯å£å’Œé€‚é…å™¨" aria-hidden="true">#</a> PORTS AND ADAPTERS ç«¯å£å’Œé€‚é…å™¨</h2><p>As Uncle Bob has said, approaches such as â€œports and adapters,â€ the â€œhexagonal architecture,â€ â€œboundaries, controllers, entities,â€ and so on aim to create architectures where business/domain-focused code is independent and separate from the technical implementation details such as frameworks and databases. To summarize, you often see such code bases being composed of an â€œinsideâ€ (domain) and an â€œoutsideâ€ (infrastructure), as suggested in Figure 34.3.</p><blockquote><p>å¦‚ Bob å¤§å”æ‰€è¯´ï¼Œé€šè¿‡é‡‡ç”¨â€œç«¯å£å’Œé€‚é…å™¨â€â€œå…­è¾¹å½¢æ¶æ„â€â€œè¾¹ç•Œã€æ§åˆ¶å™¨ã€å®ä½“â€ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ å‡ºä¸€ä¸ªä¸šåŠ¡é¢†åŸŸä»£ç ä¸å…·ä½“å®ç°ç»†èŠ‚ï¼ˆæ•°æ®åº“ã€æ¡†æ¶ç­‰ï¼‰éš”ç¦»çš„æ¶æ„ã€‚æ€»ç»“ä¸‹æ¥ï¼Œå¦‚å›¾ 34.3 æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åŒºåˆ†å‡ºä»£ç ä¸­çš„å†…éƒ¨ä»£ç ï¼ˆé¢†åŸŸï¼ŒDomainï¼‰ä¸å¤–éƒ¨ä»£ç ï¼ˆåŸºç¡€è®¾æ–½ï¼ŒInfrastructureï¼‰ã€‚</p></blockquote><!----><p>The â€œinsideâ€ region contains all of the domain concepts, whereas the â€œoutsideâ€ region contains the interactions with the outside world (e.g., UIs, databases, third-party integrations). The major rule here is that the â€œoutsideâ€ depends on the â€œinsideâ€â€”never the other way around. Figure 34.4 shows a version of how the â€œview ordersâ€ use case might be implemented.</p><blockquote><p>å†…éƒ¨åŒºåŸŸåŒ…å«äº†æ‰€æœ‰çš„é¢†åŸŸæ¦‚å¿µï¼Œè€Œå¤–éƒ¨åŒºåŸŸåˆ™åŒ…å«äº†ä¸å¤–ç•Œäº¤äº’çš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚ UIã€æ•°æ®åº“ã€ç¬¬ä¸‰æ–¹é›†æˆç­‰ï¼‰ã€‚è¿™é‡Œä¸»è¦çš„è§„åˆ™æ˜¯ï¼Œåªæœ‰å¤–éƒ¨ä»£ç èƒ½ä¾èµ–å†…éƒ¨ä»£ç ï¼Œåä¹‹åˆ™ä¸èƒ½ã€‚å›¾ 34.4 å±•ç¤ºäº† â€œæŸ¥çœ‹è®¢å•â€è¿™ä¸ªä¸šåŠ¡ç”¨ä¾‹æ˜¯å¦‚ä½•ç”¨è¿™ç§æ–¹å¼å®ç°çš„ã€‚</p></blockquote><p>The <code>com.mycompany.myapp.domain</code> package here is the â€œinside,â€ and the other packages are the â€œoutside.â€ Notice how the dependencies flow toward the â€œinside.â€ The keen-eyed reader will notice that the OrdersRepository from previous diagrams has been renamed to simply be Orders. This comes from the world of domain-driven design, where the advice is that the naming of everything on the â€œinsideâ€ should be stated in terms of the â€œubiquitous domain language.â€ To put that another way, we talk about â€œordersâ€ when weâ€™re having a discussion about the domain, not the â€œorders repository.â€</p><blockquote><p>è¿™é‡Œ <code>com.mycompnay.myapp.domain</code> åŒ…æ˜¯å†…éƒ¨ä»£ç ï¼Œå¦å¤–ä¸€ä¸ªåŒ…æ˜¯å¤–éƒ¨ä»£ç ã€‚æ³¨æ„è¿™é‡Œçš„ä¾èµ–å…³ç³»æ˜¯ç”±å¤–å‘å†…çš„ã€‚çœ¼å°–çš„è¯»è€…å¯ä»¥æ³¨æ„åˆ°ä¹‹å‰çš„ OrderRepository ç±»ç°åœ¨è¢«æ”¹åä¸º Ordersã€‚è¿™ä¸ªæ¦‚å¿µåŸºäºé¢†åŸŸé©±åŠ¨è®¾è®¡ç†å¿µï¼Œå…¶ä¸­è¦æ±‚å†…éƒ¨ä»£ç éƒ½åº”è¯¥ç”¨ç‹¬ç‰¹çš„é¢†åŸŸè¯­è¨€æ¥æè¿°ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åœ¨ä¸šåŠ¡é¢†åŸŸé‡Œé¢è®¨è®ºçš„åº”è¯¥æ˜¯ Ordersï¼Œè€Œä¸æ˜¯â€œOrdersRepositoryâ€ã€‚</p></blockquote><!----><p>Itâ€™s also worth pointing out that this is a simplified version of what the UML class diagram might look like, because itâ€™s missing things like interactors and objects to marshal the data across the dependency boundaries.</p><blockquote><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯ UML ç±»å›¾çš„ä¸€ä¸ªç®€åŒ–ç‰ˆï¼Œè¿™é‡Œç¼ºå°‘äº†äº¤äº’å™¨ï¼Œä»¥åŠè·¨è¾¹ç•Œè°ƒç”¨æ—¶å¯¹åº”çš„æ•°æ®ç¼–ç è§£ç å¯¹è±¡ã€‚</p></blockquote><h2 id="package-by-component-æŒ‰ç»„ä»¶å°è£…" tabindex="-1"><a class="header-anchor" href="#package-by-component-æŒ‰ç»„ä»¶å°è£…" aria-hidden="true">#</a> PACKAGE BY COMPONENT æŒ‰ç»„ä»¶å°è£…</h2><p>Although I agree wholeheartedly with the discussions about SOLID, REP, CCP, and CRP and most of the advice in this book, I come to a slightly different conclusion about how to organize code. So Iâ€™m going to present another option here, which I call â€œpackage by component.â€ To give you some background, Iâ€™ve spent most of my career building enterprise software, primarily in Java, across a number of different business domains. Those software systems have varied immensely, too. A large number have been web-based, but others have been clientâ€“server4, distributed, message-based, or something else. Although the technologies differed, the common theme was that the architecture for most of these software systems was based on a traditional layered architecture.</p><blockquote><p>è™½ç„¶æˆ‘å¯¹æœ¬ä¹¦ä¸­çš„ SOLIDã€REPã€CCPã€CRP ä»¥åŠå…¶ä»–å¤§éƒ¨åˆ†å»ºè®®å®Œå…¨è®¤åŒï¼Œæˆ‘æƒ³æå‡ºå¯¹ä»£ç ç»„ç»‡æ–¹å¼çš„ä¸€ä¸ªä¸åŒçœ‹æ³•â€”â€”â€œæŒ‰ç»„ä»¶å°è£…â€ã€‚ä¸€äº›èƒŒæ™¯ä¿¡æ¯ï¼šåœ¨æˆ‘çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œæˆ‘åŸºäº Java æ„å»ºäº†å¤§é‡ä¸åŒé¢†åŸŸçš„ä¼ä¸šè½¯ä»¶ï¼Œè¿™äº›è½¯ä»¶ç³»ç»Ÿè¦æ±‚å„å¼‚ã€‚å¤§éƒ¨åˆ†ç³»ç»Ÿéƒ½æ˜¯åŸºäº Web çš„ï¼Œä¹Ÿæœ‰ä¸€äº›æ˜¯ CS æ¶æ„ï¼Œæˆ–è€…æ˜¯åˆ†å¸ƒå¼æ¶æ„çš„ã€åŸºäºæ¶ˆæ¯çš„ï¼Œæˆ–è€…å…¶ä»–çš„ã€‚è™½ç„¶å…·ä½“é‡‡ç”¨çš„æŠ€æœ¯ä¸åŒï¼Œä½†å¤§éƒ¨åˆ†ç³»ç»Ÿéƒ½æ˜¯åŸºäºä¼ ç»Ÿçš„åˆ†å±‚æ¶æ„çš„ã€‚</p></blockquote><p>Iâ€™ve already mentioned a couple of reasons why layered architectures should be considered bad, but thatâ€™s not the whole story. The purpose of a layered architecture is to separate code that has the same sort of function. Web stuff is separated from business logic, which is in turn separated from data access. As we saw from the UML class diagram, from an implementation perspective, a layer typically equates to a Java package. From a code accessibility perspective, for the OrdersController to be able to have a dependency on the OrdersService interface, the OrdersService interface needs to be marked as public, because they are in different packages. Likewise, the OrdersRepository interface needs to be marked as public so that it can be seen outside of the repository package, by the OrdersServiceImpl class.</p><blockquote><p>æˆ‘å·²ç»ç»™å‡ºä¸€äº›åˆ†å±‚æ¶æ„ä¸å¥½çš„ç†ç”±ï¼Œä½†è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚åˆ†å±‚æ¶æ„è®¾è®¡çš„ç›®çš„æ˜¯å°†åŠŸèƒ½ç›¸ä¼¼çš„ä»£ç è¿›è¡Œåˆ†ç»„ã€‚å¤„ç† Web çš„ä»£ç åº”è¯¥ä¸å¤„ç†ä¸šåŠ¡é€»è¾‘çš„ä»£ç åˆ†å¼€ï¼ŒåŒæ—¶ä¹Ÿä¸å¤„ç†æ•°æ®è®¿é—®çš„ä»£ç åˆ†å¼€ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ UML ç±»å›¾ä¸­æ‰€è§ï¼Œä»å®ç°è§’åº¦è®²ï¼Œå±‚å°±æ˜¯ä»£è¡¨äº† Java åŒ…ã€‚ä»ä»£ç å¯è®¿é—®æ€§è§’åº¦æ¥è®²ï¼Œå¦‚æœéœ€è¦ OrdersController ä¾èµ– OrderService æ¥å£ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£å¿…é¡»è®¾ç½®ä¸º publicï¼Œå› ä¸ºå®ƒä»¬åœ¨ä¸åŒçš„åŒ…ä¸­ã€‚åŒæ ·çš„ï¼ŒOrdersRepository æ¥å£ä¹Ÿéœ€è¦è®¾ç½®ä¸º publicï¼Œè¿™æ ·æ‰èƒ½è¢«åŒ…å¤–çš„ç±» OrdersServicelmple ä½¿ç”¨ã€‚</p></blockquote><p>In a strict layered architecture, the dependency arrows should always point downward, with layers depending only on the next adjacent lower layer. This comes back to creating a nice, clean, acyclic dependency graph, which is achieved by introducing some rules about how elements in a code base should depend on each other. The big problem here is that we can cheat by introducing some undesirable dependencies, yet still create a nice, acyclic dependency graph.</p><blockquote><p>åœ¨ä¸¥æ ¼åˆ†å±‚çš„æ¶æ„ä¸­ï¼Œä¾èµ–æŒ‡å‘çš„ç®­å¤´åº”è¯¥æ°¸è¿œå‘ä¸‹ï¼Œæ¯ä¸€å±‚åªèƒ½ä¾èµ–ç›¸é‚»çš„ä¸‹ä¸€å±‚ã€‚é€šè¿‡å¼•å…¥ä¸€äº›ä»£ç äº’ç›¸ä¾èµ–çš„è§„åˆ™ï¼Œæˆ‘ä»¬å°±å½¢æˆäº†ä¸€ä¸ªå¹²å‡€ã€æ¼‚äº®çš„å•å‘ä¾èµ–å›¾ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¤§é—®é¢˜â€”â€”åªè¦é€šè¿‡å¼•å…¥ä¸€äº›ä¸åº”è¯¥æœ‰çš„ä¾èµ–æ¥ä½œå¼Šï¼Œä¾ç„¶å¯ä»¥å½¢æˆæ¼‚äº®çš„å•å‘ä¾èµ–å›¾ã€‚</p></blockquote><p>Suppose that you hire someone new who joins your team, and you give the newcomer another orders-related use case to implement. Since the person is new, he wants to make a big impression and get this use case implemented as quickly as possible. After sitting down with a cup of coffee for a few minutes, the newcomer discovers an existing OrdersController class, so he decides thatâ€™s where the code for the new orders-related web page should go. But it needs some orders data from the database. The newcomer has an epiphany: â€œOh, thereâ€™s an OrdersRepository interface already built, too. I can simply dependency-inject the implementation into my controller. Perfect!â€ After a few more minutes of hacking, the web page is working. But the resulting UML diagram looks like Figure 34.5.</p><blockquote><p>å‡è®¾æ–°å‘˜å·¥åŠ å…¥äº†å›¢é˜Ÿï¼Œä½ ç»™æ–°äººå®‰æ’äº†ä¸€ä¸ªè®¢å•ç›¸å…³çš„ä¸šåŠ¡ç”¨ä¾‹çš„å®ç°ä»»åŠ¡ã€‚ç”±äºè¿™ä¸ªäººåˆšåˆšå…¥èŒï¼Œä»–æƒ³å¥½å¥½è¡¨ç°ï¼Œå°½å¿«å®Œæˆè¿™é¡¹åŠŸèƒ½ã€‚ç²—ç•¥çœ‹è¿‡ä»£ç ä¹‹åï¼Œæ–°äººå‘ç°äº† OrdersController è¿™ä¸ªç±»ï¼Œäºæ˜¯ä»–å°†æ–°çš„è®¢å•ç›¸å…³çš„ Web ä»£ç éƒ½å¡äº†è¿›å»ã€‚ä½†æ˜¯è¿™æ®µä»£ç éœ€æ›´ä»æ•°æ®åº“æŸ¥æ‰¾ä¸€äº›è®¢å•æ•°æ®ã€‚è¿™æ—¶å€™è¿™ä¸ªæ–°äººçµæœºä¸€åŠ¨ï¼šâ€œä»£ç å·±ç»æœ‰äº†ä¸€ä¸ª OrdersRepository æ¥å£ï¼Œåªéœ€è¦å°†å®ƒç”¨ä¾èµ–æ³¨å…¥æ¡†æ¶å¼•å…¥æ§åˆ¶å™¨å°±è¡Œï¼Œæˆ‘çœŸæœºæ™ºï¼â€å‡ åˆ†é’Ÿä¹‹åï¼ŒåŠŸèƒ½å·²ç»æ­£å¸¸äº†ï¼Œä½†æ˜¯ UML ç»“æ„å›¾å˜æˆäº†å›¾ 34.5 è¿™æ ·ã€‚</p></blockquote><p>The dependency arrows still point downward, but the OrdersController is now additionally bypassing the OrdersService for some use cases. This organization is often called a relaxed layered architecture, as layers are allowed to skip around their adjacent neighbor(s). In some situations, this is the intended outcomeâ€”if youâ€™re trying to follow the CQRS5 pattern, for example. In many other cases, bypassing the business logic layer is undesirable, especially if that business logic is responsible for ensuring authorized access to individual records, for example.</p><blockquote><p>ä¾èµ–å…³ç³»ç®­å¤´ä¾ç„¶å‘ä¸‹ï¼Œä½†æ˜¯ç°åœ¨ OrdersController åœ¨æŸäº›æƒ…å†µä¸‹ç»•è¿‡äº† OrderService ç±»ã€‚è¿™ç§ç»„ç»‡å½¢å¼è¢«ç§°ä¸ºå®½æ¾çš„åˆ†å±‚é‡‡æ„ï¼Œå…è®¸æŸäº›å±‚è·³è¿‡ç›´æ¥ç›¸é‚»çš„é‚»å±…ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œè¿™æ˜¯æ„æ–™ä¹‹ä¸­çš„â€”â€”ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨éµå¾ª CQRS è®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯åˆç†çš„ã€‚ä½†æ˜¯æ›´å¤šçš„æƒ…å†µä¸‹ï¼Œç»•è¿‡ä¸šåŠ¡é€»è¾‘å±‚æ˜¯ä¸åˆç†çš„ï¼Œå°¤å…¶æ˜¯åœ¨ä¸šåŠ¡é€»è¾‘å±‚è¦æ§åˆ¶æƒé™çš„æƒ…å†µä¸‹ã€‚</p></blockquote><p>While the new use case works, itâ€™s perhaps not implemented in the way that we were expecting. I see this happen a lot with teams that I visit as a consultant, and itâ€™s usually revealed when teams start to visualize what their code base really looks like, often for the first time.</p><blockquote><p>è™½ç„¶æ–°çš„ä¸šåŠ¡ç”¨ä¾‹å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯å®ƒå¯èƒ½ä¸æ˜¯æŒ‰ç…§åˆç†æ–¹å¼å®ç°çš„ã€‚ä½œä¸ºå’¨è¯¢å¸ˆï¼Œæˆ‘æ›¾ç»è§è¿‡å¾ˆå¤šå›¢é˜Ÿå‡ºç°è¿™ç§æƒ…å†µï¼Œåªæœ‰ä»–ä»¬å¼€å§‹ä»”ç»†è§‚å¯Ÿè‡ªå·±çš„ä»£ç ç»“æ„å›¾æ—¶æ‰ä¼šå‘ç°ã€‚</p></blockquote><!----><p>What we need here is a guidelineâ€”an architectural principleâ€”that says something like, â€œWeb controllers should never access repositories directly.â€ The question, of course, is enforcement. Many teams Iâ€™ve met simply say, â€œWe enforce this principle through good discipline and code reviews, because we trust our developers.â€ This confidence is great to hear, but we all know what happens when budgets and deadlines start looming ever closer.</p><blockquote><p>è¿™é‡Œæˆ‘ä»¬æœ‰çš„å…¶å®åªæ˜¯ä¸€ä¸ªè§„èŒƒâ€”â€”ä¸€ä¸ªæ¶æ„è®¾è®¡åŸåˆ™å†…å®¹æ˜¯â€œWeb æ§åˆ¶å™¨æ°¸è¿œä¸åº”è¯¥ç›´æ¥è®¿é—®æ•°æ®å±‚â€ã€‚è¿™é‡Œçš„æ ¸å¿ƒé—®é¢˜å½“ç„¶æ˜¯å¦‚ä½•å¼ºåˆ¶æ‰§è¡Œã€‚æˆ‘é‡è§çš„å¾ˆå¤šå›¢é˜Ÿä»…ä»…é€šè¿‡é‡‡ç”¨â€œè‡ªå¾‹â€æˆ–è€…â€œä»£ç è¯„å®¡â€æ–¹å¼æ¥æ‰§è¡Œï¼Œâ€œæˆ‘ç›¸ä¿¡æˆ‘çš„ç¨‹åºå‘˜â€ã€‚æœ‰è¿™ç§è‡ªä¿¡å½“ç„¶å¾ˆå¥½ï¼Œä½†æ˜¯æˆ‘ä»¬éƒ½çŸ¥é“å½“é¢„ç®—ç¼©å‡ã€å·¥æœŸä¸´è¿‘çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚</p></blockquote><p>A far smaller number of teams tell me that they use static analysis tools (e.g., NDepend, Structure101, Checkstyle) to check and automatically enforce architecture violations at build time. You may have seen such rules yourself; they usually manifest themselves as regular expressions or wildcard strings that state â€œtypes in package <code>**/web</code> should not access types in <code>**/data</code>â€; and they are executed after the compilation step.</p><blockquote><p>æœ‰ä¸€å°éƒ¨åˆ†å›¢é˜Ÿå‘Šè¯‰æˆ‘ï¼Œä»–ä»¬ä¼šé‡‡ç”¨é™æ€åˆ†æå·¥å…·ï¼ˆä¾‹å¦‚ Ndependã€Structure101ã€Checkstyleï¼‰æ¥åœ¨æ„å»ºé˜¶æ®µè‡ªåŠ¨æ£€æŸ¥è¿åæ¶æ„è®¾è®¡è§„åˆ™çš„ä»£ç ã€‚ä¼°è®¡ä½ è§è¿‡è¿™ç§ä»£ç ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯ä¸€æ®µæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¾‹å¦‚â€œåŒ… <code>**/web</code> ä¸‹é¢çš„ç±»å‹ä¸å…è®¸è®¿é—® <code>**/data</code> ä¸‹é¢çš„ç±»å‹â€ï¼Œè¿™äº›æ£€æŸ¥åœ¨ç¼–è¯‘æ­¥éª¤ä¹‹åæ‰§è¡Œã€‚</p></blockquote><p>This approach is a little crude, but it can do the trick, reporting violations of the architecture principles that youâ€™ve defined as a team and (you hope) failing the build. The problem with both approaches is that they are fallible, and the feedback loop is longer than it should be. If left unchecked, this practice can turn a code base into a â€œbig ball of mud.â€6 Iâ€™d personally like to use the compiler to enforce my architecture if at all possible.</p><blockquote><p>è¿™ç§æ–¹å¼è™½ç„¶ç®€å•ç²—æš´ï¼Œä½†æ˜¯ç¡®å®èƒ½èµ·æ•ˆæœï¼Œå¯ä»¥é”å®šè¿åäº†å›¢é˜Ÿå®šä¹‰çš„ç³»ç»Ÿæ¶æ„è®¾è®¡åŸåˆ™çš„æƒ…å†µï¼Œå¹¶ä¸”ï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼‰å¯¼è‡´æ„å»ºå¤±è´¥ã€‚è¿™ä¸¤ç§æ–¹æ³•çš„å…±åŒé—®é¢˜æ˜¯å®¹æ˜“å‡ºé”™ï¼ŒåŒæ—¶åé¦ˆå¾ªç¯æ—¶é—´å¤ªé•¿äº†ã€‚å¦‚æœä¸ç²¾å¿ƒç»´æŠ¤ï¼Œæ•´ä¸ªä»£ç åº“å¯èƒ½å¾ˆå¿«å°±å˜æˆâ€œä¸€å›¢æ³¥å·´â€ã€‚æˆ‘ä¸ªäººæ›´å€¾å‘é€‰æ‹©èƒ½å¤Ÿè®©ç¼–è¯‘å™¨æ‰§æ³•çš„åšæ³•ã€‚</p></blockquote><p>This brings us to the â€œpackage by componentâ€ option. Itâ€™s a hybrid approach to everything weâ€™ve seen so far, with the goal of bundling all of the responsibilities related to a single coarse-grained component into a single Java package. Itâ€™s about taking a service-centric view of a software system, which is something weâ€™re seeing with micro-service architectures as well. In the same way that ports and adapters treat the web as just another delivery mechanism, â€œpackage by componentâ€ keeps the user interface separate from these coarse-grained components. Figure 34.6 shows what the â€œview ordersâ€ use case might look like.</p><blockquote><p>é‚£ä¹ˆï¼Œçœ‹ä¸€ä¸‹â€œæŒ‰ç»„ä»¶å°è£…â€çš„åšæ³•ã€‚è¿™ç§åšæ³•æ··åˆäº†æˆ‘ä»¬ä¹‹å‰è®²çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œç›®æ ‡æ˜¯å°†ä¸€ä¸ªç²—ç²’åº¦ç»„ä»¶ç›¸å…³çš„æ‰€æœ‰ç±»æ”¾å…¥ä¸€ä¸ª Java åŒ…ä¸­ã€‚è¿™å°±åƒæ˜¯ä»¥ä¸€ç§é¢å‘æœåŠ¡çš„è§†è§’æ¥æ„å»ºè½¯ä»¶ç³»ç»Ÿï¼Œä¸å¾®æœåŠ¡æ¶æ„ç±»ä¼¼ã€‚è¿™é‡Œï¼Œå°±åƒç«¯å£å’Œé€‚é…å™¨æ¨¡å¼å°† Web è§†ä¸ºä¸€ç§äº¤ä»˜æ‰‹æ®µä¸€æ ·ï¼Œâ€œæŒ‰ç»„ä»¶å°è£…â€å°† U1 ä¸ç²—ç²’åº¦ç»„ä»¶åˆ†ç¦»ã€‚å›¾ 34.6 å±•ç¤ºäº†â€œæŸ¥çœ‹è®¢å•â€è¿™ä¸ªç”¨ä¾‹çš„è®¾è®¡å›¾ã€‚</p></blockquote><p>In essence, this approach bundles up the â€œbusiness logicâ€ and persistence code into a single thing, which Iâ€™m calling a â€œcomponent.â€ Uncle Bob presented his definition of â€œcomponentâ€ earlier in the book, saying:</p><blockquote><p>æ€»çš„æ¥è¯´ï¼Œè¿™ç§æ–¹å¼å°†â€œä¸šåŠ¡é€»è¾‘â€ä¸â€œæŒä¹…åŒ–ä»£ç â€åˆå¹¶åœ¨ä¸€èµ·ï¼Œç§°ä¸ºâ€œç»„ä»¶â€ï¼ŒBob å¤§å”åœ¨æœ¬ä¹¦ä¸­å¯¹â€œç»„ä»¶â€çš„å®šä¹‰å¦‚ä¸‹ï¼š</p></blockquote><p>Components are the units of deployment. They are the smallest entities that can be deployed as part of a system. In Java, they are jar files.</p><blockquote><p>ç»„ä»¶æ˜¯éƒ¨ç½²å•å…ƒã€‚ç»„ä»¶æ˜¯ç³»ç»Ÿä¸­èƒ½å¤Ÿéƒ¨ç½²çš„æœ€å°å•ä½ï¼Œå¯¹åº”åœ¨ Java é‡Œå°±æ˜¯ jar æ–‡ä»¶ã€‚</p></blockquote><!----><p>My definition of a component is slightly different: â€œA grouping of related functionality behind a nice clean interface, which resides inside an execution environment like an application.â€ This definition comes from my â€œC4 software architecture model,â€7 which is a simple hierarchical way to think about the static structures of a software system in terms of containers, components, and classes (or code). It says that a software system is made up of one or more containers (e.g., web applications, mobile apps, stand-alone applications, databases, file systems), each of which contains one or more components, which in turn are implemented by one or more classes (or code). Whether each component resides in a separate jar file is an orthogonal concern.</p><blockquote><p>æˆ‘å¯¹ç»„ä»¶çš„å®šä¹‰ç¨æœ‰ä¸åŒï¼šâ€œåœ¨ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼ˆåº”å·ç¨‹åºï¼‰ä¸­çš„ã€ä¸€ä¸ªå¹²å‡€ã€è‰¯å¥½çš„æ¥å£èƒŒåçš„ä¸€ç³»åˆ—ç›¸å…³åŠŸèƒ½çš„é›†åˆâ€ã€‚è¿™ä¸ªå®šä¹‰æ¥è‡ªæˆ‘çš„â€œC4 è½¯ä»¶æ¶æ„æ¨¡å‹&quot; è¿™ä¸ªæ¨¡é‡Œä»¥ä¸€ç§å±‚çº§æ¨¡å‹è®¨è®ºè½¯ä»¶ç³»ç»Ÿçš„é™æ€ç»“æ„ï¼Œå…¶ä¸­çš„æ¦‚å¿µåŒ…æ‹¬å®¹å™¨ã€ç»†ä»¶ã€ç±»ã€‚è¿™ä¸ªæ¨¡å‹è®¤ä¸ºï¼Œç³»ç»Ÿç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ç»„æˆï¼ˆä¾‹ å¦‚ Web åº”ç”¨ã€ç§»åŠ¨ Appã€ç‹¬ç«‹åº”ç”¨ã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œæ¯ä¸ªå®¹å™¨åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç±»ç»„æˆã€‚æ¯ä¸ªç»„ä»¶å…·ä½“å­˜åœ¨äºå“ªä¸ª jar æ–‡ä»¶ä¸­åˆ™æ˜¯å¦å¤–ä¸€ä¸ªç»´åº¦çš„äº‹æƒ…ã€‚</p></blockquote><p>A key benefit of the â€œpackage by componentâ€ approach is that if youâ€™re writing code that needs to do something with orders, thereâ€™s just one place to goâ€”the OrdersComponent. Inside the component, the separation of concerns is still maintained, so the business logic is separate from data persistence, but thatâ€™s a component implementation detail that consumers donâ€™t need to know about. This is akin to what you might end up with if you adopted a micro-services or Service-Oriented Architectureâ€”a separate OrdersService that encapsulates everything related to handling orders. The key difference is the decoupling mode. You can think of well-defined components in a monolithic application as being a stepping stone to a micro-services architecture.</p><blockquote><p>è¿™ç§â€œæŒ‰ç»„ä»¶å°è£…â€çš„æ–¹å¼çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç¼–å†™å’Œè®¢å•æœ‰å…³çš„ä»£ç ï¼Œåªæœ‰ä¸€ä¸ªä½ç½®éœ€è¦ä¿®æ”¹ OrdersComponetã€‚åœ¨è¿™ä¸ªç»„ä»¶ä¸­ï¼Œä»ç„¶åº”è¯¥å…³æ³¨é‡ç‚¹éš”ç¦»åŸåˆ™ï¼Œä½†è¿™æ˜¯ç»„ä»¶å†…éƒ¨|å¯é¢˜ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å…³å¿ƒã€‚è¿™å°±æœ‰ç‚¹åƒé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæˆ–è€…æ˜¯é¢å‘æœåŠ¡æ¶æ„çš„ç»“æœâ€”â€”ç‹¬ç«‹çš„ Orderservice ä¼šå°†æ‰€æœ‰è®¢å•ç›¸å…³çš„ä¸œè¥¿å°è£…èµ·æ¥ã€‚è¿™é‡Œå…³é”®çš„åŒºåˆ«æ˜¯è§£è€¦çš„æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œå•ä½“ç¨‹åºä¸­çš„ä¸€ä¸ªè‰¯å¥½å®šä¹‰çš„ç»„ä»¶ï¼Œæ˜¯å¾®æœåŠ¡åŒ–æ¶æ„çš„ä¸€ä¸ªå‰ææ¡ä»¶ã€‚</p></blockquote><h2 id="the-devil-is-in-the-implementation-details-å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±" tabindex="-1"><a class="header-anchor" href="#the-devil-is-in-the-implementation-details-å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±" aria-hidden="true">#</a> THE DEVIL IS IN THE IMPLEMENTATION DETAILS å…·ä½“å®ç°ç»†èŠ‚ä¸­çš„é™·é˜±</h2><p>On the face of it, the four approaches do all look like different ways to organize code and, therefore, could be considered different architectural styles. This perception starts to unravel very quickly if you get the implementation details wrong, though.</p><blockquote><p>è¡¨é¢ä¸Šçœ‹ï¼Œå››ç§ä»£ç ç»„ç»‡æ–¹å¼å„ä¸ç›¸åŒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸åŒçš„æ¶æ„è®¾è®¡é£æ ¼ã€‚å¯æ˜¯ï¼Œå¦‚æœå…·ä½“å®ç°ä¸­ä¸ä¸¥åŠ æ³¨æ„ï¼Œå¾ˆå¿«å°±ä¼šå‡ºç°åå·®ã€‚</p></blockquote><p>Something I see on a regular basis is an overly liberal use of the public access modifier in languages such as Java. Itâ€™s almost as if we, as developers, instinctively use the public keyword without thinking. Itâ€™s in our muscle memory. If you donâ€™t believe me, take a look at the code samples for books, tutorials, and open source frameworks on GitHub. This tendency is apparent, regardless of which architectural style a code base is aiming to adoptâ€”horizontal layers, vertical layers, ports and adapters, or something else. Marking all of your types as public means youâ€™re not taking advantage of the facilities that your programming language provides with regard to encapsulation. In some cases, thereâ€™s literally nothing preventing somebody from writing some code to instantiate a concrete implementation class directly, violating the intended architecture style.</p><blockquote><p>æˆ‘ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒJava ä¸­ public è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦çš„æ»¥ç”¨ã€‚æˆ‘ä»¬ä½œä¸ºç¨‹åºå‘˜ï¼Œå¥½åƒå¤©ç”Ÿå°±å–œæ¬¢ä½¿ç”¨ä¸¥ public å…³é”®è¯ã€‚è¿™å°±å¥½åƒæ˜¯è‚Œè‚‰è®°å¿†ä¸€æ ·ã€‚å¦‚æœä¸ä¿¡ï¼Œè¯·çœ‹ä¸€ä¸‹å„ç§ä¹¦ç±çš„ä»£ç ç¤ºèŒƒã€å„ç§å…¥é—¨æ•™ç¨‹ï¼Œä»¥åŠ GitHub ä¸Šçš„å¼€æºæ¡†æ¶ã€‚è¿™ä¸ªè¶‹åŠ¿æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä¸ç®¡é‡‡ç”¨äº†å“ªç§ç³»ç»Ÿæ¶æ„é£æ ¼ã€‚å°†æ‰€æœ‰çš„ç±»éƒ½è®¾ç½®ä¸º public æ„å‘³ç€å°±æ— æ³•åˆ©ç”¨ç¼–ç¨‹è¯­è¨€æä¾›çš„å°è£…æ‰‹æ®µã€‚è¿™æ ·ä¸€æ¥ï¼Œæ²¡æœ‰ä»»ä½•ä¸œè¥¿å¯ä»¥é˜»ç¢æŸäººå†™ä¸€æ®µç›´æ¥åˆå§‹åŒ–å…·ä½“å®ç°ç±»çš„ä»£ç ï¼Œå“ªæ€•å®ƒè¿åäº†æ¶æ„è®¾è®¡çš„è¦æ±‚ã€‚</p></blockquote><h2 id="organization-versus-encapsulation-ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#organization-versus-encapsulation-ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«" aria-hidden="true">#</a> ORGANIZATION VERSUS ENCAPSULATION ç»„ç»‡å½¢å¼ä¸å°è£…çš„åŒºåˆ«</h2><p>Looking at this issue another way, if you make all types in your Java application public, the packages are simply an organization mechanism (a grouping, like folders), rather than being used for encapsulation. Since public types can be used from anywhere in a code base, you can effectively ignore the packages because they provide very little real value. The net result is that if you ignore the packages (because they donâ€™t provide any means of encapsulation and hiding), it doesnâ€™t really matter which architectural style youâ€™re aspiring to create. If we look back at the example UML diagrams, the Java packages become an irrelevant detail if all of the types are marked as public. In essence, all four architectural approaches presented earlier in this chapter are exactly the same when we overuse this designation (Figure 34.7).</p><blockquote><p>ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œå¦‚æœæˆ‘ä»¬å°† Java ç¨‹åºä¸­çš„æ‰€æœ‰ç±»å‹éƒ½è®¾ç½®ä¸º publicï¼Œé‚£ä¹ˆåŒ…å°±ä»…ä»…æ˜¯ä¸€ç§ç»„ç»‡å½¢å¼äº†ï¼ˆç±»ä¼¼æ–‡ä»¶å¤¹ä¸€æ ·çš„åˆ†ç»„æ–¹å¼ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ç§å°è£…æ–¹å¼ï¼Œç”±äº public ç±»å‹å¯ä»¥åœ¨ä»£ç åº“çš„ä»»ä½•ä½ç½®è°ƒç”¨ï¼Œæˆ‘ä»¬äº‹å®ä¸Šå°±å¯ä»¥å¿½ç•¥åŒ…çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒå¹¶ä¸æä¾›ä»€ä¹ˆä»·å€¼ã€‚æœ€ç»ˆï¼Œå¦‚æœå¿½è§†åŒ…çš„æ¦‚å¿µï¼ˆå› ä¸ºå¹¶ä¸èµ·åˆ°ä»»ä½•å°è£…å’Œéšè—çš„åŠŸèƒ½ï¼‰ï¼Œé‚£ä¹ˆæƒ³è¦é‡‡ç”¨çš„ä»»ä½•æ¶æ„é£æ ¼å°±éƒ½ä¸é‡è¦äº†ã€‚æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹ä¾‹å­ä¸­çš„ UML å›¾ï¼Œå¦‚æœæ‰€æœ‰çš„ç±»å‹éƒ½æ˜¯ publicï¼Œé‚£ä¹ˆ Java åŒ…å°±æˆäº†ä¸€ä¸ªæ— å…³ç´§è¦çš„ç»†èŠ‚ä¿¡æ¯ã€‚äºæ˜¯ï¼Œæ‰€æœ‰å››ç§æ¶æ„æ–¹å¼äº‹å®ä¸Šå¹¶æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼ˆå‚è§å›¾ 34.7ï¼‰ã€‚</p></blockquote><p>Take a close look at the arrows between each of the types in Figure 34.7: Theyâ€™re all identical regardless of which architectural approach youâ€™re trying to adopt. Conceptually the approaches are very different, but syntactically they are identical. Furthermore, you could argue that when you make all of the types public, what you really have are just four ways to describe a traditional horizontally layered architecture. This is a neat trick, and of course nobody would ever make all of their Java types public. Except when they do. And Iâ€™ve seen it.</p><blockquote><p>æˆ‘ä»¬å†è¯¦ç»†çœ‹ä¸€ä¸‹å›¾ 34.7 ä¸­å„ä¸ªç±»ä¹‹é—´çš„ç®­å¤´ï¼šä¸è®ºé‡‡ç”¨å“ªç§æ¶æ„è®¾è®¡é£æ ¼ï¼Œå®ƒä»¬çš„æŒ‡å‘éƒ½æ˜¯ä¸€è‡´çš„ã€‚è™½ç„¶æ¦‚å¿µä¸åŒï¼Œä½†æ˜¯è¯­æ³•ä¸Šéƒ½æ˜¯ä¸€è‡´çš„ã€‚æ›´è¿›ä¸€æ­¥è¯´ï¼Œå¦‚æœæ‰€æœ‰çš„ç±»éƒ½æ˜¯ public çš„ï¼Œé‚£ä¹ˆå…¶å®æˆ‘ä»¬å°±æ˜¯åœ¨ç”¨å››ç§ä¸åŒçš„æ–¹å¼æè¿°ä¸€ä¸ªä¼ ç»Ÿçš„åˆ†å±‚æ¶æ„è®¾è®¡æ–¹å¼ã€‚ä½ ä¼šè¯´å½“ç„¶æ²¡æœ‰äººä¼šå°†æ‰€æœ‰çš„ Java ç±»éƒ½è®¾ç½®ä¸º publicï¼Œä½†æ˜¯ç›¸ä¿¡æˆ‘ï¼Œæˆ‘è§è¿‡ã€‚</p></blockquote><p>The access modifiers in Java are not perfect,8 but ignoring them is just asking for trouble. The way Java types are placed into packages can actually make a huge difference to how accessible (or inaccessible) those types can be when Javaâ€™s access modifiers are applied appropriately. If I bring the packages back and mark (by graphically fading) those types where the access modifier can be made more restrictive, the picture becomes pretty interesting (Figure 34.8).</p><blockquote><p>è™½ç„¶ Java ä¸­çš„è®¿é—®ä¿®é¥°ç¬¦å¹¶ä¸å®Œç¾ï¼Œä½†æ˜¯å¿½ç•¥å®ƒä»¬çš„å­˜å­˜å°±æ˜¯åœ¨è‡ªæ‰¾éº»çƒ¦ã€‚Java ç±»ä¸åŒ…çš„ç»„ç»‡å½¢å¼å…¶å®å¯ä»¥å¾ˆå¤§ç¨‹åº¦å†³å®šè¿™ä¸ªç±»çš„å¯è®¿é—®æ€§ï¼ˆæˆ–è€…ä¸å¯è®¿é—®æ€§ï¼‰ã€‚å¦‚æœæˆ‘ä»¬å°†åŒ…çš„æ¦‚å¿µå¼•å…¥è¿™å¹…å›¾ï¼ŒåŒæ—¶æ ‡è®°ï¼ˆè™šåŒ–çš„å½¢å¼å±•ç¤ºï¼‰åº”ç”¨åˆ°è®¿é—®æ§åˆ¶ç¬¦çš„åœ°æ–¹ï¼Œè¿™ä¸ªå›¾å°±å¾ˆæœ‰æ„æ€äº†ï¼ˆå‚è§å›¾ 34.8ï¼‰ã€‚</p></blockquote><!----><p>Moving from left to right, in the â€œpackage by layerâ€ approach, the OrdersService and OrdersRepository interfaces need to be public, because they have inbound dependencies from classes outside of their defining package. In contrast, the implementation classes (OrdersServiceImpl and JdbcOrdersRepository) can be made more restrictive (package protected). Nobody needs to know about them; they are an implementation detail.</p><blockquote><p>ä»å·¦å‘å³ï¼Œåœ¨ â€œæŒ‰å±‚å°è£…â€æ–¹å¼ä¸­ï¼ŒOrderService ä¸ OrderRepository éœ€è¦ public ä¿®é¥°ç¬¦ï¼Œå› ä¸ºåŒ…å¤–çš„ç±»éœ€è¦ä¾èµ–å®ƒä»¬ã€‚ç„¶è€Œï¼Œå…·ä½“å®ç°ç±»ï¼ˆOrderServicelmpl å’Œ JdbcOrdersRepositoryï¼‰åˆ™å¯ä»¥è®¾ç½®æ›´ç»†è‡´çš„è®¿é—®æƒé™ï¼ˆåŒ…èŒƒå›´å†…çš„ protectedï¼‰ã€‚ä¸éœ€è¦æœ‰äººä¾èµ–å®ƒä»¬ï¼Œå®ƒä»¬æ˜¯å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚</p></blockquote><p>In the â€œpackage by featureâ€ approach, the OrdersController provides the sole entry point into the package, so everything else can be made package protected. The big caveat here is that nothing else in the code base, outside of this package, can access information related to orders unless they go through the controller. This may or may not be desirable.</p><blockquote><p>åœ¨â€œæŒ‰åŠŸèƒ½å°è£…â€æ¨¡å¼ä¸­ï¼ŒOrdersController æ˜¯æ•´ä¸ªåŒ…çš„å…¥å£ï¼Œæ‰€ä»¥å…¶ä»–çš„ç±»éƒ½å¯ä»¥è®¾ç½®ä¸ºåŒ…èŒƒå›´å†…çš„ protectedã€‚è¿™é‡Œçš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä»£ç åº“ä¸­çš„å…¶ä»–ä»£ç éƒ½å¿…é¡»é€šè¿‡æ§åˆ¶å™¨æ‰èƒ½è®¿é—®è®¢å•ä¿¡æ¯â€”â€”è¿™å¯èƒ½æ˜¯å¥½å¤„ï¼Œä¹Ÿå¯èƒ½æ˜¯åå¤„ï¼Œè§†å®é™…æƒ…å†µè€Œå®šã€‚</p></blockquote><p>In the ports and adapters approach, the OrdersService and Orders interfaces have inbound dependencies from other packages, so they need to be made public. Again, the implementation classes can be made package protected and dependency injected at runtime.</p><blockquote><p>åœ¨ç«¯å£ä¸é€‚é…å™¨æ¨¡å¼ä¸­ï¼ŒOrderService ä¸ Orders æ¥å£éƒ½æœ‰æ¥è‡ªåŒ…å¤–çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥éœ€è¦ public ä¿®é¥°ç¬¦ã€‚åŒæ ·ï¼Œå®ç°ç±»å¯ä»¥è®¾ç½®ä¸ºåŒ…èŒƒå›´å†… protectedï¼Œä¾èµ–åœ¨è¿è¡Œæ—¶æ³¨å…¥ã€‚</p></blockquote><!----><p>Finally, in the â€œpackage by componentâ€ approach, the OrdersComponent interface has an inbound dependency from the controller, but everything else can be made package protected. The fewer public types you have, the smaller the number of potential dependencies. Thereâ€™s now no way9 that code outside this package can use the OrdersRepository interface or implementation directly, so we can rely on the compiler to enforce this architectural principle. You can do the same thing in .NET with the internal keyword, although you would need to create a separate assembly for every component.</p><blockquote><p>æœ€åã€åœ¨â€œç»„ä»¶â€å°è£…æ¨¡å¼ä¸­ï¼ŒOrdersComponet æ¥å£æœ‰æ¥è‡ª Controller çš„ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯å…¶ä»–ç±»éƒ½å¯ä»¥è®¾ç½®ä¸ºåŒ… protectedã€‚Public ç±»å‹è¶Šå°‘ï¼Œæ½œåœ¨çš„ä¾èµ–å…³ç³»å°±è¶Šå°‘ã€‚ç°åœ¨åŒ…å¤–ä»£ç å°±ä¸èƒ½å†ç›´æ¥ä½¿ç”¨ OrdersRepository æ¥å£æˆ–è€…å…·å¯¹åº”çš„å®ç°ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ç¼–è¯‘å™¨æ¥ç»´æŠ¤æ¶æ„è®¾è®¡åŸåˆ™äº†ã€‚åœ¨ .Net è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ internal å…³é”®è¯è¾¾åˆ°ä¸€æ ·çš„ç›®çš„ï¼Œç„¶è€Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªç»„ä»¶åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ assemblyã€‚</p></blockquote><p>Just to be absolutely clear, what Iâ€™ve described here relates to a monolithic application, where all of the code resides in a single source code tree. If you are building such an application (and many people are), I would certainly encourage you to lean on the compiler to enforce your architectural principles, rather than relying on self-discipline and post-compilation tooling.</p><blockquote><p>å†æ¾„æ¸…ä¸€ç‚¹ï¼Œè¿™é‡Œæè¿°çš„å…¨éƒ½å’Œå•ä½“ç¨‹åºæœ‰å…³ï¼Œæ‰€æœ‰ä»£ç éƒ½å­˜æ”¾åœ¨åŒä¸€ä¸ªä»£ç æ ‘ä¸‹ã€‚å¦‚æœä½ åœ¨æ„å»ºè¿™ç§ç¨‹åºï¼ˆå¤§éƒ¨åˆ†ç¨‹åºéƒ½æ˜¯å¦‚æ­¤ï¼‰ï¼Œé‚£ä¹ˆæˆ‘å¼ºçƒˆå»ºè®®åˆ©ç”¨ç¼–è¯‘å™¨æ¥ç»´æŠ¤æ¶æ„è®¾è®¡åŸç†ï¼Œè€Œä¸è¦ä¾èµ–ä¸ªäººè‡ªå¾‹å’Œç¼–è¯‘è¿‡ç¨‹ä¹‹åçš„å·¥å…·ã€‚</p></blockquote><h2 id="other-decoupling-modes-å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#other-decoupling-modes-å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼" aria-hidden="true">#</a> OTHER DECOUPLING MODES å…¶ä»–çš„è§£è€¦åˆæ¨¡å¼</h2><p>In addition to the programming language youâ€™re using, there are often other ways that you can decouple your source code dependencies. With Java, you have module frameworks like OSGi and the new Java 9 module system. With module systems, when used properly, you can make a distinction between types that are public and types that are published. For example, you could create an Orders module where all of the types are marked as public, but publish only a small subset of those types for external consumption. Itâ€™s been a long time coming, but Iâ€™m enthusiastic that the Java 9 module system will give us another tool to build better software, and spark peopleâ€™s interest in design thinking once again.</p><blockquote><p>é™¤ç¼–ç¨‹è¯­è¨€è‡ªå¸¦çš„å·¥å…·ä¹‹å¤–ï¼Œé€šå¸¸è¿˜æœ‰å…¶ä»–æ–¹å¼å¯ä»¥è¿›ä¸€æ­¥è§£è€¦æºä»£ç çº§åˆ«çš„ä¾èµ–å…³ç³»ã€‚åœ¨ Java è¯­è¨€ä¸­ï¼Œæœ‰æ¨¡å—åŒ–æ¡†æ¶ OSGiï¼Œä»¥åŠæœ€æ–°çš„ Java 9 æ¨¡å—ç³»ç»Ÿã€‚æ­£ç¡®åˆ©ç”¨æ¨¡å—ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥åŒºåˆ† public ç±»å‹å’Œå¯¹å¤–å‘å¸ƒçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª Orders æ¨¡å—ã€‚å°†æ‰€æœ‰çš„ç±»å‹æ ‡è®°ä¸º publicï¼Œä½†ä»…ä»…å…¬å¸ƒä¸€å°éƒ¨åˆ†ç±»ä¾›å¤–éƒ¨è°ƒç”¨ã€‚è™½ç„¶è€—æ—¶å¾ˆä¹…ï¼Œä½†æ˜¯æˆ‘ååˆ†æœŸå¾… Java 9 çš„æ¨¡å—ç³»ç»Ÿï¼Œå®ƒèƒ½æä¾›æ„å»ºæ›´å¥½è½¯ä»¶çš„å¦ä¸€å¥—å·¥å…·ï¼Œå¸Œæœ›èƒ½å¤Ÿå†æ¬¡ç‚¹ç‡ƒäººä»¬æ€è€ƒè®¾è®¡çš„çƒ­æƒ…ã€‚</p></blockquote><p>Another option is to decouple your dependencies at the source code level, by splitting code across different source code trees. If we take the ports and adapters example, we could have three source code trees:</p><blockquote><p>å¦å¤–ä¸€ä¸ªé€‰æ‹©æ˜¯å°†ä»£ç åˆ†æ•£åˆ°ä¸åŒçš„ä»£ç æ ‘ä¸­ï¼Œä»¥ä»æºä»£ç çº§åˆ«è§£è€¦ä¾èµ–å…³ç³»ã€‚ä»¥ç«¯å£å’Œé€‚é…å™¨æ–¹å¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸‰ä¸ªä»£ç æ ‘ï¼š</p></blockquote><ul><li>The source code for the business and domain (i.e., everything that is independent of technology and framework choices): OrdersService, OrdersServiceImpl, and Orders</li><li>The source code for the web: OrdersController</li><li>The source code for the data persistence: JdbcOrdersRepository</li></ul><hr><blockquote><ul><li>ä¸šåŠ¡ä»£ç ï¼ˆæ‰€æœ‰æŠ€æœ¯å’Œæ¡†æ¶æ— å…³çš„ä»£ç ï¼‰ï¼šOrdersServiceã€OrdersServiceImpl ä»¥åŠ Ordersã€‚</li><li>Web æºä»£ç ï¼šOrdersControllerã€‚</li><li>æŒä¹…åŒ–æºä»£ç ï¼šJdbcOrdersRepositoryã€‚</li></ul></blockquote><p>The latter two source code trees have a compile-time dependency on the business and domain code, which itself doesnâ€™t know anything about the web or the data persistence code. From an implementation perspective, you can do this by configuring separate modules or projects in your build tool (e.g., Maven, Gradle, MSBuild). Ideally you would repeat this pattern, having a separate source code tree for each and every component in your application. This is very much an idealistic solution, though, because there are real-world performance, complexity, and maintenance issues associated with breaking up your source code in this way.</p><blockquote><p>åé¢ä¸¤ä¸ªæºä»£ç æ ‘å¯¹ä¸šåŠ¡ä»£ç æœ‰ç¼–è¯‘æœŸä¾èµ–å…³ç³»ï¼Œè€Œä¸šåŠ¡ä»£ç åˆ™å¯¹ Web å’Œæ•°æ®æŒä¹…æ¯«æ— æ‰€çŸ¥ã€‚ä»å®ç°è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¿™äº›ä»£ç åœ¨æ„å»ºå·¥å…·ä¸­ç»„ç»‡æˆä¸åŒçš„æ¨¡å—æˆ–è€…é¡¹ç›®ï¼ˆä¾‹å¦‚ Maven&gt; Gradle&gt; MSBUILD ç­‰ï¼‰æ¥è¾¾åˆ°ç›®çš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ç§æ¨¡å¼å°†æ‰€æœ‰ç»„ä»¶éƒ½åˆ’åˆ†æˆä¸åŒçš„é¡¹ç›®ã€‚ç„¶è€Œï¼Œè¿™æœ‰ç‚¹å¤ªç†æƒ³åŒ–äº†ï¼Œå› ä¸ºæ‹†åˆ†ä»£ç åº“ç»å¸¸ä¼šå¸¦æ¥æ€§èƒ½ã€å¤æ‚åº¦å’Œç»´æŠ¤æ€§æ–¹é¢çš„é—®é¢˜ã€‚</p></blockquote><p>A simpler approach that some people follow for their ports and adapters code is to have just two source code trees:</p><blockquote><p>æœ‰äº›äººé‡‡ç”¨ä¸€ä¸ªç¨å¾®ç®€å•çš„ç»„ç»‡æ–¹å¼ï¼Œä»…ä½¿ç”¨ä¸¤ä¸ªä»£ç æ ‘ï¼š</p></blockquote><ul><li>Domain code (the â€œinsideâ€)</li><li>Infrastructure code (the â€œoutsideâ€)</li></ul><hr><blockquote><ul><li>ä¸šåŠ¡ï¼ˆDomainï¼‰ä»£ç ï¼ˆå†…éƒ¨ï¼‰</li><li>åŸºç¡€è®¾æ–½ï¼ˆInfrastructureï¼‰ä»£ç ï¼ˆå¤–éƒ¨ï¼‰</li></ul></blockquote><p>This maps on nicely to the diagram (Figure 34.9) that many people use to summarize the ports and adapters architecture, and there is a compile-time dependency from the infrastructure to the domain.</p><blockquote><p>è¿™ä¸å›¾ 34.9 å®Œç¾å¯¹åº”ï¼Œå¾ˆå¤šäººéƒ½ç”¨è¿™ä¸ªæ–¹å¼æ¥ç®€åŒ–å¯¹ç«¯å£å’Œé€‚é…å™¨æ¶æ„çš„æè¿°ã€‚åŸºç¡€è®¾æ–½éƒ¨åˆ†å¯¹ä¸šåŠ¡ä»£ç æœ‰ä¸€ä¸ªç¼–è¯‘æœŸçš„ä¾èµ–å…³ç³»ã€‚</p></blockquote><!----><p>This approach to organizing source code will also work, but be aware of the potential trade-off. Itâ€™s what I call the â€œPÃ©riphÃ©rique anti-pattern of ports and adapters.â€ The city of Paris, France, has a ring road called the Boulevard PÃ©riphÃ©rique, which allows you to circumnavigate Paris without entering the complexities of the city. Having all of your infrastructure code in a single source code tree means that itâ€™s potentially possible for infrastructure code in one area of your application (e.g., a web controller) to directly call code in another area of your application (e.g., a database repository), without navigating through the domain. This is especially true if youâ€™ve forgotten to apply appropriate access modifiers to that code.</p><blockquote><p>è¿™ç§ä»£ç ç»„ç»‡æ–¹å¼æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯éœ€è¦é¢å¤–æ³¨æ„éšä¹‹è€Œæ¥çš„é—®é¢˜ã€‚æˆ‘ç§°è¿™ä¸ªé—®é¢˜ä¸ºâ€œç«¯å£ä¸é€‚é…å™¨æ¨¡å¼ä¸­çš„ Peripherique åæ¨¡å¼â€ã€‚æ³•å›½å·´é»æœ‰ä¸€æ¡ç¯å½¢å…¬è·¯ï¼Œåå­—æ˜¯ Peripherique å¤§é“ã€‚è¿™æ¡å¤§é“å…è®¸è½¦è¾†ç¯ç»•å·´é»è€Œä¸éœ€è¦è¿›å…¥ç¤¾åŒºã€‚åŒæ ·çš„ï¼Œå°†æ‰€æœ‰çš„åŸºç¡€è®¾æ–½ä»£ç æ”¾åœ¨åŒä¸€ä¸ªæºä»£ç æ ‘ä¸­ï¼Œå°±æœ‰å¯èƒ½ä½¿å¾—åº”ç”¨ä¸­çš„ä¸€ä¸ªåŒºåŸŸçš„åŸºç¡€è®¾æ–½ä»£ç ï¼ˆWeb æ§åˆ¶å™¨ï¼‰ç›´æ¥è°ƒç”¨å¦å¤–ä¸€ä¸ªåŒºåŸŸçš„ä»£ç ï¼ˆæ•°æ®åº“è®¿é—®ï¼‰ï¼Œè€Œä¸ç»è¿‡é¢†åŸŸä»£ç ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®æ­£ç¡®çš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œå°±æ›´æ˜¯å¦‚æ­¤äº†ã€‚</p></blockquote><h2 id="conclusion-the-missing-advice-æœ¬ç« å°ç»“-æœ¬ä¹¦æ‹¾é—" tabindex="-1"><a class="header-anchor" href="#conclusion-the-missing-advice-æœ¬ç« å°ç»“-æœ¬ä¹¦æ‹¾é—" aria-hidden="true">#</a> CONCLUSION: THE MISSING ADVICE æœ¬ç« å°ç»“ï¼šæœ¬ä¹¦æ‹¾é—</h2><p>The whole point of this chapter is to highlight that your best design intentions can be destroyed in a flash if you donâ€™t consider the intricacies of the implementation strategy. Think about how to map your desired design on to code structures, how to organize that code, and which decoupling modes to apply during runtime and compile-time. Leave options open where applicable, but be pragmatic, and take into consideration the size of your team, their skill level, and the complexity of the solution in conjunction with your time and budgetary constraints. Also think about using your compiler to help you enforce your chosen architectural style, and watch out for coupling in other areas, such as data models. The devil is in the implementation details.</p><blockquote><p>è¿™ä¸€ç« çš„ä¸­å¿ƒæ€æƒ³å°±æ˜¯ï¼Œå¦‚æœä¸è€ƒè™‘å…·ä½“å®ç°ç»†èŠ‚ï¼Œå†å¥½çš„è®¾è®¡ä¹Ÿæ— æ³•é•¿ä¹…ã€‚å¿…é¡»è¦å°†è®¾è®¡æ˜ å°„åˆ°å¯¹åº”çš„ä»£ç ç»“æ„ä¸Šï¼Œè€ƒè™‘å¦‚ä½•ç»„ç»‡ä»£ç æ ‘ï¼Œä»¥åŠåœ¨ç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸé‡‡ç”¨å“ªç§è§£è€¦åˆçš„æ¨¡å¼ã€‚ä¿æŒå¼€æ”¾ï¼Œä½†æ˜¯ä¸€å®šè¦åŠ¡å®ï¼ŒåŒæ—¶è¦è€ƒè™‘åˆ°å›¢é˜Ÿçš„å¤§å°ã€æŠ€æœ¯æ°´å¹³ï¼Œä»¥åŠå¯¹åº”çš„æ—¶é—´å’Œé¢„ç®—é™åˆ¶ã€‚æœ€å¥½èƒ½åˆ©ç”¨ç¼–è¯‘å™¨æ¥ç»´æŠ¤æ‰€é€‰çš„ç³»ç»Ÿæ¶æ„è®¾è®¡é£æ ¼ï¼Œå°å¿ƒé˜²èŒƒæ¥è‡ªå…¶ä»–åœ°æ–¹çš„è€¦åˆæ¨¡å¼ï¼Œä¾‹å¦‚æ•°æ®ç»“æ„ã€‚æ‰€æœ‰çš„å®ç°ç»†èŠ‚éƒ½æ˜¯å…³é”®çš„ï¼</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/windily-cloud/obsidian-publish/edit/main/Publish/Publish/Clean Archtechture/ch34.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/9/20 11:11:04</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: wwww.4399li@qq.com">windilycloud</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch33.html" class="nav-link prev" aria-label="ch33.md"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-file"></span>ch33.md</div></a><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link next" aria-label="ch4.md"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">ch4.md<span class="icon iconfont icon-file"></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">ä»€ä¹ˆæ˜¯å¹¸è¤”ï¼Ÿ å¹¸ç¦å°±æ˜¯çŒ«åƒé±¼ç‹—åƒè‚‰ï¼Œå¥¥ç‰¹æ›¼æ‰“å°æ€ªå…½ï¼</div><div class="copyright">Copyright Â© 2022 Windily-Cloud</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/obsidian-publish/assets/app.887b133c.js" defer></script>
  </body>
</html>
