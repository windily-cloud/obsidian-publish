<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://windily-cloud.github.io/obsidian-publish/Publish/Clean%20Archtechture/ch25.html"><meta property="og:site_name" content="Windily Cloud"><meta property="og:title" content="Chap25. LAYERS AND BOUNDARIES 层次与边界"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-09-20T11:11:04.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-09-20T11:11:04.000Z"><title>Chap25. LAYERS AND BOUNDARIES 层次与边界 | Windily Cloud</title><meta name="description" content="Windily Cloud's Blog">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/obsidian-publish/assets/style.12da8f21.css">
    <link rel="modulepreload" href="/obsidian-publish/assets/app.887b133c.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch25.html.a6d9e7e0.js"><link rel="modulepreload" href="/obsidian-publish/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/obsidian-publish/assets/ch25.html.cdcf732e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c7e76e53.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.f01af163.js"><link rel="prefetch" href="/obsidian-publish/assets/导航.html.d24325cb.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.fc3247cd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.279a3dae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.ad67b7a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.74f49c94.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.7b8b868f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.0897d88d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.871f1a29.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.9cf7c1a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.1ee0e012.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.b2dc5528.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.d50b6029.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.f9083031.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.a8daed86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.f712f0c4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.008de7bb.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.bc3946ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.dcd080ee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.4bd6fad0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.5af7f550.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.d56c6b1b.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.1d0c5f03.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.a9585c5e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.7898d2ef.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.4e106aa0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.efd82950.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.054b22ad.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.25d75f30.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.058b06f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.61d3f411.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.a6691c1e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.326ac1a0.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.b00c3f6a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.4e35799e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.f553bf58.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.1abe47e0.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.61a30e56.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.c688cf00.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.19a54833.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e97d623d.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.59f213ed.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.565d8d69.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidain文档导出的方法.html.8c97282e.js"><link rel="prefetch" href="/obsidian-publish/assets/笔记分类方法的思考.html.7a0981ad.js"><link rel="prefetch" href="/obsidian-publish/assets/杂话：从意识形态分析西方疫情.html.609d0549.js"><link rel="prefetch" href="/obsidian-publish/assets/读清政府是否应该修建铁路一文.html.0ce08377.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.cc115e5e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.60ae3ce2.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.c09081fd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.70634028.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.3b70efd7.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.f5a6049f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.d91b9c1f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.32852561.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0a68a710.js"><link rel="prefetch" href="/obsidian-publish/assets/home.html.93b7cca5.js"><link rel="prefetch" href="/obsidian-publish/assets/导航.html.a1c9d7de.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0da27cdd.js"><link rel="prefetch" href="/obsidian-publish/assets/afterword.html.b850d04a.js"><link rel="prefetch" href="/obsidian-publish/assets/ch1.html.5aa5f6f6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch10.html.413c371f.js"><link rel="prefetch" href="/obsidian-publish/assets/ch11.html.3cd7a242.js"><link rel="prefetch" href="/obsidian-publish/assets/ch12.html.175ce04d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch13.html.fc4a1701.js"><link rel="prefetch" href="/obsidian-publish/assets/ch14.html.199a9f38.js"><link rel="prefetch" href="/obsidian-publish/assets/ch15.html.5b8799e9.js"><link rel="prefetch" href="/obsidian-publish/assets/ch16.html.20b93b21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch17.html.165fc3da.js"><link rel="prefetch" href="/obsidian-publish/assets/ch18.html.4cd429e5.js"><link rel="prefetch" href="/obsidian-publish/assets/ch19.html.3e2d64e7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch2.html.384a9648.js"><link rel="prefetch" href="/obsidian-publish/assets/ch20.html.b1ad3804.js"><link rel="prefetch" href="/obsidian-publish/assets/ch21.html.58811bd6.js"><link rel="prefetch" href="/obsidian-publish/assets/ch22.html.44e934ae.js"><link rel="prefetch" href="/obsidian-publish/assets/ch23.html.d77e680e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch24.html.79a8927d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch26.html.c53b41bf.js"><link rel="prefetch" href="/obsidian-publish/assets/ch27.html.fdbedd86.js"><link rel="prefetch" href="/obsidian-publish/assets/ch28.html.8d17578d.js"><link rel="prefetch" href="/obsidian-publish/assets/ch29.html.69ad75a7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch3.html.ef8bfaee.js"><link rel="prefetch" href="/obsidian-publish/assets/ch30.html.d5d16d0e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch31.html.33b5c44c.js"><link rel="prefetch" href="/obsidian-publish/assets/ch32.html.6c12ea21.js"><link rel="prefetch" href="/obsidian-publish/assets/ch33.html.7adbcd24.js"><link rel="prefetch" href="/obsidian-publish/assets/ch34.html.c7a5cd99.js"><link rel="prefetch" href="/obsidian-publish/assets/ch4.html.f4b07606.js"><link rel="prefetch" href="/obsidian-publish/assets/ch5.html.0f2533d2.js"><link rel="prefetch" href="/obsidian-publish/assets/ch6.html.c64dc16e.js"><link rel="prefetch" href="/obsidian-publish/assets/ch7.html.d8f304e4.js"><link rel="prefetch" href="/obsidian-publish/assets/ch8.html.ac3dd3f7.js"><link rel="prefetch" href="/obsidian-publish/assets/ch9.html.e8bdc588.js"><link rel="prefetch" href="/obsidian-publish/assets/part1.html.f20e95e2.js"><link rel="prefetch" href="/obsidian-publish/assets/part2.html.46fb949d.js"><link rel="prefetch" href="/obsidian-publish/assets/part3.html.37fde797.js"><link rel="prefetch" href="/obsidian-publish/assets/part4.html.e291bbe5.js"><link rel="prefetch" href="/obsidian-publish/assets/part5.html.7deee47f.js"><link rel="prefetch" href="/obsidian-publish/assets/part6.html.6126ed62.js"><link rel="prefetch" href="/obsidian-publish/assets/obsidain文档导出的方法.html.f99ad030.js"><link rel="prefetch" href="/obsidian-publish/assets/笔记分类方法的思考.html.f2f4101a.js"><link rel="prefetch" href="/obsidian-publish/assets/杂话：从意识形态分析西方疫情.html.9eadd293.js"><link rel="prefetch" href="/obsidian-publish/assets/读清政府是否应该修建铁路一文.html.71c36bf1.js"><link rel="prefetch" href="/obsidian-publish/assets/404.html.24a96f75.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b76fc3f0.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.ba71ba2a.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.103ba7cd.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.7d4c0d5f.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.b1a4c497.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.0c6eca16.js"><link rel="prefetch" href="/obsidian-publish/assets/index.html.394348dd.js"><link rel="prefetch" href="/obsidian-publish/assets/auto.56c9cb2e.js"><link rel="prefetch" href="/obsidian-publish/assets/index.1f644ee1.js"><link rel="prefetch" href="/obsidian-publish/assets/flowchart.parse.1479ec3f.js"><link rel="prefetch" href="/obsidian-publish/assets/mermaid.esm.min.0e041931.js"><link rel="prefetch" href="/obsidian-publish/assets/highlight.esm.9b852bc5.js"><link rel="prefetch" href="/obsidian-publish/assets/markdown.esm.77e8db25.js"><link rel="prefetch" href="/obsidian-publish/assets/math.esm.cb9d4be3.js"><link rel="prefetch" href="/obsidian-publish/assets/notes.esm.62c5f19d.js"><link rel="prefetch" href="/obsidian-publish/assets/reveal.esm.41ec5d7f.js"><link rel="prefetch" href="/obsidian-publish/assets/search.esm.04894411.js"><link rel="prefetch" href="/obsidian-publish/assets/zoom.esm.78977eba.js"><link rel="prefetch" href="/obsidian-publish/assets/VuePlayground.3cfc7758.js"><link rel="prefetch" href="/obsidian-publish/assets/photoswipe.esm.f594e77b.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/obsidian-publish/" class="brand"><img class="logo" src="/obsidian-publish/logo.svg" alt="Windily Cloud"><!----><span class="site-name hide-in-pad">Windily Cloud</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/" class="nav-link" aria-label="博客主页"><span class="icon iconfont icon-home"></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/obsidian-publish/home.html" class="nav-link" aria-label="图谱"><span class="icon iconfont icon-home"></span>图谱<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="主题文档" class="nav-link"><span class="icon iconfont icon-note"></span>主题文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/windily-cloud/obsidian-publish" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><a href="/obsidian-publish/" class="title">Vault</a><!----></p><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">见闻</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-folder"></span><span class="title">Obsidian</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-folder"></span><span class="title">Clean Archtechture</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/" class="nav-link sidebar-link sidebar-page" aria-label="README.md"><span class="icon iconfont icon-file"></span>README.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/afterword.html" class="nav-link sidebar-link sidebar-page" aria-label="afterword.md"><span class="icon iconfont icon-file"></span>afterword.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch1.html" class="nav-link sidebar-link sidebar-page" aria-label="ch1.md"><span class="icon iconfont icon-file"></span>ch1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch10.html" class="nav-link sidebar-link sidebar-page" aria-label="ch10.md"><span class="icon iconfont icon-file"></span>ch10.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch11.html" class="nav-link sidebar-link sidebar-page" aria-label="ch11.md"><span class="icon iconfont icon-file"></span>ch11.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch12.html" class="nav-link sidebar-link sidebar-page" aria-label="ch12.md"><span class="icon iconfont icon-file"></span>ch12.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch13.html" class="nav-link sidebar-link sidebar-page" aria-label="ch13.md"><span class="icon iconfont icon-file"></span>ch13.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch14.html" class="nav-link sidebar-link sidebar-page" aria-label="ch14.md"><span class="icon iconfont icon-file"></span>ch14.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch15.html" class="nav-link sidebar-link sidebar-page" aria-label="ch15.md"><span class="icon iconfont icon-file"></span>ch15.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch16.html" class="nav-link sidebar-link sidebar-page" aria-label="ch16.md"><span class="icon iconfont icon-file"></span>ch16.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch17.html" class="nav-link sidebar-link sidebar-page" aria-label="ch17.md"><span class="icon iconfont icon-file"></span>ch17.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch18.html" class="nav-link sidebar-link sidebar-page" aria-label="ch18.md"><span class="icon iconfont icon-file"></span>ch18.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch19.html" class="nav-link sidebar-link sidebar-page" aria-label="ch19.md"><span class="icon iconfont icon-file"></span>ch19.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch2.html" class="nav-link sidebar-link sidebar-page" aria-label="ch2.md"><span class="icon iconfont icon-file"></span>ch2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch20.html" class="nav-link sidebar-link sidebar-page" aria-label="ch20.md"><span class="icon iconfont icon-file"></span>ch20.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch21.html" class="nav-link sidebar-link sidebar-page" aria-label="ch21.md"><span class="icon iconfont icon-file"></span>ch21.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch22.html" class="nav-link sidebar-link sidebar-page" aria-label="ch22.md"><span class="icon iconfont icon-file"></span>ch22.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch23.html" class="nav-link sidebar-link sidebar-page" aria-label="ch23.md"><span class="icon iconfont icon-file"></span>ch23.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch24.html" class="nav-link sidebar-link sidebar-page" aria-label="ch24.md"><span class="icon iconfont icon-file"></span>ch24.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ch25.md"><span class="icon iconfont icon-file"></span>ch25.md<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#hunt-the-wumpus-基于文本的冒险游戏-hunt-the-wumpus" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HUNT THE WUMPUS 基于文本的冒险游戏：Hunt The Wumpus"><!---->HUNT THE WUMPUS 基于文本的冒险游戏：Hunt The Wumpus<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#clean-architecture-可否采用整洁架构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CLEAN ARCHITECTURE? 可否采用整洁架构"><!---->CLEAN ARCHITECTURE? 可否采用整洁架构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#crossing-the-streams-交汇数据流" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CROSSING THE STREAMS 交汇数据流"><!---->CROSSING THE STREAMS 交汇数据流<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#splitting-the-streams-数据流的分割" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SPLITTING THE STREAMS 数据流的分割"><!---->SPLITTING THE STREAMS 数据流的分割<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#conclusion-本章小结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CONCLUSION 本章小结"><!---->CONCLUSION 本章小结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch26.html" class="nav-link sidebar-link sidebar-page" aria-label="ch26.md"><span class="icon iconfont icon-file"></span>ch26.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch27.html" class="nav-link sidebar-link sidebar-page" aria-label="ch27.md"><span class="icon iconfont icon-file"></span>ch27.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch28.html" class="nav-link sidebar-link sidebar-page" aria-label="ch28.md"><span class="icon iconfont icon-file"></span>ch28.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch29.html" class="nav-link sidebar-link sidebar-page" aria-label="ch29.md"><span class="icon iconfont icon-file"></span>ch29.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch3.html" class="nav-link sidebar-link sidebar-page" aria-label="ch3.md"><span class="icon iconfont icon-file"></span>ch3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch30.html" class="nav-link sidebar-link sidebar-page" aria-label="ch30.md"><span class="icon iconfont icon-file"></span>ch30.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch31.html" class="nav-link sidebar-link sidebar-page" aria-label="ch31.md"><span class="icon iconfont icon-file"></span>ch31.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch32.html" class="nav-link sidebar-link sidebar-page" aria-label="ch32.md"><span class="icon iconfont icon-file"></span>ch32.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch33.html" class="nav-link sidebar-link sidebar-page" aria-label="ch33.md"><span class="icon iconfont icon-file"></span>ch33.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch34.html" class="nav-link sidebar-link sidebar-page" aria-label="ch34.md"><span class="icon iconfont icon-file"></span>ch34.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch4.html" class="nav-link sidebar-link sidebar-page" aria-label="ch4.md"><span class="icon iconfont icon-file"></span>ch4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch5.html" class="nav-link sidebar-link sidebar-page" aria-label="ch5.md"><span class="icon iconfont icon-file"></span>ch5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch6.html" class="nav-link sidebar-link sidebar-page" aria-label="ch6.md"><span class="icon iconfont icon-file"></span>ch6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch7.html" class="nav-link sidebar-link sidebar-page" aria-label="ch7.md"><span class="icon iconfont icon-file"></span>ch7.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch8.html" class="nav-link sidebar-link sidebar-page" aria-label="ch8.md"><span class="icon iconfont icon-file"></span>ch8.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch9.html" class="nav-link sidebar-link sidebar-page" aria-label="ch9.md"><span class="icon iconfont icon-file"></span>ch9.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part1.html" class="nav-link sidebar-link sidebar-page" aria-label="part1.md"><span class="icon iconfont icon-file"></span>part1.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part2.html" class="nav-link sidebar-link sidebar-page" aria-label="part2.md"><span class="icon iconfont icon-file"></span>part2.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part3.html" class="nav-link sidebar-link sidebar-page" aria-label="part3.md"><span class="icon iconfont icon-file"></span>part3.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part4.html" class="nav-link sidebar-link sidebar-page" aria-label="part4.md"><span class="icon iconfont icon-file"></span>part4.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part5.html" class="nav-link sidebar-link sidebar-page" aria-label="part5.md"><span class="icon iconfont icon-file"></span>part5.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/Clean%20Archtechture/part6.html" class="nav-link sidebar-link sidebar-page" aria-label="part6.md"><span class="icon iconfont icon-file"></span>part6.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/obsidian-publish/Publish/%E5%AF%BC%E8%88%AA.html" class="nav-link sidebar-link sidebar-page" aria-label="导航.md"><span class="icon iconfont icon-file"></span>导航.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Chap25. LAYERS AND BOUNDARIES 层次与边界</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" localizeddate="2022年9月20日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://windily-cloud.github.io" target="_blank" rel="noopener noreferrer">Windily-Cloud</a></span><span property="author" content="Windily-Cloud"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年9月20日</span><meta property="datePublished" content="2022-09-20T11:03:58.000Z"></span><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2022年9月20日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 16 分钟</span><meta property="timeRequired" content="PT16M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#chap25-layers-and-boundaries-层次与边界" class="router-link-active router-link-exact-active toc-link level1">Chap25. LAYERS AND BOUNDARIES 层次与边界</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#hunt-the-wumpus-基于文本的冒险游戏-hunt-the-wumpus" class="router-link-active router-link-exact-active toc-link level2">HUNT THE WUMPUS 基于文本的冒险游戏：Hunt The Wumpus</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#clean-architecture-可否采用整洁架构" class="router-link-active router-link-exact-active toc-link level2">CLEAN ARCHITECTURE? 可否采用整洁架构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#crossing-the-streams-交汇数据流" class="router-link-active router-link-exact-active toc-link level2">CROSSING THE STREAMS 交汇数据流</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#splitting-the-streams-数据流的分割" class="router-link-active router-link-exact-active toc-link level2">SPLITTING THE STREAMS 数据流的分割</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/obsidian-publish/Publish/Clean%20Archtechture/ch25.html#conclusion-本章小结" class="router-link-active router-link-exact-active toc-link level2">CONCLUSION 本章小结</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="chap25-layers-and-boundaries-层次与边界" tabindex="-1"><a class="header-anchor" href="#chap25-layers-and-boundaries-层次与边界" aria-hidden="true">#</a> Chap25. LAYERS AND BOUNDARIES 层次与边界</h1><p>It is easy to think of systems as being composed of three components: UI, business rules, and database. For some simple systems, this is sufficient. For most systems, though, the number of components is larger than that.</p><blockquote><p>人们通常习惯于将系统分成三个组件：UI、业务逻辑和数据库。对于一些简单系统来说，的确可以这样，但稍复杂一些系统的组件就远不止三个了。</p></blockquote><p>Consider, for example, a simple computer game. It is easy to imagine the three components. The UI handles all messages from the player to the game rules. The game rules store the state of the game in some kind of persistent data structure. But is that all there is?</p><blockquote><p>以一个简单的计算机游戏为例。粗略看来，它好像也很符合三个组件的架构设定。首先，让 UI 负责接收用户输入的数据，并将数据传递给游戏的业务逻辑。然后，游戏的业务逻辑会将游戏状态保存在某种持久化数据结构中。但是，仅仅是这样而已吗？</p></blockquote><h2 id="hunt-the-wumpus-基于文本的冒险游戏-hunt-the-wumpus" tabindex="-1"><a class="header-anchor" href="#hunt-the-wumpus-基于文本的冒险游戏-hunt-the-wumpus" aria-hidden="true">#</a> HUNT THE WUMPUS 基于文本的冒险游戏：Hunt The Wumpus</h2><p>Let’s put some flesh on these bones. Let’s assume that the game is the venerable Hunt the Wumpus adventure game from 1972. This text-based game uses very simple commands like GO EAST and SHOOT WEST. The player enters a command, and the computer responds with what the player sees, smells, hears, and experiences. The player is hunting for a Wumpus in a system of caverns, and must avoid traps, pits, and other dangers lying in wait. If you are interested, the rules of the game are easy to find on the web.</p><blockquote><p>现在让我们往上面的设想中加入一些细节。假设这个游戏是 1972 年风靡一时的基于文本的冒险游戏：Hunt the Wumpus 这个游戏的操作是通过一些像 GO EAST 和 SHOOT WEST 这样的简单文字命令来完成的。玩家在输入命令之后，计算机就会返回玩家角色所看到的、闻到的、听到的或体会到的事情。在这个游戏中，玩家会在一系列洞穴中追捕 Wumpus。玩家必须避开陷阱、陷坑以及其他一系列危险。如果有兴趣，在网上很容易找到该游戏的规则说明。</p></blockquote><p>Let’s assume that we’ll keep the text-based UI, but decouple it from the game rules so that our version can use different languages in different markets. The game rules will communicate with the UI component using a language-independent API, and the UI will translate the API into the appropriate human language.</p><blockquote><p>现在，假设我们决定保留这种基于文本的 UI，但是需要将 UI 与游戏业务逻辑之间的耦合解开，以便我们的游戏版本可以在不同地区使用不同的语言。也就是说，游戏的业务逻辑与 UI 之间应该用一种与自然语言无关的 API 来进行通信，而由 UI 负责将 API 传递进来的信息转换成合适的自然语言。</p></blockquote><p>If the source code dependencies are properly managed, as shown in Figure 25.1, then any number of UI components can reuse the same game rules. The game rules do not know, nor do they care, which human language is being used.</p><blockquote><p>如果我们能管理好源码中的依赖关系，就应该像图 25.1 所展示的那样，多个 UI 组件复用同一套游戏业务逻辑。而游戏的业务逻辑组件不知道，也不必知道 UI 正在使用哪一种自然语言。</p></blockquote><!----><p>Let’s also assume that the state of the game is maintained on some persistent store—perhaps in flash, or perhaps in the cloud, or maybe just in RAM. In any of those cases, we don’t want the game rules to know the details. So, again, we’ll create an API that the game rules can use to communicate with the data storage component.</p><blockquote><p>同时，假设玩家在游戏中的状态会被保存在某种持久化存储介质中——有可能闪存，也有可能是某种云端存储，或只是本机内存。无论怎样，我们都并不希望游戏引擎了解这些细节。所以，我们仍然需要创建一个 API 来负责游戏的业务逻辑组件与数据存储组件之间的通信。</p></blockquote><p>We don’t want the game rules to know anything about the different kinds of data storage, so the dependencies have to be properly directed following the Dependency Rule, as shown in Figure 25.2.</p><blockquote><p>由于我们不会希望让游戏的业务逻辑依赖于不同种类的数据存储，所以这里的设计也要合理地遵守依赖关系原则，这样的话，该游戏的结构应如图 25.2 所示。</p></blockquote><!----><h2 id="clean-architecture-可否采用整洁架构" tabindex="-1"><a class="header-anchor" href="#clean-architecture-可否采用整洁架构" aria-hidden="true">#</a> CLEAN ARCHITECTURE? 可否采用整洁架构</h2><p>It should be clear that we could easily apply the clean architecture approach in this context,1 with all the use cases, boundaries, entities, and corresponding data structures. But have we really found all the significant architectural boundaries?</p><blockquote><p>很显然，这里具备了采用整洁架构方法所需要的—切，包括用例、业务实体以及对应的数据结构都有了，但我们是否已经找到了所有相应的架构边界呢？</p></blockquote><p>For example, language is not the only axis of change for the UI. We also might want to vary the mechanism by which we communicate the text. For example, we might want to use a normal shell window, or text messages, or a chat application. There are many different possibilities.</p><blockquote><p>例如，语言并不是 UI 变更的唯一方向。我们可能还会需要变更文字输入/输出的方式。例如我们的输入/输出可以采用命令行窗口，或者用短信息，或者采用某种聊天程序。这里的可能性有很多。</p></blockquote><p>That means that there is a potential architectural boundary defined by this axis of change. Perhaps we should construct an API that crosses that boundary and isolates the language from the communications mechanism; that idea is illustrated in Figure 25.3.</p><blockquote><p>这就意味着这类变更应该有一个对应的架构边界。也许我们需要构造一个 API，以便将语言部分与通信部分隔开，这样一来，该设计的结构应如图 25.3 所示。</p></blockquote><!----><p>The diagram in Figure 25.3 has gotten a little complicated, but should contain no surprises. The dashed outlines indicate abstract components that define an API that is implemented by the components above or below them. For example, the Language API is implemented by English and Spanish.</p><blockquote><p>在图 25.3 中可以看到，现在系统的结构已经变得有点复杂了。在该图中，虚线框代表的是抽象组件，它们所定义的 API 通常要交由其上下层的组件来实现。例如 Language 部分的 API 是由 English 和 Spanish 这两个组件来实现的。</p></blockquote><p>GameRules communicates with Language through an API that GameRules defines and Language implements. Language communicates with TextDelivery using an API that Language defines but TextDelivery implements. The API is defined and owned by the user, rather than by the implementer.</p><blockquote><p>我们也可以看到 GameRules 与 Language 这两个组件之间的交互是通过一个由 GameRules 定义，并由 Language 实现的 API 来完成的。同样的，Language 与 TextDelievery 之间的交互也是通过由 Language 定义，并由 TextDelievery 实现的 API 来完成。这些 API 的定义和维护都是由使用方来负责的，而非实现方。</p></blockquote><p>If we were to look inside GameRules, we would find polymorphic Boundary interfaces used by the code inside GameRules and implemented by the code inside the Language component. We would also find polymorphic Boundary interfaces used by Language and implemented by code inside GameRules.</p><blockquote><p>如果我们进一步查看 GameRules 内部，就会发现 GameRules 组件的代码中使用的 Boundary 多态接口是由 Language 组件来实现的；同时还会发现 Language 组件使用的 Boundary 多态接口由 GameRules 代码实现。</p></blockquote><p>If we were to look inside of Language, we would find the same thing: Polymorphic Boundary interfaces implemented by the code inside TextDelivery, and polymorphic Boundary interfaces used by TextDelivery and implemented by Language.</p><blockquote><p>如果再探究一下 Language 组件，我们也会看到类似的情况：它的 Boundary 多态接口是在 TextDelievery 组件的代码中实现的，而 TextDelievery 使用的 Boundary 多态接口则由 Language 来实现。</p></blockquote><p>In each case, the API defined by those Boundary interfaces is owned by the upstream component.</p><blockquote><p>在所有这些场景中，由 Boundary 接口所定义的 API 都是由其使用者的上一层组件负责维护的。</p></blockquote><p>The variations, such as English, SMS, and CloudData, are provided by polymorphic interfaces defined in the abstract API component, and implemented by the concrete components that serve them. For example, we would expect polymorphic interfaces defined in Language to be implemented by English and Spanish.</p><blockquote><p>不同的具体实现类，例如 English、SMS、CloudData 都实现了由抽象的 API 组件所定义的多态接口。例如，Language 组件中定义的多态接口是由 English 和 Spanish 这两个组件来定义的。</p></blockquote><p>We can simplify this diagram by eliminating all the variations and focusing on just the API components. Figure 25.4 shows this diagram.</p><blockquote><p>我们可以去掉所有的具体实现类，只保留 API 组件来进一步简化上面这张设计图，其简化的结果如图 25.4 所示。</p></blockquote><!----><p>Notice that the diagram is oriented in Figure 25.4 so that all the arrows point up. This puts GameRules at the top. This orientation makes sense because GameRules is the component that contains the highest-level policies.</p><blockquote><p>请注意图 25.4 中的朝向设计，所有的箭头都是朝上的。这样 GameRules 组件就被放在顶层的位置。这种朝向设计很好地反映了 GameRules 作为最高层策略组件的事买。</p></blockquote><p>Consider the direction of information flow. All input comes from the user through the TextDelivery component at the bottom left. That information rises through the Language component, getting translated into commands to GameRules. GameRules processes the user input and sends appropriate data down to DataStorage at the lower right.</p><blockquote><p>下面，我们来考虑一些信息流的方向。首先，所有来自用户的信息都会通过左下角的 TextDelievery 组件传入。当这些信息被上传到 Language 组件时，就会转换为具体的命令输入给 GameRules 组件。然后，GameRules 组件会负责处理用户的输入，并将数据发送给右下角的 Datastorage 组件。</p></blockquote><p>GameRules then sends output back down to Language, which translates the API back to the appropriate language and then delivers that language to the user through TextDelivery.</p><blockquote><p>接下来，GameRules 会将输出向下传递到 Language 组件，将其转成合适的语言并通过 TextDJievery 将该语言传递给用户。</p></blockquote><p>This organization effectively divides the flow of data into two streams.2 The stream on the left is concerned with communicating with the user, and the stream on the right is concerned with data persistence. Both streams meet at the top3 at GameRules, which is the ultimate processor of the data that goes through both streams.</p><blockquote><p>这种设计方式将数据流分成两路。左侧的数据流关注如何与用户通信，而右侧的数据流关注的是数据持久化。两条数据流在顶部的 GameRules 汇聚。GameRules 组件是所有数据的最终处理者。</p></blockquote><h2 id="crossing-the-streams-交汇数据流" tabindex="-1"><a class="header-anchor" href="#crossing-the-streams-交汇数据流" aria-hidden="true">#</a> CROSSING THE STREAMS 交汇数据流</h2><p>Are there always two data streams as in this example? No, not at all. Imagine that we would like to play Hunt the Wumpus on the net with multiple players. In this case, we would need a network component, like that shown in Figure 25.5. This organization divides the data flow into three streams, all controlled by the GameRules.</p><blockquote><p>那么，这个例子中是否永远只有这两条数据流呢？当然不是。假设我们现在要在网络上与多个其他玩家一起玩这个游戏，就会需要一个网络组件，如图 25.5 所示。这样一来，我们有了三条数据流，它们都由 GameRules 组件所控制。</p></blockquote><!----><p>So, as systems become more complex, the component structure may split into many such streams.</p><blockquote><p>由此可见，随着系统的复杂化，组件在架构中自然会分裂出多条数据流来。</p></blockquote><h2 id="splitting-the-streams-数据流的分割" tabindex="-1"><a class="header-anchor" href="#splitting-the-streams-数据流的分割" aria-hidden="true">#</a> SPLITTING THE STREAMS 数据流的分割</h2><p>At this point you may be thinking that all the streams eventually meet at the top in a single component. If only life were so simple! The reality, of course, is much more complex.</p><blockquote><p>此时你可能会认为所有的数据流最终都会汇聚到一个组件上。生活要是果真如此简单，那就真是太好了！现实情况往往不如人所愿啊。</p></blockquote><p>Consider the GameRules component for Hunt the Wumpus. Part of the game rules deal with the mechanics of the map. They know how the caverns are connected, and which objects are located in each cavern. They know how to move the player from cavern to cavern, and how to determine the events that the player must deal with.</p><blockquote><p>我们可以再来看一下 Hunt The Wumpu 这个游戏的 GameRules 组件。游戏的部分业务逻辑处理的是玩家在地图中的行走。这一部分需要知道游戏中的洞穴如何相连，每个洞穴中有什么物体存在，还要知道如何将玩家从一个洞穴移到另一个洞穴，以及如何触发各种需要玩家处理的事件。</p></blockquote><p>But there is another set of policies at an even higher level—policies that know the health of the player, and the cost or benefit of a particular event. These policies could cause the player to gradually lose health, or to gain health by discovering food. The lower-level mechanics policy would declare events to this higher-level policy, such as FoundFood or FellInPit. The higher-level policy would then manage the state of the player (as shown in Figure 25.6). Eventually that policy would decide whether the player wins or loses.</p><blockquote><p>但是，游戏中还有一组更高层次的策略——这些策略负责了解玩家的血量，以及每个事件的后果和影响。这些策略既可以让玩家逐渐损失血量，也可能由于发现事物而增加血量。总而言之，游戏的低层策略会负责向高层策略传递事件，例如 FoundFood 和 FelllnPito 而高层组件则要管理玩家状态（如图 25.6 所示），最终该策略将会决定玩家在游戏中的输赢。</p></blockquote><!----><p>Is this an architectural boundary? Do we need an API that separates MoveManagement from PlayerManagement? Well, let’s make this a bit more interesting and add micro-services.</p><blockquote><p>这些究竟是否属于架构边界呢？是否需要设计一个 API 来分割 MoveManagement 和 PlayerManagement 呢？在回答这些问题之前，让我们把问题弄得更有意思一点，再往里面加上微服务吧！</p></blockquote><p>Let’s assume that we’ve got a massive multiplayer version of Hunt the Wumpus. MoveManagement is handled locally within the player’s computer, but PlayerManagement is handled by a server. PlayerManagement offers a micro-service API to all the connected MoveManagement components.</p><blockquote><p>假设我们现在面对的是一个可以面向海量玩家的新版 Hurit The Wumpus 游戏。它的 MoveManagmenet 组合是由玩家的本地计算机来处理的 。而 PlayerManagement 组件则由服务端来处理。但 PlayerManagement 组件会为所有连接上它的 MoveManagement 组件提供一个微服务的 API。</p></blockquote><p>The diagram in Figure 25.7 depicts this scenario in a somewhat abbreviated fashion. The Network elements are a bit more complex than depicted—but you can probably still get the idea. A full-fledged architectural boundary exists between MoveManagement and PlayerManagement in this case.</p><blockquote><p>在图 25.7 中，我们为该游戏绘制了一个简化版的设计图。现实中的 Network 组件通常会比图中的更复杂一些 但这里的已经足够说明情况了。在图中，可以看到 MoveMangament PlayerManagment 之间存在一个完整的系统架构边界。</p></blockquote><!----><h2 id="conclusion-本章小结" tabindex="-1"><a class="header-anchor" href="#conclusion-本章小结" aria-hidden="true">#</a> CONCLUSION 本章小结</h2><p>What does all this mean? Why have I taken this absurdly simply program, which could be implemented in 200 lines of Kornshell, and extrapolated it out with all these crazy architectural boundaries?</p><blockquote><p>本章究竟想讨论什么呢？为什么要将一个极为简单的、在 Komshell 中只需 200 行代码就能写完的小程序扩展成具有这些系统架构边界的复杂程序？</p></blockquote><p>This example is intended to show that architectural boundaries exist everywhere. We, as architects, must be careful to recognize when they are needed. We also have to be aware that such boundaries, when fully implemented, are expensive. At the same time, we have to recognize that when such boundaries are ignored, they are very expensive to add in later—even in the presence of comprehensive test-suites and refactoring discipline.</p><blockquote><p>我们设计这个例子的目的就是为了证明架构边界可以存在于任何地方。作为架构师，我们必须要小心审视究竟在什么地方才需要设计架构边界。另外，我们还必须弄清楚完全实现这些边界将会带来多大的成本。同时，我们也必须要了解如果事先忽略了这些边界，后续再添加会有多么困难——哪怕有覆盖广泛的测试，严加小心的重构也于事无补。</p></blockquote><p>So what do we do, we architects? The answer is dissatisfying. On the one hand, some very smart people have told us, over the years, that we should not anticipate the need for abstraction. This is the philosophy of YAGNI: “You aren’t going to need it.” There is wisdom in this message, since over-engineering is often much worse than under-engineering. On the other hand, when you discover that you truly do need an architectural boundary where none exists, the costs and risks can be very high to add such a boundary.</p><blockquote><p>所以作为架构师，我们应该怎么办？这个问题恐怕没有答案。一方面，就像一些很聪明的人多年来一直告诉我们的那样，不应该将未来的需求抽象化。这就是 YAGNI 原则：“You aren&#39;t going to need it”，臆想中的需求事实上住往是不存在的。这是一句饱含智慧的建议，因为过度的工程设计往往比工程设计不足还要糟糕。但另一方面，如果我们发现自己在某个位置确实需要设置架构边界，却又没有事先准备的时候，再添加边界所需要的成本和风险往往是很高的。</p></blockquote><p>So there you have it. O Software Architect, you must see the future. You must guess—intelligently. You must weigh the costs and determine where the architectural boundaries lie, and which should be fully implemented, and which should be partially implemented, and which should be ignored.</p><blockquote><p>现实就是这样。作为软件架构师，我们必须有一点未卜先知的能力。有时候要依靠猜测——当然还要用点脑子。软件架构师必须仔细权衡成本，决定哪里需要设计架构边界，以及这些地方需要的是完整的边界，还是不完全的边界，还是可以忽略的边界。</p></blockquote><p>But this is not a one-time decision. You don’t simply decide at the start of a project which boundaries to implement and which to ignore. Rather, you watch. You pay attention as the system evolves. You note where boundaries may be required, and then carefully watch for the first inkling of friction because those boundaries don’t exist.</p><blockquote><p>而且，这不是一次性的决定。我们不能在项目开始时就决定好哪里需要边界，哪里不需要。相反，架构师必须持续观察系统的演进，时刻注意哪里可能需要设计边界，然后仔细观察这些地方会由于不存在边界而出现哪些问题。</p></blockquote><p>At that point, you weigh the costs of implementing those boundaries versus the cost of ignoring them—and you review that decision frequently. Your goal is to implement the boundaries right at the inflection point where the cost of implementing becomes less than the cost of ignoring.</p><blockquote><p>当出现问题时，我们还需要权衡一下实现这个边界的成本，并拿它与不实现这个边界的成本对比——这种对比经常需要反复地进行。我们的目标是找到设置边界的优势超过其成本的拐点，那就是实现该边界的最佳时机。</p></blockquote><p>It takes a watchful eye.</p><blockquote><p>持之以恒，一刻也不能放松。</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/windily-cloud/obsidian-publish/edit/main/Publish/Publish/Clean Archtechture/ch25.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/9/20 11:11:04</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: wwww.4399li@qq.com">windilycloud</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch24.html" class="nav-link prev" aria-label="ch24.md"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="icon iconfont icon-file"></span>ch24.md</div></a><a href="/obsidian-publish/Publish/Clean%20Archtechture/ch26.html" class="nav-link next" aria-label="ch26.md"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">ch26.md<span class="icon iconfont icon-file"></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">什么是幸褔？ 幸福就是猫吃鱼狗吃肉，奥特曼打小怪兽！</div><div class="copyright">Copyright © 2022 Windily-Cloud</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/obsidian-publish/assets/app.887b133c.js" defer></script>
  </body>
</html>
