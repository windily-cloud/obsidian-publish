import{_ as s}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as r,c as l,a as o,w as n,e as i,b as e,d as t,r as c}from"./app.887b133c.js";const h={},d=i('<h1 id="chap24-partial-boundaries-\u4E0D\u5B8C\u5168\u8FB9\u754C" tabindex="-1"><a class="header-anchor" href="#chap24-partial-boundaries-\u4E0D\u5B8C\u5168\u8FB9\u754C" aria-hidden="true">#</a> Chap24. PARTIAL BOUNDARIES \u4E0D\u5B8C\u5168\u8FB9\u754C</h1><p>Full-fledged architectural boundaries are expensive. They require reciprocal polymorphic Boundary interfaces, Input and Output data structures, and all of the dependency management necessary to isolate the two sides into independently compilable and deployable components. That takes a lot of work. It\u2019s also a lot of work to maintain.</p><blockquote><p>\u6784\u5EFA\u5B8C\u6574\u7684\u67B6\u6784\u8FB9\u754C\u662F\u4E00\u4EF6\u5F88\u8017\u8D39\u6210\u672C\u7684\u4E8B\u3002\u5728\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\uFF0C\u9700\u8981\u4E3A\u7CFB\u7EDF\u8BBE\u8BA1\u53CC\u5411\u7684\u591A\u6001\u8FB9\u754C\u63A5\u53E3\uFF0C\u7528\u4E8E\u8F93\u5165\u548C\u8F93\u51FA\u7684\u6570\u636E\u7ED3\u6784\uFF0C\u4EE5\u53CA\u6240\u6709\u76F8\u5173\u7684\u4F9D\u8D56\u5173\u7CFB\u7BA1\u7406\uFF0C\u4EE5\u4FBF\u5C06\u7CFB\u7EDF\u5206\u5272\u6210\u53EF\u72EC\u7ACB\u7F16\u8BD1\u4E0E\u90E8\u7F72\u7684\u7EC4\u4EF6\u3002\u8FD9\u91CC\u4F1A\u6D89\u53CA\u5927\u91CF\u7684\u524D\u671F\u5DE5\u4F5C\u4EE5\u53CA\u5927\u91CF\u7684\u540E\u671F\u7EF4\u62A4\u5DE5\u4F5C\u3002</p></blockquote><p>In many situations, a good architect might judge that the expense of such a boundary is too high\u2014but might still want to hold a place for such a boundary in case it is needed later.</p><blockquote><p>\u5728\u5F88\u591A\u60C5\u51B5\u4E0B\uFF0C\u4E00\u4F4D\u4F18\u79C0\u7684\u67B6\u6784\u5E08\u90FD\u4F1A\u8BA4\u4E3A\u8BBE\u8BA1\u67B6\u6784\u8FB9\u754C\u7684\u6210\u672C\u592A\u9AD8\u4E86\u2014\u2014\u4F46\u4E3A\u4E86\u5E94\u5BF9\u5C06\u6765\u53EF\u80FD\u7684\u9700\u8981\uFF0C\u901A\u5E38\u8FD8\u662F\u5E0C\u671B\u9884\u7559\u4E00\u4E2A\u8FB9\u754C\u3002</p></blockquote><p>This kind of anticipatory design is often frowned upon by many in the Agile community as a violation of YAGNI: \u201CYou Aren\u2019t Going to Need It.\u201D Architects, however, sometimes look at the problem and think, \u201CYeah, but I might.\u201D In that case, they may implement a partial boundary.</p><blockquote><p>\u4F46\u8FD9\u79CD\u9884\u9632\u6027\u8BBE\u8BA1\u5728\u654F\u6377\u793E\u533A\u91CC\u662F\u9971\u53D7\u8BDF\u75C5\u7684\uFF0C\u56E0\u4E3A\u5B83\u663E\u7136\u8FDD\u80CC\u4E86 YAGNI \u539F\u5219\uFF08&quot;You Are\u2019t Going to Need It\u201D\uFF0C\u610F\u5373\u201C\u4E0D\u8981\u9884\u6D4B\u672A\u6765\u7684\u9700\u8981\u201D\uFF09\u3002\u7136\u800C\uFF0C\u67B6\u6784\u5E08\u7684\u5DE5\u4F5C\u672C\u8EAB\u5C31\u662F\u8981\u505A\u8FD9\u6837\u7684\u9884\u89C1\u6027\u8BBE\u8BA1\uFF0C\u8FD9\u65F6\u5019\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u5F15\u5165\u4E0D\u5B8C\u5168\u8FB9\u754C\uFF08partial boundary\uFF09\u7684\u6982\u5FF5\u4E86\u3002</p></blockquote><h2 id="skip-the-last-step-\u7701\u6389\u6700\u540E\u4E00\u6B65" tabindex="-1"><a class="header-anchor" href="#skip-the-last-step-\u7701\u6389\u6700\u540E\u4E00\u6B65" aria-hidden="true">#</a> SKIP THE LAST STEP \u7701\u6389\u6700\u540E\u4E00\u6B65</h2><p>One way to construct a partial boundary is to do all the work necessary to create independently compilable and deployable components, and then simply keep them together in the same component. The reciprocal interfaces are there, the input/output data structures are there, and everything is all set up\u2014but we compile and deploy all of them as a single component.</p><blockquote><p>\u6784\u5EFA\u4E0D\u5B8C\u5168\u8FB9\u754C\u7684\u4E00\u79CD\u65B9\u5F0F\u5C31\u662F\u5728\u5C06\u7CFB\u7EDF\u5206\u5272\u6210\u4E00\u7CFB\u5217\u53EF\u4EE5\u72EC\u7ACB\u7F16\u8BD1\u3001\u72EC\u7ACB\u90E8\u7F72\u7684\u7EC4\u4EF6\u4E4B\u540E\uFF0C\u518D\u628A\u5B83\u4EEC\u6784\u5EFA\u6210\u4E00\u4E2A\u7EC4\u4EF6\u3002\u6362\u53E5\u8BDD\u8BF4\uFF0C\u5728\u5C06\u7CFB\u7EDF\u4E2D\u6240\u6709\u7684\u63A5\u53E3\u3001\u7528\u4E8E\u8F93\u5165/\u8F93\u51FA\u7684\u6570\u636E\u683C\u5F0F\u7B49\u6BCF\u4E00\u4EF6\u4E8B\u90FD\u8BBE\u7F6E\u597D\u4E4B\u540E\uFF0C\u4ECD\u9009\u62E9\u5C06\u5B83\u4EEC\u7EDF\u4E00\u7F16\u8BD1\u548C\u90E8\u7F72\u4E3A\u4E00\u4E2A\u7EC4\u4EF6\u3002</p></blockquote><p>Obviously, this kind of partial boundary requires the same amount of code and preparatory design work as a full boundary. However, it does not require the administration of multiple components. There\u2019s no version number tracking or release management burden. That difference should not be taken lightly.</p><blockquote><p>\u663E\u7136\uFF0C\u8FD9\u79CD\u4E0D\u5B8C\u5168\u8FB9\u754C\u6240\u9700\u8981\u7684\u4EE3\u7801\u91CF\u4EE5\u53CA\u8BBE\u8BA1\u7684\u5DE5\u4F5C\u91CF\uFF0C\u548C\u8BBE\u8BA1\u5B8C\u6574\u8FB9\u754C\u65F6\u662F\u5B8C\u5168\u4E00\u6837\u7684\u3002\u4F46\u5B83\u7701\u53BB\u4E86\u591A\u7EC4\u4EF6\u7BA1\u7406\u8FD9\u90E8\u5206\u7684\u5DE5\u4F5C\uFF0C\u8FD9\u5C31\u7B49\u4E8E\u7701\u53BB\u4E86\u7248\u672C\u53F7\u7BA1\u7406\u548C\u53D1\u5E03\u7BA1\u7406\u65B9\u9762\u7684\u5DE5\u4F5C\u2014\u2014\u8FD9\u5176\u4E2D\u7684\u5DE5\u4F5C\u91CF\u5176\u5B9E\u53EF\u4E0D\u5C0F\u3002</p></blockquote><p>This was the early strategy behind FitNesse. The web server component of FitNesse was designed to be separable from the wiki and testing part of FitNesse. The idea was that we might want to create other web-based applications by using that web component. At the same, we did not want users to have to download two components. Recall that one of our design goals was \u201Cdownload and go.\u201D It was our intent that users would download one jar file and execute it without having to hunt for other jar files, work out version compatibilities, and so on.</p><blockquote><p>\u8FD9\u4E5F\u662F FitNesse \u9879\u76EE\u65E9\u671F\u6240\u91C7\u53D6\u7684\u7B56\u7565\u3002\u6211\u4EEC\u5728\u8BBE\u8BA1 Web \u670D\u52A1\u5668\u4E4B\u521D\u5C31\u5C06\u5B83\u8BBE\u8BA1\u4E3A\u4E00\u4E2A\u53EF\u4EE5\u72EC\u7ACB\u4E8E wiki \u548C\u6D4B\u8BD5\u90E8\u5206\u7684\u7EC4\u4EF6\u3002\u8BE5\u8BBE\u8BA1\u80CC\u540E\u7684\u60F3\u6CD5\u662F\u6211\u4EEC\u672A\u6765\u53EF\u80FD\u9700\u8981\u4F7F\u7528\u8BE5 Web \u7EC4\u4EF6\u6765\u6784\u5EFA\u5176\u4ED6\u5E94\u7528\u7A0B\u5E8F\u3002\u4F46\u662F\u540C\u65F6\uFF0C\u6211\u4EEC\u53C8\u4E0D\u60F3\u8BA9\u7528\u6237\u4E0B\u8F7D\u4E24\u4E2A\u7EC4\u4EF6\u3002\u6B63\u5982\u6211\u4EEC\u4E4B\u524D\u6240\u8BF4\uFF0C\u8BE5\u9879\u76EE\u5176\u4E2D\u7684\u4E00\u4E2A\u8BBE\u8BA1\u76EE\u6807\u662F\u5B9E\u73B0\u8BA9\u7528\u6237\u4E0B\u8F7D\u5373\u53EF\u8FD0\u884C\u3002\u6211\u4EEC\u5E0C\u671B\u7528\u6237\u53EA\u9700\u4E0B\u8F7D\u4E00\u4E2A jar \u6587\u4EF6\u5C31\u7ACB\u5373\u53EF\u4EE5\u6267\u884C\uFF0C\u4E0D\u9700\u8981\u518D\u53BB\u5BFB\u627E\u5176\u4ED6\u7684 jar \u6587\u4EF6\uFF0C\u66F4\u4E0D\u9700\u8981\u64CD\u5FC3\u7248\u672C\u517C\u5BB9\u6027\u7B49\u95EE\u9898\u3002</p></blockquote><p>The story of FitNesse also points out one of the dangers of this approach. Over time, as it became clear that there would never be a need for a separate web component, the separation between the web component and the wiki component began to weaken. Dependencies started to cross the line in the wrong direction. Nowadays, it would be something of a chore to re-separate them.</p><blockquote><p>\u5728\u8FD9\u91CC\uFF0CFitNcssc \u9879\u76EE\u7684\u6545\u4E8B\u4E5F\u53EF\u4EE5\u4F5C\u4E3A\u4E00\u4E2A\u53CD\u4F8B\u6765\u8BF4\u660E\u8FD9\u79CD\u8BBE\u8BA1\u7684\u5371\u5BB3\u6027\u3002\u968F\u7740\u65F6\u95F4\u7684\u63A8\u79FB\uFF0C\u6211\u4EEC\u6162\u6162\u53D1\u73B0\uFF0C\u5C06 Web \u7EC4\u4EF6\u72EC\u7ACB\u7684\u9700\u6C42\u8D8A\u6765\u8D8A\u5C11\uFF0CWiki \u7EC4\u4EF6\u4E0E Web \u7EC4\u4EF6\u7684\u9694\u79BB\u4E5F\u5F31\u5316\u4E86\u3002\u5230\u5982\u4ECA\uFF0C\u5982\u679C\u771F\u60F3\u8981\u518D\u5206\u79BB Web \u7EC4\u4EF6\u7684\u8BDD\uFF0C\u4F1A\u9700\u8981\u4E0D\u5C11\u5DE5\u4F5C\u91CF\u3002</p></blockquote><h2 id="one-dimensional-boundaries-\u5355\u5411\u8FB9\u754C" tabindex="-1"><a class="header-anchor" href="#one-dimensional-boundaries-\u5355\u5411\u8FB9\u754C" aria-hidden="true">#</a> ONE-DIMENSIONAL BOUNDARIES \u5355\u5411\u8FB9\u754C</h2><p>The full-fledged architectural boundary uses reciprocal boundary interfaces to maintain isolation in both directions. Maintaining separation in both directions is expensive both in initial setup and in ongoing maintenance.</p><blockquote><p>\u5728\u8BBE\u8BA1\u4E00\u5957\u5B8C\u6574\u7684\u7CFB\u7EDF\u67B6\u6784\u8FB9\u754C\u65F6\uFF0C\u5F80\u5F80\u9700\u8981\u7528\u53CD\u5411\u63A5\u53E3\u6765\u7EF4\u62A4\u8FB9\u754C\u4E24\u4FA7\u7EC4\u4EF6\u7684\u9694\u79BB\u6027\u3002\u800C\u4E14\uFF0C\u7EF4\u62A4\u8FD9\u79CD\u53CC\u5411\u7684\u9694\u79BB\u6027\uFF0C\u901A\u5E38\u4E0D\u4F1A\u662F\u4E00\u6B21\u6027\u7684\u5DE5\u4F5C\uFF0C\u5B83\u9700\u8981\u6211\u4EEC\u6301\u7EED\u5730\u957F\u671F\u6295\u5165\u8D44\u6E90\u7EF4\u62A4\u4E0B\u53BB\u3002</p></blockquote><p>A simpler structure that serves to hold the place for later extension to a full-fledged boundary is shown in Figure 24.1. It exemplifies the traditional Strategy pattern. A ServiceBoundary interface is used by clients and implemented by ServiceImpl classes.</p><blockquote><p>\u5728\u56FE 24.1 \u4E2D\uFF0C\u4F60\u4F1A\u770B\u5230\u4E00\u4E2A\u4E34\u65F6\u5360\u4F4D\u7684\uFF0C\u5C06\u6765\u53EF\u88AB\u66FF\u6362\u6210\u5B8C\u6574\u67B6\u6784\u8FB9\u754C\u7684\u66F4\u7B80\u5355\u7684\u7ED3\u6784\u3002\u8FD9\u4E2A\u7ED3\u6784\u91C7\u7528\u4E86\u4F20\u7EDF\u7684\u7B56\u7565\u6A21\u5F0F\uFF08strategy pattern\uFF09\u3002\u5982\u4F60\u6240\u89C1\uFF0C\u5176 Client \u4F7F\u7528\u7684\u662F\u4E00\u4E2A\u7531 ServiceImpl \u7C7B\u5B9E\u73B0\u7684 ServiceBoundary \u63A5\u53E3\u3002</p></blockquote>',21),p=t("The Strategy pattern"),u=e("p",null,"It should be clear that this sets the stage for a future architectural boundary. The necessary dependency inversion is in place in an attempt to isolate the Client from the ServiceImpl. It should also be clear that the separation can degrade pretty rapidly, as shown by the nasty dotted arrow in the diagram. Without reciprocal interfaces, nothing prevents this kind of backchannel other than the diligence and discipline of the developers and architects.",-1),b=e("blockquote",null,[e("p",null,"\u5F88\u660E\u663E\uFF0C\u4E0A\u8FF0\u8BBE\u8BA1\u4E3A\u672A\u6765\u6784\u5EFA\u5B8C\u6574\u7684\u7CFB\u7EDF\u67B6\u6784\u8FB9\u754C\u6253\u4E0B\u4E86\u575A\u5B9E\u57FA\u7840\u3002\u4E3A\u4E86\u672A\u6765\u5C06 Client \u4E0E ServiceImpl \u9694\u79BB\uFF0C\u5FC5\u8981\u7684\u4F9D\u8D56\u53CD\u8F6C\u5DF2\u7ECF\u505A\u5B8C\u4E86\u3002\u540C\u65F6\uFF0C\u6211\u4EEC\u4E5F\u80FD\u6E05\u695A\u5730\u770B\u5230\uFF0C\u56FE\u4E2D\u7684\u865A\u7EBF\u7BAD\u5934\u4EE3\u8868\u4E86\u672A\u6765\u6709\u53EF\u80FD\u5F88\u5FEB\u5C31\u4F1A\u51FA\u95EE\u9898\u7684\u9694\u79BB\u95EE\u9898\u3002\u7531\u4E8E\u6CA1\u6709\u91C7\u7528\u53CC\u5411\u53CD\u5411\u63A5\u53E3\uFF0C\u8FD9\u90E8\u5206\u5C31\u53EA\u80FD\u4F9D\u8D56\u5F00\u53D1\u8005\u548C\u67B6\u6784\u5E08\u7684\u81EA\u5F8B\u6027\u6765\u4FDD\u8BC1\u7EC4\u4EF6\u6301\u4E45\u9694\u79BB\u4E86\u3002")],-1),m=e("h2",{id:"facades-\u95E8\u6237\u6A21\u5F0F",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#facades-\u95E8\u6237\u6A21\u5F0F","aria-hidden":"true"},"#"),t(" FACADES \u95E8\u6237\u6A21\u5F0F")],-1),f=e("p",null,"An even simpler boundary is the Facade pattern, illustrated in Figure 24.2. In this case, even the dependency inversion is sacrificed. The boundary is simply defined by the Facade class, which lists all the services as methods, and deploys the service calls to classes that the client is not supposed to access.",-1),y=e("blockquote",null,[e("p",null,"\u4E0B\u9762\uFF0C\u6211\u4EEC\u518D\u6765\u770B\u4E00\u4E2A\u66F4\u7B80\u5355\u7684\u67B6\u6784\u8FB9\u754C\u8BBE\u8BA1\uFF1A\u91C7\u7528\u95E8\u6237\u6A21\u5F0F\uFF08facade pattern\uFF09\uFF0C\u5176\u67B6\u6784\u5982\u56FE 24.2 \u6240\u793A\u3002\u5728\u8FD9\u79CD\u6A21\u5F0F\u4E0B\uFF0C\u6211\u4EEC\u8FDE\u4F9D\u8D56\u53CD\u8F6C\u7684\u5DE5\u4F5C\u90FD\u53EF\u4EE5\u7701\u4E86\u3002\u8FD9\u91CC\u7684\u8FB9\u754C\u5C06\u53EA\u80FD\u7531 Facade \u7C7B\u6765\u5B9A\u4E49\uFF0C\u8FD9\u4E2A\u7C7B\u7684\u80CC\u540E\u662F\u4E00\u4EFD\u5305\u542B\u4E86\u6240\u6709\u670D\u52A1\u51FD\u6570\u7684\u5217\u8868\uFF0C\u5B83\u4F1A\u8D1F\u8D23\u5C06 Client \u7684\u8C03\u7528\u4F20\u9012\u7ED9\u5BF9 client \u4E0D\u53EF\u89C1\u7684\u670D\u52A1\u51FD\u6570\u3002")],-1),g=t("The Facade pattern"),w=i('<p>Note, however, that the Client has a transitive dependency on all those service classes. In static languages, a change to the source code in one of the Service classes will force the Client to recompile. Also, you can imagine how easy backchannels are to create with this structure.</p><blockquote><p>\u4F46\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u5728\u8BE5\u8BBE\u8BA1\u4E2D Client \u4F1A\u4F20\u9012\u6027\u5730\u4F9D\u8D56\u4E8E\u6240\u6709\u7684 Service \u7C7B\u3002\u5728\u9759\u6001\u7C7B\u578B\u8BED\u8A00\u4E2D\uFF0C\u8FD9\u5C31\u610F\u5473\u7740\u5BF9 Service \u7C7B\u7684\u6E90\u7801\u6240\u505A\u7684\u4EFB\u4F55\u4FEE\u6539\u90FD\u4F1A\u5BFC\u81F4 Client \u7684\u91CD\u65B0\u7F16\u8BD1\u3002\u53E6\u5916\uFF0C\u6211\u4EEC\u5E94\u8BE5\u4E5F\u80FD\u60F3\u8C61\u5F97\u5230\u4E3A\u8FD9\u79CD\u7ED3\u6784\u5EFA\u7ACB\u53CD\u5411\u901A\u9053\u662F\u591A\u5BB9\u6613\u7684\u4E8B\u3002</p></blockquote><h2 id="conclusion-\u672C\u7AE0\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#conclusion-\u672C\u7AE0\u5C0F\u7ED3" aria-hidden="true">#</a> CONCLUSION \u672C\u7AE0\u5C0F\u7ED3</h2><p>We\u2019ve seen three simple ways to partially implement an architectural boundary. There are, of course, many others. These three strategies are simply offered as examples.</p><blockquote><p>\u5728\u672C\u7AE0\uFF0C\u6211\u4EEC\u4ECB\u7ECD\u4E86\u4E09\u79CD\u4E0D\u5B8C\u5168\u5730\u5B9E\u73B0\u67B6\u6784\u8FB9\u754C\u7684\u7B80\u5355\u65B9\u6CD5\u3002\u5F53\u7136\uFF0C\u8FD9\u7C7B\u8FB9\u754C\u8FD8\u6709\u8BB8\u591A\u79CD\u5176\u4ED6\u5B9E\u73B0\u65B9\u5F0F\uFF0C\u672C\u7AE0\u6240\u4ECB\u7ECD\u7684\u8FD9\u4E09\u79CD\u7B56\u7565\u53EA\u4E3A\u793A\u8303\u4E4B\u7528\u3002</p></blockquote><p>Each of these approaches has its own set of costs and benefits. Each is appropriate, in certain contexts, as a placeholder for an eventual full-fledged boundary. Each can also be degraded if that boundary never materializes.</p><blockquote><p>\u6BCF\u79CD\u5B9E\u73B0\u65B9\u5F0F\u90FD\u6709\u76F8\u5E94\u7684\u6210\u672C\u548C\u6536\u76CA\u3002\u6BCF\u79CD\u65B9\u5F0F\u90FD\u6709\u81EA\u5DF1\u6240\u9002\u7528\u7684\u573A\u666F\uFF0C\u5B83\u4EEC\u53EF\u4EE5\u88AB\u7528\u6765\u5145\u5F53\u6700\u7EC8\u5B8C\u6574\u67B6\u6784\u8FB9\u754C\u7684\u4E34\u65F6\u66FF\u4EE3\u54C1\u3002\u540C\u65F6\uFF0C\u7785\u8FD9\u4E9B\u8FB9\u754C\u6700\u7EC8\u88AB\u8BC1\u660E\u662F\u6CA1\u6709\u5FC5\u8981\u5B58\u5728\u7684\uFF0C\u90A3\u4E48\u4E5F\u53EF\u4EE5\u88AB\u81EA\u7136\u964D\u89E3\u3002</p></blockquote><p>It is one of the functions of an architect to decide where an architectural boundary might one day exist, and whether to fully or partially implement that boundary.</p><blockquote><p>\u67B6\u6784\u5E08\u7684\u804C\u8D23\u4E4B\u4E00\u5C31\u662F\u9884\u5224\u672A\u6765\u54EA\u91CC\u6709\u53EF\u80FD\u4F1A\u9700\u8981\u8BBE\u7F6E\u67B6\u6784\u8FB9\u754C\uFF0C\u5E76\u51B3\u5B9A\u5E94\u8BE5\u4EE5\u5B8C\u5168\u5F62\u5F0F\u8FD8\u662F\u4E0D\u5B8C\u5168\u5F62\u5F0F\u6765\u5B9E\u73B0\u5B83\u4EEC\u3002</p></blockquote>',9);function k(v,_){const a=c("Figures");return r(),l("div",null,[d,o(a,{figure:"24-1"},{default:n(()=>[p]),_:1}),u,b,m,f,y,o(a,{figure:"24-2"},{default:n(()=>[g]),_:1}),w])}const N=s(h,[["render",k],["__file","ch24.html.vue"]]);export{N as default};
