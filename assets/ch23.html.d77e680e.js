import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as t,c as a,e as o}from"./app.887b133c.js";const s={},r=o('<h1 id="chap23-presenters-and-humble-objects-\u5C55\u793A\u5668\u548C\u8C26\u5351\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#chap23-presenters-and-humble-objects-\u5C55\u793A\u5668\u548C\u8C26\u5351\u5BF9\u8C61" aria-hidden="true">#</a> Chap23. PRESENTERS AND HUMBLE OBJECTS \u5C55\u793A\u5668\u548C\u8C26\u5351\u5BF9\u8C61</h1><p>In Chapter 22, we introduced the notion of presenters. Presenters are a form of the Humble Object pattern, which helps us identify and protect architectural boundaries. Actually, the Clean Architecture in the last chapter was full of Humble Object implementations.</p><blockquote><p>\u5728\u7B2C 22 \u7AE0\u4E2D\uFF0C\u6211\u4EEC\u5F15\u5165\u4E86\u5C55\u793A\u5668\uFF08presenter\uFF09\u7684\u6982\u5FF5\uFF0C\u5C55\u793A\u5668\u5B9E\u9645\u4E0A\u662F\u91C7\u7528\u8C26\u5351\u5BF9\u8C61\uFF08humble object\uFF09\u6A21\u5F0F\u7684\u4E00\u79CD\u5F62\u5F0F\uFF0C\u8FD9\u79CD\u8BBE\u8BA1\u6A21\u5F0F\u53EF\u4EE5\u5F88\u597D\u5730\u5E2E\u52A9\u8BC6\u522B\u548C\u7CFB\u7EDF\u67B6\u6784\u7684\u8FB9\u754C\u3002\u4E8B\u5B9E\u4E0A\uFF0C\u7B2C 22 \u7AE0\u6240\u4ECB\u7ECD\u7684\u6574\u6D01\u67B6\u6784\u4E2D\u5C31\u5145\u6EE1\u4E86\u5927\u91CF\u8C26\u5351\u5BF9\u8C61\u7684\u5B9E\u73B0\u4F53\u3002</p></blockquote><h2 id="the-humble-object-pattern-\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#the-humble-object-pattern-\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F" aria-hidden="true">#</a> THE HUMBLE OBJECT PATTERN \u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F</h2><p>The Humble Object pattern1 is a design pattern that was originally identified as a way to help unit testers to separate behaviors that are hard to test from behaviors that are easy to test. The idea is very simple: Split the behaviors into two modules or classes. One of those modules is humble; it contains all the hard-to-test behaviors stripped down to their barest essence. The other module contains all the testable behaviors that were stripped out of the humble object.</p><blockquote><p>\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\u6700\u521D\u7684\u8BBE\u8BA1\u76EE\u7684\u662F\u5E2E\u52A9\u5355\u5143\u6D4B\u8BD5\u7684\u7F16\u5199\u8005\u533A\u5206\u5BB9\u6613\u6D4B\u8BD5\u7684\u884C\u4E3A\u4E0E\u96BE\u4EE5\u6D4B\u8BD5\u7684\u884C\u4E3A\uFF0C\u5E76\u5C06\u5B83\u4EEC\u9694\u79BB\u3002\u5176\u8BBE\u8BA1\u601D\u8DEF\u975E\u5E38\u7B80\u5355\uFF0C\u5C31\u662F\u5C06\u8FD9\u4E24\u7C7B\u884C\u4E3A\u62C6\u5206\u6210\u4E24\u7EC4\u6A21\u5757\u6216\u7C7B\u3002\u5176\u4E2D\u4E00\u7EC4\u6A21\u5757\u88AB\u79F0\u4E3A\u8C26\u5351\uFF08Humble\uFF09\u7EC4\uFF0C\u5305\u542B\u4E86\u7CFB\u7EDF\u4E2D\u6240\u6709\u96BE\u4EE5 \u6D4B\u8BD5\u7684\u884C\u4E3A\uFF0C\u800C\u8FD9\u4E9B\u884C\u4E3A\u5DF2\u7ECF\u88AB\u7B80\u5316\u5230\u4E0D\u80FD\u518D\u7B80\u5316\u4E86\u3002\u53E6\u4E00\u7EC4\u6A21\u5757\u5219\u5305\u542B\u4E86\u6240\u6709\u4E0D\u5C5E\u4E8E\u8C26\u5351\u5BF9\u8C61\u7684\u884C\u4E3A\u3002</p></blockquote><p>For example, GUIs are hard to unit test because it is very difficult to write tests that can see the screen and check that the appropriate elements are displayed there. However, most of the behavior of a GUI is, in fact, easy to test. Using the Humble Object pattern, we can separate these two kinds of behaviors into two different classes called the Presenter and the View.</p><blockquote><p>\u4F8B\u5982\uFF0CGUI \u901A\u5E38\u662F\u5F88\u96BE\u8FDB\u884C\u5355\u5143\u6D4B\u8BD5\u7684\uFF0C\u56E0\u4E3A\u8BA9\u8BA1\u7B97\u673A\u81EA\u884C\u68C0\u89C6\u5C4F\u5E55\u5185\u5BB9\uFF0C\u5E76\u68C0\u67E5\u6307\u5B9A\u5143\u7D20\u662F\u5426\u51FA\u73B0\u662F\u975E\u5E38\u96BE\u7684\u4E8B\u60C5\u3002\u7136\u800C\uFF0CGUI \u4E2D\u7684\u5927\u90E8\u5206\u884C\u4E3A\u5B9E\u9645\u4E0A\u662F\u5F88\u5BB9\u6613\u88AB\u6D4B\u8BD5\u7684\u3002\u8FD9\u65F6\u5019\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u5229\u7528\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\u5C06 GUI \u7684\u8FD9\u4E24\u79CD\u884C\u4E3A\u62C6\u5206\u6210\u5C55\u793A\u5668\u4E0E\u89C6\u56FE\u4E24\u90E8\u5206\u3002</p></blockquote><h2 id="presenters-and-views-\u5C55\u793A\u5668\u4E0E\u89C6\u56FE" tabindex="-1"><a class="header-anchor" href="#presenters-and-views-\u5C55\u793A\u5668\u4E0E\u89C6\u56FE" aria-hidden="true">#</a> PRESENTERS AND VIEWS \u5C55\u793A\u5668\u4E0E\u89C6\u56FE</h2><p>The View is the humble object that is hard to test. The code in this object is kept as simple as possible. It moves data into the GUI but does not process that data.</p><blockquote><p>\u89C6\u56FE\u90E8\u5206\u5C5E\u4E8E\u96BE\u4EE5\u6D4B\u8BD5\u7684\u8C26\u5351\u5BF9\u8C61\u3002\u8FD9\u79CD\u5BF9\u8C61\u7684\u4EE3\u7801\u901A\u5E38\u5E94\u8BE5\u8D8A\u7B80\u5355\u8D8A\u597D\uFF0C\u5B83\u53EA\u5E94\u8D1F\u8D23\u5C06\u6570\u636E\u586B\u5145\u5230 GUI \u4E0A\uFF0C\u800C\u4E0D\u5E94\u8BE5\u5BF9\u6570\u636E\u8FDB\u884C\u4EFB\u4F55\u5904\u7406\u3002</p></blockquote><p>The Presenter is the testable object. Its job is to accept data from the application and format it for presentation so that the View can simply move it to the screen. For example, if the application wants a date displayed in a field, it will hand the Presenter a Date object. The Presenter will then format that data into an appropriate string and place it in a simple data structure called the View Model, where the View can find it.</p><blockquote><p>\u5C55\u793A\u5668\u5219\u662F\u53EF\u6D4B\u8BD5\u7684\u5BF9\u8C61\u3002\u5C55\u793A\u5668\u7684\u5DE5\u4F5C\u662F\u8D1F\u8D23\u4ECE\u5E94\u7528\u7A0B\u5E8F\u4E2D\u63A5\u6536\u6570\u636E\uFF0C\u7136\u540E\u6309\u89C6\u56FE\u7684\u9700\u8981\u5C06\u8FD9\u4E9B\u6570\u636E\u683C\u5F0F\u5316\uFF0C\u4EE5\u4FBF\u89C6\u56FE\u5C06\u5176\u5448\u73B0\u5728\u5C4F\u5E55\u4E0A\u3002\u4F8B\u5982\uFF0C\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u9700\u8981\u5728\u5C4F\u5E55\u4E0A\u5C55\u793A\u4E00\u4E2A\u65E5\u671F\uFF0C\u90A3\u4E48\u5B83\u4F20\u9012\u7ED9\u5C55\u793A\u5668\u7684\u5E94\u8BE5\u662F\u4E00\u4E2A Date \u5BF9\u8C61\u3002\u7136\u540E\u5C55\u793A\u5668\u4F1A\u5C06\u8BE5\u5BF9\u8C61\u683C\u5F0F\u5316\u6210\u6240\u9700\u7684\u5B57\u7B26\u4E32\u5F62\u5F0F\uFF0C\u5E76\u5C06\u5176\u586B\u5145\u5230\u89C6\u56FE\u6A21\u578B\u4E2D\u3002</p></blockquote><p>If the application wants to display money on the screen, it might pass a Currency object to the Presenter. The Presenter will format that object with the appropriate decimal places and currency markers, creating a string that it can place in the View Model. If that currency value should be turned red if it is negative, then a simple boolean flag in the View model will be set appropriately.</p><blockquote><p>\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u9700\u8981\u5728\u5C4F\u5E55\u4E0A\u5C55\u793A\u91D1\u989D\uFF0C\u90A3\u4E48\u5B83\u5E94\u8BE5\u5C06 Currency \u5BF9\u8C61\u4F20\u9012\u7ED9\u5C55\u793A\u5668\u3002\u5C55\u793A\u5668\u968F\u540E\u4F1A\u5C06\u8FD9\u4E2A\u5BF9\u8C61\u6309\u6240\u9700\u7684\u5C0F\u6570\u4F4D\u6570\u8FDB\u884C\u683C\u5F0F\u5316\uFF0C\u5E76\u52A0\u4E0A\u5BF9\u5E94\u7684\u8D27\u5E01\u6807\u8BC6\u7B26\uFF0C\u5F62\u6210\u4E00\u4E2A\u5B57\u7B26\u4E32\u5B58\u653E\u5728\u89C6\u56FE\u6A21\u578B\u4E2D\u3002\u5982\u679C\u9700\u8981\u5C06\u8D1F\u6570\u91D1\u989D\u663E\u793A\u6210\u7EA2\u8272\uFF0C\u90A3\u4E48\u8BE5\u89C6\u56FE\u6A21\u578B\u4E2D\u5C31\u5E94\u8BE5\u6709\u4E00\u4E2A\u7B80\u5355\u7684\u5E03\u5C14\u503C\u88AB\u6070\u5F53\u5730\u8BBE\u7F6E\u3002</p></blockquote><p>Every button on the screen will have a name. That name will be a string in the View Model, placed there by the presenter. If those buttons should be grayed out, the Presenter will set an appropriate boolean flag in the View model. Every menu item name is a string in the View model, loaded by the Presenter. The names for every radio button, check box, and text field are loaded, by the Presenter, into appropriate strings and booleans in the View model. Tables of numbers that should be displayed on the screen are loaded, by the Presenter, into tables of properly formatted strings in the View model.</p><blockquote><p>\u53E6\u5916\uFF0C\u5E94\u7528\u7A0B\u5E8F\u5728\u5C4F\u5E55\u4E0A\u7684\u6BCF\u4E2A\u6309\u94AE\u90FD\u5E94\u8BE5\u6709\u5176\u5BF9\u5E94\u7684\u540D\u79F0\uFF0C\u8FD9\u4E9B\u540D\u79F0\u4E5F\u662F\u7531\u5C55\u793A\u5668\u5728\u89C6\u56FE\u6A21\u578B\u4E2D\u8BBE\u7F6E\u7684\u3002\u5982\u679C\u67D0\u4E2A\u6309\u94AE\u9700\u8981\u53D8\u7070\uFF0C\u5C55\u793A\u5668\u5C31\u5E94\u8BE5\u5C06\u76F8\u5E94\u7684\u5F00\u5173\u53D8\u91CF\u8BBE\u7F6E\u6210\u5BF9\u5E94\u7684\u5E03\u5C14\u503C\u3002\u540C\u6837\uFF0C\u83DC\u5355\u4E2D\u6BCF\u4E2A\u83DC\u5355\u9879\u6240\u663E\u793A\u7684\u503C\uFF0C\u4E5F\u5E94\u8BE5\u662F\u4E00\u4E2A\u4E2A\u7531\u5C55\u793A\u5668\u52A0\u8F7D\u5230\u89C6\u56FE\u6A21\u578B\u4E2D\u7684\u5B57\u7B26\u4E32\u3002\u5E94\u7528\u7A0B\u5E8F\u5728\u5C4F\u5E55\u4E0A\u663E\u793A\u7684\u6BCF\u4E2A\u5355\u9009\u9879\u3001\u591A\u9009\u9879\u4EE5\u53CA\u6587\u672C\u6846\u7684\u540D\u5B57\u4E5F\u90FD\u5982\u6B64\uFF0C\u5728\u89C6\u56FE\u6A21\u578B\u4E2D\u90FD\u6709\u76F8\u5E94\u7684\u5B57\u7B26\u4E32\u548C\u5E03\u5C14\u503C\u53EF\u4F9B\u5C55\u793A\u5668\u505A\u5BF9\u5E94\u7684\u8BBE\u7F6E\u3002\u5373\u4F7F\u5C4F\u5E55\u4E0A\u8981\u52A0\u8F7D\u7684\u662F\u4E00\u4E2A\u6570\u503C\u8868\uFF0C\u5C55\u793A\u5668\u4E5F\u5E94\u8BE5\u8D1F\u8D23\u628A\u8FD9\u4E9B\u6570\u503C\u683C\u5F0F\u5316\u6210\u5177\u6709\u8868\u683C\u5C5E\u6027\u7684\u5B57\u7B26\u4E32\uFF0C\u4EE5\u4F9B\u89C6\u56FE\u4F7F\u7528\u3002</p></blockquote><p>Anything and everything that appears on the screen, and that the application has some kind of control over, is represented in the View Model as a string, or a boolean, or an enum. Nothing is left for the View to do other than to load the data from the View Model into the screen. Thus the View is humble.</p><blockquote><p>\u603B\u800C\u8A00\u4E4B\uFF0C\u5E94\u7528\u7A0B\u5E8F\u6240\u80FD\u63A7\u5236\u7684\u3001\u8981\u5728\u5C4F\u5E55\u4E0A\u663E\u793A\u7684\u4E00\u5207\u4E1C\u897F\uFF0C\u90FD\u5E94\u8BE5\u5728\u89C6\u56FE\u6A21\u578B\u4E2D\u4EE5\u5B57\u7B26\u4E32\u3001\u5E03\u5C14\u503C\u6216\u679A\u4E3E\u503C\u7684\u5F62\u5F0F\u5B58\u5728\u3002\u7136\u540E\uFF0C\u89C6\u56FE\u90E8\u5206\u9664\u4E86\u52A0\u8F7D\u89C6\u56FE\u6A21\u578B\u6240\u9700\u8981\u7684\u503C\uFF0C\u4E0D\u5E94\u8BE5\u518D\u505A\u4EFB\u4F55\u5176\u4ED6\u4E8B\u60C5\u3002\u56E0\u6B64\uFF0C\u6211\u4EEC\u624D\u80FD\u8BF4\u89C6\u56FE\u662F\u8C26\u5351\u5BF9\u8C61\u3002</p></blockquote><h2 id="testing-and-architecture-\u6D4B\u8BD5\u4E0E\u67B6\u6784" tabindex="-1"><a class="header-anchor" href="#testing-and-architecture-\u6D4B\u8BD5\u4E0E\u67B6\u6784" aria-hidden="true">#</a> TESTING AND ARCHITECTURE \u6D4B\u8BD5\u4E0E\u67B6\u6784</h2><p>It has long been known that testability is an attribute of good architectures. The Humble Object pattern is a good example, because the separation of the behaviors into testable and non-testable parts often defines an architectural boundary. The Presenter/View boundary is one of these boundaries, but there are many others.</p><blockquote><p>\u4F17\u6240\u5468\u77E5\uFF0C\u5F3A\u5927\u7684\u53EF\u6D4B\u8BD5\u6027\u662F\u4E00\u4E2A\u67B6\u6784\u7684\u8BBE\u8BA1\u662F\u5426\u4F18\u79C0\u7684\u663E\u8457\u8861\u91CF\u6807\u51C6\u4E4B\u4E00\u3002\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\u5C31\u662F\u8FD9\u65B9\u9762\u7684\u4E00\u4E2A\u975E\u5E38\u597D\u7684\u4F8B\u5B50\u3002\u6211\u4EEC\u5C06\u7CFB\u7EDF\u884C\u4E3A\u5206\u5272\u6210\u53EF\u6D4B\u8BD5\u548C\u4E0D\u53EF\u6D4B\u8BD5\u4E24\u90E8\u5206\u7684\u8FC7\u7A0B\u5E38\u5E38\u5C31\u4E5F\u5B9A\u4E49\u4E86\u7CFB\u7EDF\u7684\u67B6\u6784\u8FB9\u754C\u3002\u5C55\u793A\u5668\u4E0E\u89C6\u56FE\u4E4B\u95F4\u7684\u8FB9\u754C\u53EA\u662F\u591A\u79CD\u67B6\u6784\u8FB9\u754C\u4E2D\u7684\u4E00\u79CD\uFF0C\u53E6\u5916\u8FD8\u6709\u8BB8\u591A\u5176\u4ED6\u8FB9\u754C\u3002</p></blockquote><h2 id="database-gateways-\u6570\u636E\u5E93\u7F51\u5173" tabindex="-1"><a class="header-anchor" href="#database-gateways-\u6570\u636E\u5E93\u7F51\u5173" aria-hidden="true">#</a> DATABASE GATEWAYS \u6570\u636E\u5E93\u7F51\u5173</h2><p>Between the use case interactors and the database are the database gateways.2 These gateways are polymorphic interfaces that contain methods for every create, read, update, or delete operation that can be performed by the application on the database. For example, if the application needs to know the last names of all the users who logged in yesterday, then the UserGateway interface will have a method named getLastNamesOfUsersWhoLoggedInAfter that takes a Date as its argument and returns a list of last names.</p><blockquote><p>\u5BF9\u4E8E\u7528\u4F8B\u4EA4\u4E92\uFF08interactor\uFF09\u4E0E\u6570\u636E\u5E93\u4E2D\u95F4\u7684\u7EC4\u4EF6\uFF0C\u6211\u4EEC\u901A\u5E38\u79F0\u4E4B\u4E3A\u6570\u636E\u5E93\u7F51\u5173\u3002\u8FD9\u4E9B\u6570\u636E\u5E93\u7F51\u5173\u672C\u8EAB\u662F\u4E00\u4E2A\u591A\u6001\u63A5\u53E3\uFF0C\u5305\u542B\u4E86\u5E94\u7528\u7A0B\u5E8F\u5728\u6570\u636E\u5E93\u4E0A\u6240\u8981\u6267\u884C\u7684\u521B\u5EFA\u3001\u8BFB\u53D6\u3001\u66F4\u65B0\u3001\u5220\u9664\u7B49\u6240\u6709\u64CD\u4F5C\u3002\u4F8B\u5982\uFF0C\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u9700\u8981\u77E5\u9053\u6240\u6709\u6628\u5929\u767B\u5F55\u7CFB\u7EDF\u7684\u7528\u6237\u59D3\uFF0C\u90A3\u4E48 UserGateway \u63A5\u53E3\u5C31\u5E94\u8BE5\u5305\u542B\u4E00\u4E2A getLastNamesOfUsersWhoLoggedlnAfter \u65B9\u6CD5\uFF0C\u63A5\u6536\u4E00\u4E2A Date \u53C2\u6570\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u59D3\u7684\u5217\u8868\u3002</p></blockquote><p>Recall that we do not allow SQL in the use cases layer; instead, we use gateway interfaces that have appropriate methods. Those gateways are implemented by classes in the database layer. That implementation is the humble object. It simply uses SQL, or whatever the interface to the database is, to access the data required by each of the methods. The interactors, in contrast, are not humble because they encapsulate application-specific business rules. Although they are not humble, those interactors are testable, because the gateways can be replaced with appropriate stubs and test-doubles.</p><blockquote><p>\u53E6\u5916\uFF0C\u6211\u4EEC\u4E4B\u524D\u8BF4\u8FC7\uFF0CSQL \u4E0D\u5E94\u8BE5\u51FA\u73B0\u5728\u7528\u4F8B\u5C42\u7684\u4EE3\u7801\u4E2D\uFF0C\u6240\u4EE5\u8FD9\u90E8\u5206\u7684\u529F\u80FD\u5C31\u9700\u8981\u901A\u8FC7\u7F51\u5173\u63A5\u53E3\u6765\u63D0\u4F9B\uFF0C\u800C\u8FD9\u4E9B\u63A5\u53E3\u7684\u5B9E\u73B0\u5219\u8981\u7531\u6570\u636E\u5E93\u5C42\u7684\u7C7B\u6765\u8D1F\u8D23\u3002\u663E\u7136\uFF0C\u8FD9\u4E9B\u5B9E\u73B0\u4E5F\u5E94\u8BE5\u90FD\u5C5E\u4E8E\u8C26\u5351\u5BF9\u8C61\uFF0C\u5B83\u4EEC\u5E94\u8BE5\u53EA\u5229\u7528 SQL \u6216\u5176\u4ED6\u6570\u636E\u5E93\u63D0\u4F9B\u7684\u63A5\u53E3\u6765\u6609\u95EE\u6240\u9700\u8981\u7684\u6570\u636E\u3002\u4E0E\u4E4B\u76F8\u53CD\uFF0C\u4EA4\u4E92\u5668\u5219\u4E0D\u5C5E\u4E8E\u8C26\u5351\u5BF9\u8C61\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u5C01\u88C5\u7684\u662F\u7279\u5B9A\u5E94\u7528\u573A\u666F\u4E0B\u7684\u4E1A\u52A1\u903B\u8F91\u3002\u4E0D\u8FC7\uFF0C\u4EA4\u4E92\u5668\u5C3D\u7BA1\u4E0D\u5C5E\u4E8E\u8C26\u5351\u5BF9\u8C61\uFF0C\u5374\u662F\u53EF\u6D4B\u8BD5\u7684\uFF0C\u56E0\u4E3A\u6570\u636E\u5E93\u7F51\u5173\u901A\u5E38\u53EF\u4EE5\u88AB\u66FF\u6362\u6210\u5BF9\u5E94\u7684\u6D4B\u8BD5\u6869\u548C\u6D4B\u8BD5\u66FF\u8EAB\u7C7B\u3002</p></blockquote><h2 id="data-mappers-\u6570\u636E\u6620\u5C04\u5668" tabindex="-1"><a class="header-anchor" href="#data-mappers-\u6570\u636E\u6620\u5C04\u5668" aria-hidden="true">#</a> DATA MAPPERS \u6570\u636E\u6620\u5C04\u5668</h2><p>Going back to the topic of databases, in which layer do you think ORMs like Hibernate belong?</p><blockquote><p>\u8BA9\u6211\u4EEC\u7EE7\u7EED\u6570\u636E\u5E93\u65B9\u9762\u7684\u8BDD\u9898\uFF0C\u73B0\u5728\u6211\u4EEC\u6765\u601D\u8003\u4E00\u4E0B Hibernate \u8FD9\u7C7B\u7684 ORM \u6846\u67B6\u5E94\u8BE5\u5C5E\u4E8E\u7CFB\u7EDF\u67B6\u6784\u4E2D\u7684\u54EA\u4E00\u5C42\u5462\uFF1F</p></blockquote><p>First, let\u2019s get something straight: There is no such thing as an object relational mapper (ORM). The reason is simple: Objects are not data structures. At least, they are not data structures from their users\u2019 point of view. The users of an object cannot see the data, since it is all private. Those users see only the public methods of that object. So, from the user\u2019s point of view, an object is simply a set of operations.</p><blockquote><p>\u9996\u5148\u6211\u4EEC\u8981\u5F04\u6E05\u695A\u4E00\u4EF6\u4E8B\uFF1A\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04\u5668\uFF08ORM\uFF09\u4E8B\u5B9E\u4E0A\u662F\u538B\u6839\u5C31\u4E0D\u5B58\u5728\u7684\u3002\u5E26\u6765\u5F88\u7B80\u5355\uFF0C\u5BF9\u8C61\u4E0D\u662F\u6570\u636E\u7ED3\u6784\u3002\u81F3\u5C11\u4ECE\u7528\u6237\u7684\u89D2\u5EA6\u6765\u8BF4\uFF0C\u5BF9\u8C61\u5185\u90E8\u7684\u6570\u636E\u5E94\u8BE5\u90FD\u662F\u79C1\u6709\u7684\uFF0C\u4E0D\u53EF\u89C1\u7684\uFF0C\u7528\u6237\u5728\u901A\u5E38\u60C5\u51B5\u4E0B\u53EA\u80FD\u770B\u5230\u5BF9\u8C61\u7684\u516C\u6709\u51FD\u6570\u3002\u56E0\u6B64\u4ECE\u7528\u6237\u89D2\u5EA6\u6765\u8BF4\uFF0C\u5BF9\u8C61\u662F\u4E00\u4E9B\u64CD\u4F5C\u7684\u96C6\u5408\uFF0C\u800C\u4E0D\u662F\u7B80\u5355\u7684\u6570\u636E\u7ED3\u6784\u4F53\u3002</p></blockquote><p>A data structure, in contrast, is a set of public data variables that have no implied behavior. ORMs would be better named \u201Cdata mappers,\u201D because they load data into data structures from relational database tables.</p><blockquote><p>\u4E0E\u4E4B\u76F8\u53CD\uFF0C\u6570\u636E\u7ED3\u6784\u4F53\u5219\u662F\u4E00\u7EC4\u516C\u5F00\u7684\u6570\u636E\u53D8\u91CF\u5176\u4E2D\u4E0D\u5305\u542B\u4EFB\u4F55\u884C\u4E3A\u4FE1\u606F\u3002\u6240\u4EE5 ORM \u66F4\u5E94\u8BE5\u88AB\u79F0\u4E3A\u201C\u6570\u636E\u6620\u5C04\u5668\u201D\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u53EA\u662F\u5C06\u6570\u636E\u4ECE\u5173\u7CFB\u578B\u6570\u636E\u5E93\u52A0\u8F7D\u5230\u4E86\u5BF9\u5E94\u7684\u6570\u636E\u7ED3\u6784\u4E2D\u3002</p></blockquote><p>Where should such ORM systems reside? In the database layer of course. Indeed, ORMs form another kind of Humble Object boundary between the gateway interfaces and the database.</p><blockquote><p>\u90A3\u4E48\uFF0C\u8FD9\u6837\u7684 ORM \u7CFB\u7EDF\u5E94\u8BE5\u5C5E\u4E8E\u7CFB\u7EDF\u67B6\u6784\u4E2D\u7684\u54EA\u4E00\u5C42\u5462\uFF1F\u5F53\u7136\u662F\u6570\u636E\u5E93\u5C42\u3002ORM \u5176\u5B9E\u5C31\u662F\u5728\u6570\u636E\u5E93\u548C\u6570\u636E\u5E93\u7F51\u5173\u4E4B\u95F4\u6784\u5EFA\u4E86\u53E6\u4E00\u79CD\u8C26\u5351\u5BF9\u8C61\u7684\u8FB9\u754C\u3002</p></blockquote><h2 id="service-listeners-\u670D\u52A1\u76D1\u542C\u5668" tabindex="-1"><a class="header-anchor" href="#service-listeners-\u670D\u52A1\u76D1\u542C\u5668" aria-hidden="true">#</a> SERVICE LISTENERS \u670D\u52A1\u76D1\u542C\u5668</h2><p>What about services? If your application must communicate with other services, or if your application provides a set of services, will we find the Humble Object pattern creating a service boundary?</p><blockquote><p>\u5982\u679C\u6211\u4EEC\u7684\u5E94\u7528\u7A0B\u5E8F\u9700\u8981\u4E0E\u5176\u4ED6\u670D\u52A1\u8FDB\u884C\u67D0\u79CD\u4EA4\u4E92\uFF0C\u6216\u8005\u8BE5\u5E94\u7528\u672C\u8EAB\u8981\u63D0\u4F9B\u67D0\u4E00\u5957\u670D\u52A1\uFF0C\u6211\u4EEC\u5728\u76F8\u5173\u670D\u52A1\u7684\u8FB9\u754C\u5904\u4E5F\u4F1A\u770B\u5230\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\u5417\uFF1F</p></blockquote><p>Of course! The application will load data into simple data structures and then pass those structures across the boundary to modules that properly format the data and send it to external services. On the input side, the service listeners will receive data from the service interface and format it into a simple data structure that can be used by the application. That data structure is then passed across the service boundary.</p><blockquote><p>\u7B54\u6848\u662F\u80AF\u5B9A\u7684\u3002\u6211\u4EEC\u7684\u5E94\u7528\u7A0B\u5E8F\u4F1A\u5C06\u6570\u636E\u52A0\u8F7D\u5230\u7B80\u5355\u7684\u6570\u636E\u7ED3\u6784\u4E2D\uFF0C\u5E76\u5C06\u8FD9\u4E9B\u6570\u636E\u7ED3\u6784\u8DE8\u8FB9\u754C\u4F20\u8F93\u7ED9\u90A3\u4E9B\u80FD\u591F\u5C06\u5176\u683C\u5F0F\u5316\u5E76\u4F20\u9012\u5176\u4ED6\u5916\u90E8\u670D\u52A1\u7684\u6A21\u5757\u3002\u5728\u8F93\u5165\u7AEF\uFF0C\u670D\u52A1\u76D1\u542C\u5668\u4F1A\u8D1F\u8D23\u4ECE\u670D\u52A1\u63A5\u53E3\u4E2D\u63A5\u6536\u6570\u636E\uFF0C\u5E76\u5C06\u5176\u683C\u5F0F\u5316\u6210\u8BE5\u5E94\u7528\u7A0B\u5E8F\u6613\u7528\u7684\u683C\u5F0F\u3002\u603B\u800C\u8A00\u4E4B\uFF0C\u4E0A\u8FF0\u6570\u636E\u7ED3\u6784\u53EF\u4EE5\u8FDB\u884C\u8DE8\u670D\u52A1\u8FB9\u754C\u7684\u4F20\u8F93\u3002</p></blockquote><h2 id="conclusion-\u672C\u7AE0\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#conclusion-\u672C\u7AE0\u5C0F\u7ED3" aria-hidden="true">#</a> CONCLUSION \u672C\u7AE0\u5C0F\u7ED3</h2><p>At each architectural boundary, we are likely to find the Humble Object pattern lurking somewhere nearby. The communication across that boundary will almost always involve some kind of simple data structure, and the boundary will frequently divide something that is hard to test from something that is easy to test. The use of this pattern at architectural boundaries vastly increases the testability of the entire system.</p><blockquote><p>\u5728\u6BCF\u4E2A\u7CFB\u7EDF\u67B6\u6784\u7684\u8FB9\u754C\u5904\uFF0C\u90FD\u6709\u53EF\u80FD\u53D1\u73B0\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\u7684\u5B58\u5728\u3002\u56E0\u4E3A\u8DE8\u8FB9\u754C\u7684\u901A\u4FE1\u80AF\u5B9A\u9700\u8981\u7528\u5230\u67D0\u79CD\u7B80\u5355\u7684\u6570\u636E\u7ED3\u6784\uFF0C\u800C\u8FB9\u754C\u4F1A\u81EA\u7136\u800C\u7136\u5730\u5C06\u7CFB\u7EDF\u5206\u5272\u6210\u96BE\u4EE5\u6D4B\u8BD5\u7684\u90E8\u5206\u4E0E\u5BB9\u6613\u6D4B\u8BD5\u7684\u90E8\u5206\uFF0C\u6240\u4EE5\u901A\u8FC7\u5728\u7CFB\u7EDF\u7684\u8FB9\u754C\u5904\u8FD0\u7528\u8C26\u5351\u5BF9\u8C61\u6A21\u5F0F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5927\u5E45\u5730\u63D0\u9AD8\u6574\u4E2A\u7CFB\u7EDF\u7684\u53EF\u6D4B\u8BD5\u6027\u3002</p></blockquote>',44),i=[r];function n(h,l){return t(),a("div",null,i)}const p=e(s,[["render",n],["__file","ch23.html.vue"]]);export{p as default};
